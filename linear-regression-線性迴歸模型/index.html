<!DOCTYPE html>
<html lang="zh-TW" prefix="og: http://ogp.me/ns#">
<head>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


	
<title>Linear Regression | 線性迴歸模型 | using AirQuality Dataset</title>
<meta name="robots" content="max-image-preview:large">


<meta name="description" content="Linear Regression 線性迴歸模型是用來預測連續型目標變數與預測變數間的線性關係，並存在許多資料符合常態分佈與線性關係等基本假設。預測變數可以是數值或類別型態，投入模型進行時類別變數都會被轉換成虛擬變數。對於有遺失值的觀測值則會直接忽略，且易受極端值影響，因此在使用模型前必須做好資料前處理。">

<meta property="og:locale" content="zh_TW">
<meta property="og:type" content="article">
<meta property="og:title" content="Linear Regression | 線性回歸模型 | using AirQuality Dataset">
<meta property="og:description" content="Linear Regression 線性回歸模型是用來預測連續型目標變數與預測變數間的線性關係，並存在許多資料符合常態分佈與線性關係等基本假設。預測變數可以是數值或類別型態，投入模型進行時類別變數都會被轉換成虛擬變數。對於有遺失值的觀測值則會直接忽略，且易受極端值影響，因此在使用模型前必須做好資料前處理。">
<meta property="og:url" content="/linear-regression-%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%e6%a8%a1%e5%9e%8b/">
<meta property="og:site_name" content="果醬珍珍•JamJam">
<meta property="article:tag" content="AIC">
<meta property="article:tag" content="airquality">
<meta property="article:tag" content="assumption of linear regression">
<meta property="article:tag" content="BIC">
<meta property="article:tag" content="eda">
<meta property="article:tag" content="exploratory data analysis">
<meta property="article:tag" content="ggplot2">
<meta property="article:tag" content="kfold cross validation">
<meta property="article:tag" content="Linear Regression">
<meta property="article:tag" content="linearregression">
<meta property="article:tag" content="lm">
<meta property="article:tag" content="Missing Values Treatment">
<meta property="article:tag" content="modeling">
<meta property="article:tag" content="predict">
<meta property="article:tag" content="regression">
<meta property="article:tag" content="R語言">
<meta property="article:tag" content="test">
<meta property="article:tag" content="train">
<meta property="article:tag" content="統計">
<meta property="article:tag" content="線性回歸">
<meta property="article:tag" content="線性回歸假設">
<meta property="article:tag" content="資料視覺化">
<meta property="article:tag" content="遺失值填補">
<meta property="article:section" content=" 程式與統計">
<meta property="article:published_time" content="2018-08-06T12:45:23+08:00">
<meta property="article:modified_time" content="2019-04-14T15:03:09+08:00">
<meta property="og:updated_time" content="2019-04-14T15:03:09+08:00">
<meta property="og:image" content="/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash-1024x687.jpg">
<meta property="og:image:width" content="1024">
<meta property="og:image:height" content="687">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="Linear Regression 線性迴歸模型是用來預測連續型目標變數與預測變數間的線性關係，並存在許多資料符合常態分佈與線性關係等基本假設。預測變數可以是數值或類別型態，投入模型進行時類別變數都會被轉換成虛擬變數。對於有遺失值的觀測值則會直接忽略，且易受極端值影響，因此在使用模型前必須做好資料前處理。">
<meta name="twitter:title" content="Linear Regression | 線性迴歸模型 | using AirQuality Dataset">
<meta name="twitter:image" content="/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash.jpg">


<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">



<link rel="stylesheet" id="crayon-css" href="/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-hwj-based-on-monokai-css" href="/wp-content/uploads/crayon-syntax-highlighter/themes/hwj-based-on-monokai/hwj-based-on-monokai.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monospace-css" href="/wp-content/plugins/crayon-syntax-highlighter/fonts/monospace.css" type="text/css" media="all">
<link rel="stylesheet" id="sb_instagram_styles-css" href="/wp-content/plugins/instagram-feed/css/sb-instagram-2-2.min.css" type="text/css" media="all">
<link rel="stylesheet" id="sydney-bootstrap-css" href="/wp-content/themes/hwj-based-on-sydney/css/bootstrap/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="titan-adminbar-styles-css" href="/wp-content/plugins/anti-spam/assets/css/admin-bar.css" type="text/css" media="all">
<link rel="stylesheet" id="sydney-fonts-css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C600%7CRaleway%3A400%2C500%2C600" type="text/css" media="all">
<link rel="stylesheet" id="sydney-style-css" href="/wp-content/themes/hwj-based-on-sydney/style.css" type="text/css" media="all">
<style id="sydney-style-inline-css" type="text/css">
.site-title { font-size:32px; }
.site-description { font-size:16px; }
#mainnav ul li a { font-size:14px; }
h1 { font-size:52px; }
h2 { font-size:42px; }
h3 { font-size:32px; }
h4 { font-size:25px; }
h5 { font-size:20px; }
h6 { font-size:18px; }
body { font-size:16px; }
.single .hentry .title-post { font-size:24px; }
.header-image { background-size:cover;}
.header-image { height:500px; }
.widget-area .widget_fp_social a,#mainnav ul li a:hover, .sydney_contact_info_widget span, .roll-team .team-content .name,.roll-team .team-item .team-pop .team-social li:hover a,.roll-infomation li.address:before,.roll-infomation li.phone:before,.roll-infomation li.email:before,.roll-testimonials .name,.roll-button.border,.roll-button:hover,.roll-icon-list .icon i,.roll-icon-list .content h3 a:hover,.roll-icon-box.white .content h3 a,.roll-icon-box .icon i,.roll-icon-box .content h3 a:hover,.switcher-container .switcher-icon a:focus,.go-top:hover,.hentry .meta-post a:hover,#mainnav > ul > li > a.active, #mainnav > ul > li > a:hover, button:hover, input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover, .text-color, .social-menu-widget a, .social-menu-widget a:hover, .archive .team-social li a, a, h1 a, h2 a, h3 a, h4 a, h5 a, h6 a,.classic-alt .meta-post a,.single .hentry .meta-post a { color:#3d3d3d}
.reply,.woocommerce div.product .woocommerce-tabs ul.tabs li.active,.woocommerce #respond input#submit,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.project-filter li a.active, .project-filter li a:hover,.preloader .pre-bounce1, .preloader .pre-bounce2,.roll-team .team-item .team-pop,.roll-progress .progress-animate,.roll-socials li a:hover,.roll-project .project-item .project-pop,.roll-project .project-filter li.active,.roll-project .project-filter li:hover,.roll-button.light:hover,.roll-button.border:hover,.roll-button,.roll-icon-box.white .icon,.owl-theme .owl-controls .owl-page.active span,.owl-theme .owl-controls.clickable .owl-page:hover span,.go-top,.bottom .socials li:hover a,.sidebar .widget:before,.blog-pagination ul li.active,.blog-pagination ul li:hover a,.content-area .hentry:after,.text-slider .maintitle:after,.error-wrap #search-submit:hover,#mainnav .sub-menu li:hover > a,#mainnav ul li ul:after, button, input[type="button"], input[type="reset"], input[type="submit"], .panel-grid-cell .widget-title:after { background-color:#3d3d3d}
.roll-socials li a:hover,.roll-socials li a,.roll-button.light:hover,.roll-button.border,.roll-button,.roll-icon-list .icon,.roll-icon-box .icon,.owl-theme .owl-controls .owl-page span,.comment .comment-detail,.widget-tags .tag-list a:hover,.blog-pagination ul li,.hentry blockquote,.error-wrap #search-submit:hover,textarea:focus,input[type="text"]:focus,input[type="password"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="time"]:focus,input[type="week"]:focus,input[type="number"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="color"]:focus, button, input[type="button"], input[type="reset"], input[type="submit"], .archive .team-social li a { border-color:#3d3d3d}
.site-header.float-header { background-color:rgba(0,0,0,0.9);}
@media only screen and (max-width: 1024px) { .site-header { background-color:#000000;}}
.site-title a, .site-title a:hover { color:#ffffff}
.site-description { color:#ffffff}
#mainnav ul li a, #mainnav ul li::before { color:#ffffff}
#mainnav .sub-menu li a { color:#ffffff}
#mainnav .sub-menu li a { background:#1c1c1c}
.text-slider .maintitle, .text-slider .subtitle { color:#ffffff}
body { color:#5e5e5e}
#secondary { background-color:#ffffff}
#secondary, #secondary a, #secondary .widget-title { color:#767676}
.footer-widgets { background-color:#252525}
.btn-menu { color:#ffffff}
#mainnav ul li a:hover { color:#d65050}
.site-footer { background-color:#1c1c1c}
.site-footer,.site-footer a { color:#666666}
.overlay { background-color:#000000}
.page-wrap { padding-top:10px;}
.page-wrap { padding-bottom:100px;}
@media only screen and (max-width: 1025px) {		
			.mobile-slide {
				display: block;
			}
			.slide-item {
				background-image: none !important;
			}
			.header-slider {
			}
			.slide-item {
				height: auto !important;
			}
			.slide-inner {
				min-height: initial;
			} 
		}
@media only screen and (max-width: 780px) { 
    	h1 { font-size: 32px;}
		h2 { font-size: 28px;}
		h3 { font-size: 22px;}
		h4 { font-size: 18px;}
		h5 { font-size: 16px;}
		h6 { font-size: 14px;}
    }

</style>
<link rel="stylesheet" id="sydney-font-awesome-css" href="/wp-content/themes/hwj-based-on-sydney/fonts/font-awesome.min.css" type="text/css" media="all">

<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="text/javascript" id="crayon_js-js-extra">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/localhost\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js" id="crayon_js-js"></script>





</head><body><div id="fb-root"></div><script>(function(d, s, id) {

	var js, fjs = d.getElementsByTagName(s)[0];

	if (d.getElementById(id)) return;

	js = d.createElement(s); js.id = id;

	js.src = '//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.3';

	fjs.parentNode.insertBefore(js, fjs);

	}(document, 'script', 'facebook-jssdk'));</script>	<style type="text/css">
		.header-image {
			background-image: url(/wp-content/uploads/2018/09/果醬珍珍_首圖_10.jpg);
			display: block;
		}
		@media only screen and (max-width: 1024px) {
			.header-inner {
				display: block;
			}
			.header-image {
				background-image: none;
				height: auto !important;
			}		
		}
	</style>
			<style type="text/css" id="wp-custom-css">
			.entry-content a {
	text-decoration: underline;
	color: #9f6ad4;
}		</style>
			<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
	

	




	<div class="preloader">
	    <div class="spinner">
	        <div class="pre-bounce1"></div>
	        <div class="pre-bounce2"></div>
	    </div>
	</div>
	
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">跳至主內容區</a>

	
	
	
	<div id="masthead" class="site-header" role="banner" style="display:none;"> 
		<div class="header-wrap">
            <div class="container">
                <div class="row">
				<div class="col-md-4 col-sm-8 col-xs-12">
		        					<a href="/" title="果醬珍珍•JamJam"><img class="site-logo" src="/wp-content/uploads/2018/09/grape_320.png" alt="果醬珍珍•JamJam"></a>
		        				</div>
				<div class="col-md-8 col-sm-4 col-xs-12">
					<div class="btn-menu"></div>
					<nav id="mainnav" class="mainnav" role="navigation">
						<div class="menu-jamleecute-container"><ul id="menu-jamleecute" class="menu"><li id="menu-item-1691" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1691"><a href="/category/programming-statistics/"> 程式與統計</a></li>
<li id="menu-item-626" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-626"><a href="/category/travel/">旅遊</a></li>
<li id="menu-item-627" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-627"><a href="/category/foodie/">美食</a></li>
<li id="menu-item-2415" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2415"><a href="/%e7%b0%a1%e4%bb%8b/">關於我</a></li>
</ul></div>					</nav>
				</div>
				</div>
			</div>
		</div>
	</div>
	
	
	

	
	<style>
	.header-img-bounding-box {
	  background-image: url("/wp-content/uploads/2018/09/%E8%83%8C%E6%99%AF%E5%8E%9F%E5%9C%96_v2.jpg");
    background-size:     cover;                      /* <------ */
    background-repeat:   no-repeat;
    background-position: center center;              /* optional, center the image */
/* 	height: 300px; */
	padding-top:55px;
	padding-bottom:55px;
		}
		.title_img {
		    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
		min-width: 340px;
			max-width: 800px;

		}
		
		
		.subtitle_img {
			display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
		min-width: 340px;
			max-width: 800px;
		}
		
		
		.subtitle_overlay {
			margin-top:20px;
			background-color: rgba(255, 255, 255, 0.7);
			padding-bottom:8px;
		}
	</style>
	
	<div>
		<a href="/">
		<div class="header-img-bounding-box">

			<img src="/wp-content/uploads/2018/09/title.png" class="title_img">
			<div class="subtitle_overlay">
			<img src="/wp-content/uploads/2018/09/subtitle.png" class="subtitle_img">
			</div>			
		</div>	
		</a>
	</div>
	
	
	
	<header>
		<nav id="my_mainnav" class="my_mainnav" role="navigation">
				<div class="menu-jamleecute-container"><ul id="menu-jamleecute-1" class="menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1691"><a href="/category/programming-statistics/"> 程式與統計</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-626"><a href="/category/travel/">旅遊</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-627"><a href="/category/foodie/">美食</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2415"><a href="/%e7%b0%a1%e4%bb%8b/">關於我</a></li>
</ul></div>		</nav>
	</header>

	
	
	
	<div id="content" class="page-wrap">
		
		
		
		<style>
			.home_intro {
				    margin: 0 12%;
					/*height: 400px;*/
    				/*background: yellow;*/
				
			}
			
			.home_intro .content{
				display: flex; 
    display: -webkit-flex;
    justify-content: center;
    -webkit-justify-content: center;
    flex-wrap: wrap;
			}
			.home_intro .content .intro {
				width: 240px;
    			
				margin: 0 auto;
				
			}
			.home_intro .content .intro .image {
				/*width: 240px;
    			padding: 0px;
				margin: 0 auto;
				display: inline-block;*/
			  position: relative;
			  width: 240px;
			  height: 240px;
			  overflow: hidden;
			  border-radius: 50%;
			}
			.home_intro .content .description{
				padding: 0 0px;
    			margin: 0 auto;
    			width: 240px;
				text-align: center;
			}
			.home_intro .content .social_icon {
				margin: 0 7px;
			}
			
			.circular--landscape {
			  display: inline-block;
			  position: relative;
			  width: 200px;
			  height: 200px;
			  overflow: hidden;
			  border-radius: 50%;
			}

			.home_intro .content .intro .image img {
			  width: auto;
			  height: 100%;
			  /*margin-left: -50px;*/
			}
		</style>
		

					
				
		
		<div class="container content-wrapper">
			<div class="row">	
				
				
				
	
	
	<div id="primary" class="content-area col-md-9 ">

		
		<main id="main" class="post-wrap" role="main">

		
			
<article id="post-518" class="post-518 post type-post status-publish format-standard has-post-thumbnail hentry category-programming-statistics category-statistics-model tag-aic tag-airquality tag-assumption-of-linear-regression tag-bic tag-eda tag-exploratory-data-analysis tag-ggplot2 tag-kfold-cross-validation tag-linear-regression tag-linearregression tag-lm tag-missing-values-treatment tag-modeling tag-predict tag-regression tag-r tag-test tag-train tag-27 tag-202 tag-209 tag-40 tag-203">
	
	
			<div class="entry-thumb">
			<img width="3670" height="2462" src="/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash.jpg" class="attachment-large-thumb size-large-thumb wp-post-image" alt="aleks-dorohovich-26-unsplash" loading="lazy" srcset="/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash.jpg 3670w,/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash-300x201.jpg 300w,/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash-768x515.jpg 768w,/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash-1024x687.jpg 1024w,/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash-830x557.jpg 830w,/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash-230x154.jpg 230w,/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash-350x235.jpg 350w,/wp-content/uploads/2018/08/aleks-dorohovich-26-unsplash-480x322.jpg 480w" sizes="(max-width: 3670px) 100vw, 3670px">		</div>
		
	<header class="entry-header">
		
		<div class="meta-post">
			<a href="/category/programming-statistics/" title=" 程式與統計" class="post-cat"> 程式與統計</a><a href="/category/programming-statistics/statistics-model/" title="統計模型" class="post-cat">統計模型</a>		</div>

		<h1 class="title-post entry-title">Linear Regression | 線性迴歸模型 | using AirQuality Dataset</h1>
				<div class="single-meta">
			<span class="posted-on">發表於 <a href="/linear-regression-%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%e6%a8%a1%e5%9e%8b/" rel="bookmark"><time class="entry-date published" datetime="2018-08-06T12:45:23+08:00">2018-08-06</time><time class="updated" datetime="2019-04-14T23:03:09+08:00">2019-04-14</time></a></span><span class="byline"> <span class="author vcard"><a class="url fn n" href="/author/jamleecute/">jamleecute</a></span></span>		</div>
			</header>

	

	<div class="entry-content">
		<p>Linear Regression 線性迴歸模型是用來預測<span style="color: #9f6ad4;">連續型目標變數</span>與預測變數間的線性關係，並存在許多資料符合常態分佈與線性關係等基本假設。預測變數可以是數值或類別型態，投入模型進行時類別變數都會被轉換成虛擬變數。對於有遺失值的觀測值則會直接忽略，且易受極端值影響，因此在使用模型前必須做好資料前處理。</p>
<h3>Linear Regression Introduction</h3>
<p>Linear Regression 線性迴歸模型主要是使用最適線性迴歸線來建立依變數Y和一個或多個自變數X間的關係，並可以此線性迴歸方程式，使用給定自變數X的值來預測依變數Y值（適用於目標變數為連續變數時，若目標變數為二元變數，則適用<a href="/logistic_regression_part1/" target="_blank" rel="noopener noreferrer">羅吉斯回歸</a>）。（＊線性迴歸方程式的建立則是使用最小平方法Least Sqaures Method來找尋X和Y之間的關係與趨勢）</p>
<p>Linear Regression 線性迴歸方程式：<span style="font-weight: 400;">\(Y=\beta_{1}+\beta_{2}*X+\varepsilon\)</span></p>
<p><img loading="lazy" class="wp-image-717 aligncenter" src="/wp-content/uploads/2018/08/%E7%B5%B1%E8%A8%88%E6%A6%82%E5%BF%B5%E5%9C%96_Linear-Regression.jpg" alt="linear regression" width="539" height="404" srcset="/wp-content/uploads/2018/08/%E7%B5%B1%E8%A8%88%E6%A6%82%E5%BF%B5%E5%9C%96_Linear-Regression.jpg 960w,/wp-content/uploads/2018/08/%E7%B5%B1%E8%A8%88%E6%A6%82%E5%BF%B5%E5%9C%96_Linear-Regression-300x225.jpg 300w,/wp-content/uploads/2018/08/%E7%B5%B1%E8%A8%88%E6%A6%82%E5%BF%B5%E5%9C%96_Linear-Regression-768x576.jpg 768w" sizes="(max-width: 539px) 100vw, 539px"></p>
<h3>Example Problem</h3>
<p>使用資料集為R dataset套件中的<a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/airquality.html">airquality</a>。此資料集主要搜集自1973年5月到9月，每日空氣品質相關的衡量指標，包括臭氧濃度、太陽輻射、平均風速、最高溫度，以及資料月份與資料日。</p>
<p><span style="color: #9f6ad4;"><strong>分析目標：找出影響空氣中臭氧(Ozone)濃度的重要影響因子與關係。</strong></span></p>
<p>目標變數（依變數）：連續變數(臭氧濃度，Ozone)<br>
預測變數（自變數）：連續/類別變數(太陽輻射Solar.R、平均風速Wind、最高溫度Temp、資料月份Month、資料日Day)(*此資料集剛好都是連續變數)</p>
<p>為了達成分析目標，主要的資料處理與分析架構會包括以下步驟：</p>
<ol>
<li>資料載入與檢視</li>
<li>資料探索(Exploratory Data Analysis, EDA)：視覺化分析
<ol>
<li>視覺化預測變數與目標變數間的關係：相關係數矩陣、散佈圖scatter plot</li>
<li>偵測離群值：盒須圖box plot</li>
<li>檢查預測變數分佈是否為常態分佈(鐘型)而沒有左右偏移：機率密度圖density plot</li>
</ol>
</li>
<li>資料前處理
<ol>
<li>離群值處理</li>
<li>標準化-使變數間關係衡量不受單位規模數值影響</li>
<li>變數轉換-使變數接近常態分佈，以符合模型假設</li>
<li>遺失值填補-使用MICE()套件來預測遺失值</li>
</ol>
</li>
<li>建立預測線性模型
<ol>
<li>Pooling – 綜合多組遺失值填補後的datasets建立回歸模型，並摘要模型配適結果</li>
<li>CompleteData – 挑選其中一組遺失填補後的dataset建立回歸模型，並摘要模型配適結果</li>
</ol>
</li>
<li>線性回歸模型適合度診斷
<ol>
<li>資料是否符合線性迴歸模型假設</li>
<li>使用gvlma套件檢測</li>
<li>使用shapiro test 來看變數是否成常態分佈</li>
</ol>
</li>
<li>模型驗證
<ol>
<li>檢視(比較)模型配適能力常用指標</li>
<li>80% 訓練 20%驗證
<ul>
<li> 真實值與預測值相關性(Correlation)</li>
<li>正確率(min_max_accuracy)</li>
<li>錯誤率(MAPE ,Mean absolute percentage error)</li>
</ul>
</li>
<li>加強版模型效果驗證：K-fold Cross Validation
<ol>
<li>mean squared error</li>
</ol>
</li>
</ol>
</li>
<li>結論</li>
</ol>
<h3>1. 資料載入與檢視</h3>
<p>載入資料</p>

		<div id="crayon-60ed86b4d2de0515220663" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 1. Load and View Dataset library(datasets) 
# 載入今天分析主要會用到的資料集：AirQuality data("airquality") 
inputData <- airquality 

# 查看資料結構:資料變數、型態
str(inputData)

# 'data.frame':	153 obs. of  6 variables:
# $ Ozone  : int  41 36 12 18 NA 28 23 19 8 NA ...
# $ Solar.R: int  190 118 149 313 NA NA 299 99 19 194 ...
# $ Wind   : num  7.4 8 12.6 11.5 14.3 14.9 8.6 13.8 20.1 8.6 ...
# $ Temp   : int  67 72 74 62 56 66 65 59 61 69 ...
# $ Month  : int  5 5 5 5 5 5 5 5 5 5 ...
# $ Day    : int  1 2 3 4 5 6 7 8 9 10 ...</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-11">11</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-12">12</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-13">13</div><div class="crayon-num" data-line="crayon-60ed86b4d2de0515220663-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-1"># 1. Load and View Dataset library(datasets) </div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-2"># 載入今天分析主要會用到的資料集：AirQuality data("airquality") </div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-3">inputData <div class="crayon-line" id="crayon-60ed86b4d2de0515220663-4"> </div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-5"># 查看資料結構:資料變數、型態</div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-6">str(inputData)</div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-7"> </div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-8"># 'data.frame':	153 obs. of  6 variables:</div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-9"># $ Ozone  : int  41 36 12 18 NA 28 23 19 8 NA ...</div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-10"># $ Solar.R: int  190 118 149 313 NA NA 299 99 19 194 ...</div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-11"># $ Wind   : num  7.4 8 12.6 11.5 14.3 14.9 8.6 13.8 20.1 8.6 ...</div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-12"># $ Temp   : int  67 72 74 62 56 66 65 59 61 69 ...</div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-13"># $ Month  : int  5 5 5 5 5 5 5 5 5 5 ...</div><div class="crayon-line" id="crayon-60ed86b4d2de0515220663-14"># $ Day    : int  1 2 3 4 5 6 7 8 9 10 ...</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>檢視資料</p>

		<div id="crayon-60ed86b4d2de6194936808" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 資料欄位詳細說明可在console輸入： ?datasets::airquality 
# 查看資料頭幾列 head(inputData)
head(inputData)

#   Ozone Solar.R Wind Temp Month Day
# 1    41     190  7.4   67     5   1
# 2    36     118  8.0   72     5   2
# 3    12     149 12.6   74     5   3
# 4    18     313 11.5   62     5   4
# 5    NA      NA 14.3   56     5   5
# 6    28      NA 14.9   66     5   6</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2de6194936808-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-1"># 資料欄位詳細說明可在console輸入： ?datasets::airquality </div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-2"># 查看資料頭幾列 head(inputData)</div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-3">head(inputData)</div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-4"> </div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-5">#   Ozone Solar.R Wind Temp Month Day</div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-6"># 1    41     190  7.4   67     5   1</div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-7"># 2    36     118  8.0   72     5   2</div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-8"># 3    12     149 12.6   74     5   3</div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-9"># 4    18     313 11.5   62     5   4</div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-10"># 5    NA      NA 14.3   56     5   5</div><div class="crayon-line" id="crayon-60ed86b4d2de6194936808-11"># 6    28      NA 14.9   66     5   6</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<h3>2. 資料探索(Exploratory Data Analysis, EDA)</h3>
<h4>基本敘述統計</h4>
<p>使用summary()函數查看基本敘述統計。可以看到此資料集共有153列，以及6個特徵變數的最大最小值、第一與第三分位數以及遺失值數量。</p>

		<div id="crayon-60ed86b4d2de8173791491" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# mean,median,25th and 75th quartiles,min,max, NA數量
summary(inputData)

#         Ozone          Solar.R         Wind            Temp          Month           Day      
# Min.   :  1.0   Min.   :  7   Min.   : 1.70   Min.   :56.0   Min.   :5.00   Min.   : 1.0  
# 1st Qu.: 18.0   1st Qu.:116   1st Qu.: 7.40   1st Qu.:72.0   1st Qu.:6.00   1st Qu.: 8.0  
# Median : 31.5   Median :205   Median : 9.70   Median :79.0   Median :7.00   Median :16.0  
# Mean   : 42.1   Mean   :186   Mean   : 9.96   Mean   :77.9   Mean   :6.99   Mean   :15.8  
# 3rd Qu.: 63.2   3rd Qu.:259   3rd Qu.:11.50   3rd Qu.:85.0   3rd Qu.:8.00   3rd Qu.:23.0  
# Max.   :168.0   Max.   :334   Max.   :20.70   Max.   :97.0   Max.   :9.00   Max.   :31.0  
# NA's   :37      NA's   :7</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2de8173791491-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-1"># mean,median,25th and 75th quartiles,min,max, NA數量</div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-2">summary(inputData)</div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-3"> </div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-4">#         Ozone          Solar.R         Wind            Temp          Month           Day      </div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-5"># Min.   :  1.0   Min.   :  7   Min.   : 1.70   Min.   :56.0   Min.   :5.00   Min.   : 1.0  </div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-6"># 1st Qu.: 18.0   1st Qu.:116   1st Qu.: 7.40   1st Qu.:72.0   1st Qu.:6.00   1st Qu.: 8.0  </div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-7"># Median : 31.5   Median :205   Median : 9.70   Median :79.0   Median :7.00   Median :16.0  </div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-8"># Mean   : 42.1   Mean   :186   Mean   : 9.96   Mean   :77.9   Mean   :6.99   Mean   :15.8  </div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-9"># 3rd Qu.: 63.2   3rd Qu.:259   3rd Qu.:11.50   3rd Qu.:85.0   3rd Qu.:8.00   3rd Qu.:23.0  </div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-10"># Max.   :168.0   Max.   :334   Max.   :20.70   Max.   :97.0   Max.   :9.00   Max.   :31.0  </div><div class="crayon-line" id="crayon-60ed86b4d2de8173791491-11"># NA's   :37      NA's   :7</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<h4>視覺化分析</h4>
<h4>視覺化預測變數與目標變數間的關係</h4>
<p>使用GGally套件中ggcorr()來查看各變數間的相關係數強弱。</p>

		<div id="crayon-60ed86b4d2dea793625331" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library("GGally")
# ggcorr(): Plot a correlation matrix
# The function ggcorr() draws a correlation matrix plot using ggplot2.
ggcorr(data = inputData, palette = "RdYlGn",
label = TRUE, label_color = "black")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2dea793625331-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2dea793625331-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2dea793625331-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2dea793625331-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2dea793625331-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2dea793625331-1">library("GGally")</div><div class="crayon-line" id="crayon-60ed86b4d2dea793625331-2"># ggcorr(): Plot a correlation matrix</div><div class="crayon-line" id="crayon-60ed86b4d2dea793625331-3"># The function ggcorr() draws a correlation matrix plot using ggplot2.</div><div class="crayon-line" id="crayon-60ed86b4d2dea793625331-4">ggcorr(data = inputData, palette = "RdYlGn",</div><div class="crayon-line" id="crayon-60ed86b4d2dea793625331-5">label = TRUE, label_color = "black")</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-full wp-image-682" src="/wp-content/uploads/2018/08/Rplot01.jpeg" alt="linear regression" width="600" height="569" srcset="/wp-content/uploads/2018/08/Rplot01.jpeg 600w,/wp-content/uploads/2018/08/Rplot01-300x285.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px"></p>
<p>由上圖可以觀察到</p>
<p>(1)具有較強正相關性(相關係數>=0.4)的變數關係有：</p>
<ul>
<li>氣溫(Temp)&月份(Month)</li>
<li>臭氧濃度(Ozone)與氣溫(Temp)</li>
</ul>
<p>(2)具有較強負相關性(相關係數<= -0.4)的變數關係有：</p>
<ul>
<li>風速(Wind)與氣溫(Temp)</li>
<li>臭氧濃度(Ozone)與風速(Wind)</li>
</ul>
<p>但僅參考相關係數，並無法知道兩者是否符合線性關係。</p>
<p>散佈圖scatter plot ＆ 機率密度圖</p>

		<div id="crayon-60ed86b4d2deb200597122" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 使用 ggpairs() 函數產生多個變數間關係的視覺化矩陣散佈圖
ggpairs(data = inputData)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2deb200597122-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2deb200597122-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2deb200597122-1"># 使用 ggpairs() 函數產生多個變數間關係的視覺化矩陣散佈圖</div><div class="crayon-line" id="crayon-60ed86b4d2deb200597122-2">ggpairs(data = inputData)</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-full wp-image-684" src="/wp-content/uploads/2018/08/Rplot02.jpeg" alt="linear regression" width="800" height="759" srcset="/wp-content/uploads/2018/08/Rplot02.jpeg 800w,/wp-content/uploads/2018/08/Rplot02-300x285.jpeg 300w,/wp-content/uploads/2018/08/Rplot02-768x729.jpeg 768w" sizes="(max-width: 800px) 100vw, 800px"></p>
<p>由上圖可以觀察到三種數據型態，分別為：</p>
<ol>
<li>對角線上各個變數的機率密度分佈（用來檢視變數分佈是否為常態）
<ul>
<li>除了Temp稍微看似常態，其餘變數Ozone(右偏嚴重)、Solar.R、Wind都不太滿足常態分佈。</li>
</ul>
</li>
<li>左上方三角區塊變數間的相關係數數值大小
<ul>
<li>可以與前面ggcorr()畫的圖做比對</li>
</ul>
</li>
<li>左下方三角區塊變數間的散佈圖
<ul>
<li><span style="color: #9f6ad4;">可以發現此散佈圖在繪製時，已自動使用各變數的最大最小值將數值標準化，所以變數間的散佈圖將不受尺度大小所影響，都剛好在方形的繪圖範圍中</span>。</li>
</ul>
</li>
</ol>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<p>雖然ggpar可以一次畫出全部，但如果要<span style="color: #9f6ad4;">進一步加上趨勢輔助線，看變數x和y是否為線性關係，可以使用下列語法檢視</span>。</p>
<p>我們將剛剛得知有較強相關性的變數關係畫成散佈圖如下。(Ozone, Temp, Wind, Month)</p>

		<div id="crayon-60ed86b4d2dec813121299" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
scatter.smooth(x = inputData$Month, y = inputData$Temp,main = "Temp ~ Month")
scatter.smooth(x = inputData$Temp, y = inputData$Ozone,main = "Ozone ~ Temp")
scatter.smooth(x = inputData$Wind, y = inputData$Ozone,main = "Ozone ~ Wind")
scatter.smooth(x = inputData$Wind, y = inputData$Temp,main = "Temp ~ Wind")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2dec813121299-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2dec813121299-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2dec813121299-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2dec813121299-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2dec813121299-1">scatter.smooth(x = inputData$Month, y = inputData$Temp,main = "Temp ~ Month")</div><div class="crayon-line" id="crayon-60ed86b4d2dec813121299-2">scatter.smooth(x = inputData$Temp, y = inputData$Ozone,main = "Ozone ~ Temp")</div><div class="crayon-line" id="crayon-60ed86b4d2dec813121299-3">scatter.smooth(x = inputData$Wind, y = inputData$Ozone,main = "Ozone ~ Wind")</div><div class="crayon-line" id="crayon-60ed86b4d2dec813121299-4">scatter.smooth(x = inputData$Wind, y = inputData$Temp,main = "Temp ~ Wind")</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p><div id="gallery-6" class="gallery galleryid-518 gallery-columns-2 gallery-size-full"><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot03.jpeg"><img width="600" height="569" src="/wp-content/uploads/2018/08/Rplot03.jpeg" class="attachment-full size-full" alt="Rplot03" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot03.jpeg 600w,/wp-content/uploads/2018/08/Rplot03-300x285.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot04.jpeg"><img width="600" height="569" src="/wp-content/uploads/2018/08/Rplot04.jpeg" class="attachment-full size-full" alt="Rplot04" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot04.jpeg 600w,/wp-content/uploads/2018/08/Rplot04-300x285.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot05.jpeg"><img width="600" height="569" src="/wp-content/uploads/2018/08/Rplot05.jpeg" class="attachment-full size-full" alt="Rplot05" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot05.jpeg 600w,/wp-content/uploads/2018/08/Rplot05-300x285.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot06.jpeg"><img width="600" height="569" src="/wp-content/uploads/2018/08/Rplot06.jpeg" class="attachment-full size-full" alt="Rplot06" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot06.jpeg 600w,/wp-content/uploads/2018/08/Rplot06-300x285.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px"></a>
			</div></figure>
		</div>

<p>由上面四張散佈圖，可大略看到線性關係如下：</p>
<ol>
<li>雖然氣溫和部分月份數值成正向關，但根據常識，這並不是我們希望的正向關。</li>
<li>臭氧濃度會隨著氣溫上升而上升。</li>
<li>臭氧濃度會隨著風速上升而下降。</li>
<li>氣溫會隨著風速上升而下降。</li>
</ol>
<h4>離群值偵測</h4>
<p>經過上述變數關係探索後，<span style="color: #0000ff;"><span style="color: #9f6ad4;">我們將僅針對聚焦後的變數(Ozone,Temp,Wind)，進行偵測離群值</span>。</span></p>
<p>我們將使用合鬚圖(box-plot)法來偵測離群值。</p>

		<div id="crayon-60ed86b4d2dee706911128" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
boxplot(inputData$Ozone, main="Ozone", sub=paste("Outlier rows: ", paste(boxplot.stats(inputData$Ozone)$out, collapse = ","))) #有離群值
boxplot(inputData$Wind, main="Wind", sub=paste("Outlier rows: ", paste(boxplot.stats(inputData$Wind)$out, collapse = ","))) #有三個離群值
boxplot(inputData$Temp, main="Temp", sub=paste("Outlier rows: ", paste(boxplot.stats(inputData$Temp)$out, collapse = ","))) #無離群值</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2dee706911128-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2dee706911128-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2dee706911128-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2dee706911128-1">boxplot(inputData$Ozone, main="Ozone", sub=paste("Outlier rows: ", paste(boxplot.stats(inputData$Ozone)$out, collapse = ","))) #有離群值</div><div class="crayon-line" id="crayon-60ed86b4d2dee706911128-2">boxplot(inputData$Wind, main="Wind", sub=paste("Outlier rows: ", paste(boxplot.stats(inputData$Wind)$out, collapse = ","))) #有三個離群值</div><div class="crayon-line" id="crayon-60ed86b4d2dee706911128-3">boxplot(inputData$Temp, main="Temp", sub=paste("Outlier rows: ", paste(boxplot.stats(inputData$Temp)$out, collapse = ","))) #無離群值</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p> </p>
<div id="gallery-7" class="gallery galleryid-518 gallery-columns-2 gallery-size-full"><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot07.jpeg"><img width="600" height="569" src="/wp-content/uploads/2018/08/Rplot07.jpeg" class="attachment-full size-full" alt="Rplot07" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot07.jpeg 600w,/wp-content/uploads/2018/08/Rplot07-300x285.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot08.jpeg"><img width="600" height="569" src="/wp-content/uploads/2018/08/Rplot08.jpeg" class="attachment-full size-full" alt="Rplot08" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot08.jpeg 600w,/wp-content/uploads/2018/08/Rplot08-300x285.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot09.jpeg"><img width="600" height="569" src="/wp-content/uploads/2018/08/Rplot09.jpeg" class="attachment-full size-full" alt="Rplot09" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot09.jpeg 600w,/wp-content/uploads/2018/08/Rplot09-300x285.jpeg 300w" sizes="(max-width: 600px) 100vw, 600px"></a>
			</div></figure>
		</div>

<p>由盒鬚圖可知，臭氧濃度(Ozone)跟風速(Wind)都有一些離群值。</p>
<p>由上述發現可知，<span style="color: #9f6ad4;">針對聚焦後的變數(Ozone, Temp, Wind)</span>，接下來需要處理：</p>
<ol>
<li>離群值處理：Ozone(2), Wind(3)。</li>
<li>變數標準化: 使不衡量尺度（單位）間的變數關係不受數值大小所影響。</li>
<li>變數轉換：盡可能讓變數分佈符合常態，以符合線性迴歸基本假設。</li>
<li>空值填補：Ozone(37)。</li>
</ol>
<h3>3. 資料前處理</h3>
<h4>3-1. 離群值處理</h4>
<p>針對聚焦的三個變數(Ozone,Temp,Wind)，<span style="color: #0000ff;"><span style="color: #9f6ad4;">本範例會將離群值填補為NA，再之後跟其他空值一併使用MICE方法預測</span>。</span></p>
<p>偵測離群值(<span style="color: #9f6ad4;">回傳的是離群數值，而非資料列index</span>)。</p>

		<div id="crayon-60ed86b4d2df0952091009" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
boxplot.stats(inputData$Ozone)$out
# [1] 135 168
boxplot.stats(inputData$Wind)$out
# [1] 20.1 18.4 20.7
boxplot.stats(inputData$Temp)$out
# integer(0)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2df0952091009-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2df0952091009-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2df0952091009-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2df0952091009-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2df0952091009-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2df0952091009-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2df0952091009-1">boxplot.stats(inputData$Ozone)$out</div><div class="crayon-line" id="crayon-60ed86b4d2df0952091009-2"># [1] 135 168</div><div class="crayon-line" id="crayon-60ed86b4d2df0952091009-3">boxplot.stats(inputData$Wind)$out</div><div class="crayon-line" id="crayon-60ed86b4d2df0952091009-4"># [1] 20.1 18.4 20.7</div><div class="crayon-line" id="crayon-60ed86b4d2df0952091009-5">boxplot.stats(inputData$Temp)$out</div><div class="crayon-line" id="crayon-60ed86b4d2df0952091009-6"># integer(0)</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>將離群值填補為NA。</p>

		<div id="crayon-60ed86b4d2df1082862804" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 將遺失值用NA填補
tempData <- inputData
outlier <- function(x) {
x[x > quantile(x,probs = 0.75,na.rm = T) + 1.5 * IQR(x, na.rm = T) |
x < quantile(x,probs = 0.25, na.rm = T) - 1.5 * IQR(x, na.rm = T)] <- NA
x
}
# apply()的第一個參數只能接受「矩陣」物件，意味著所有元素必須是同一類
# 若用在其他結構的物件，如data.frame，他就會先被轉換成matrix
tempData <- apply(X = tempData,MARGIN = 2,FUN = outlier)
# tempData
tempData<- as.data.frame(tempData)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-11">11</div><div class="crayon-num" data-line="crayon-60ed86b4d2df1082862804-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2df1082862804-1"># 將遺失值用NA填補</div><div class="crayon-line" id="crayon-60ed86b4d2df1082862804-2">tempData <div class="crayon-line" id="crayon-60ed86b4d2df1082862804-3">outlier <div class="crayon-line" id="crayon-60ed86b4d2df1082862804-4">x[x > quantile(x,probs = 0.75,na.rm = T) + 1.5 * IQR(x, na.rm = T) |</div><div class="crayon-line" id="crayon-60ed86b4d2df1082862804-5">x <div class="crayon-line" id="crayon-60ed86b4d2df1082862804-6">x</div><div class="crayon-line" id="crayon-60ed86b4d2df1082862804-7">}</div><div class="crayon-line" id="crayon-60ed86b4d2df1082862804-8"># apply()的第一個參數只能接受「矩陣」物件，意味著所有元素必須是同一類</div><div class="crayon-line" id="crayon-60ed86b4d2df1082862804-9"># 若用在其他結構的物件，如data.frame，他就會先被轉換成matrix</div><div class="crayon-line" id="crayon-60ed86b4d2df1082862804-10">tempData <div class="crayon-line" id="crayon-60ed86b4d2df1082862804-11"># tempData</div><div class="crayon-line" id="crayon-60ed86b4d2df1082862804-12">tempData</div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>檢視離群值處理後的結果。</p>

		<div id="crayon-60ed86b4d2df3770989034" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(tempData) #check Ozone NA數為37+2, Wind NA數為3

#         Ozone          Solar.R         Wind            Temp          Month           Day      
# Min.   :  1.0   Min.   :  7   Min.   : 1.70   Min.   :56.0   Min.   :5.00   Min.   : 1.0  
# 1st Qu.: 18.0   1st Qu.:116   1st Qu.: 7.40   1st Qu.:72.0   1st Qu.:6.00   1st Qu.: 8.0  
# Median : 30.5   Median :205   Median : 9.70   Median :79.0   Median :7.00   Median :16.0  
# Mean   : 40.2   Mean   :186   Mean   : 9.76   Mean   :77.9   Mean   :6.99   Mean   :15.8  
# 3rd Qu.: 60.5   3rd Qu.:259   3rd Qu.:11.50   3rd Qu.:85.0   3rd Qu.:8.00   3rd Qu.:23.0  
# Max.   :122.0   Max.   :334   Max.   :16.60   Max.   :97.0   Max.   :9.00   Max.   :31.0  
# NA's   :39      NA's   :7     NA's   :3</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2df3770989034-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-1">summary(tempData) #check Ozone NA數為37+2, Wind NA數為3</div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-2"> </div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-3">#         Ozone          Solar.R         Wind            Temp          Month           Day      </div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-4"># Min.   :  1.0   Min.   :  7   Min.   : 1.70   Min.   :56.0   Min.   :5.00   Min.   : 1.0  </div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-5"># 1st Qu.: 18.0   1st Qu.:116   1st Qu.: 7.40   1st Qu.:72.0   1st Qu.:6.00   1st Qu.: 8.0  </div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-6"># Median : 30.5   Median :205   Median : 9.70   Median :79.0   Median :7.00   Median :16.0  </div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-7"># Mean   : 40.2   Mean   :186   Mean   : 9.76   Mean   :77.9   Mean   :6.99   Mean   :15.8  </div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-8"># 3rd Qu.: 60.5   3rd Qu.:259   3rd Qu.:11.50   3rd Qu.:85.0   3rd Qu.:8.00   3rd Qu.:23.0  </div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-9"># Max.   :122.0   Max.   :334   Max.   :16.60   Max.   :97.0   Max.   :9.00   Max.   :31.0  </div><div class="crayon-line" id="crayon-60ed86b4d2df3770989034-10"># NA's   :39      NA's   :7     NA's   :3</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>檢視離群值處理後變數分佈的變化。</p>

		<div id="crayon-60ed86b4d2df4581266176" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 經過極端值處理後：
# Ozone超級偏(skewness = 1.21 -> 0.94)
plot(density(tempData$Ozone, na.rm = TRUE), main="Density Plot: Ozone", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(tempData$Ozone, na.rm = TRUE), 2)))
# Wind 平均值右偏(skewness = 0.34 -> 0.06)
plot(density(tempData$Wind, na.rm = TRUE), main="Density Plot: Wind", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(tempData$Wind, na.rm = TRUE), 2)))
# Temp 平均值左篇(skewness = -0.37 -> =0.37)沒影響
plot(density(tempData$Temp, na.rm = TRUE), main="Density Plot: Temp", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(tempData$Temp, na.rm = TRUE), 2)))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2df4581266176-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2df4581266176-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2df4581266176-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2df4581266176-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2df4581266176-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2df4581266176-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2df4581266176-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2df4581266176-1"># 經過極端值處理後：</div><div class="crayon-line" id="crayon-60ed86b4d2df4581266176-2"># Ozone超級偏(skewness = 1.21 -> 0.94)</div><div class="crayon-line" id="crayon-60ed86b4d2df4581266176-3">plot(density(tempData$Ozone, na.rm = TRUE), main="Density Plot: Ozone", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(tempData$Ozone, na.rm = TRUE), 2)))</div><div class="crayon-line" id="crayon-60ed86b4d2df4581266176-4"># Wind 平均值右偏(skewness = 0.34 -> 0.06)</div><div class="crayon-line" id="crayon-60ed86b4d2df4581266176-5">plot(density(tempData$Wind, na.rm = TRUE), main="Density Plot: Wind", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(tempData$Wind, na.rm = TRUE), 2)))</div><div class="crayon-line" id="crayon-60ed86b4d2df4581266176-6"># Temp 平均值左篇(skewness = -0.37 -> =0.37)沒影響</div><div class="crayon-line" id="crayon-60ed86b4d2df4581266176-7">plot(density(tempData$Temp, na.rm = TRUE), main="Density Plot: Temp", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(tempData$Temp, na.rm = TRUE), 2)))</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>可以看到：</p>
<ol>
<li>Ozone skewness有減少(skewness = 1.21 -> 0.94)，但視覺上還是沒有非常接近常態分佈。</li>
<li>Wind的skewness有從0.34減少到0.06，視覺上已接近常態。</li>
<li>Temp的部份因為透過box-plot沒有偵測到明顯離群值，故在此沒有變化。</li>
</ol>
<div id="gallery-8" class="gallery galleryid-518 gallery-columns-2 gallery-size-full"><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot12.jpeg"><img width="800" height="787" src="/wp-content/uploads/2018/08/Rplot12.jpeg" class="attachment-full size-full" alt="Rplot12" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot12.jpeg 800w,/wp-content/uploads/2018/08/Rplot12-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot12-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot12-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot13.jpeg"><img width="800" height="787" src="/wp-content/uploads/2018/08/Rplot13.jpeg" class="attachment-full size-full" alt="Rplot13" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot13.jpeg 800w,/wp-content/uploads/2018/08/Rplot13-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot13-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot13-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot14.jpeg"><img width="800" height="787" src="/wp-content/uploads/2018/08/Rplot14.jpeg" class="attachment-full size-full" alt="Rplot14" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot14.jpeg 800w,/wp-content/uploads/2018/08/Rplot14-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot14-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot14-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></a>
			</div></figure>
		</div>

<p>用新的資料偵測離群值，可發現使用box-plot法，已無離群值。</p>

		<div id="crayon-60ed86b4d2df5476852348" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# (2)outlier detection 離群值偵測 =>都沒有了
boxplot(tempData$Ozone, main="Ozone", sub=paste("Outlier rows: ", paste(boxplot.stats(tempData$Ozone)$out, collapse = ","))) #有離群值
boxplot(tempData$Wind, main="Wind", sub=paste("Outlier rows: ", paste(boxplot.stats(tempData$Wind)$out, collapse = ","))) #有三個離群值
boxplot(tempData$Temp, main="Temp", sub=paste("Outlier rows: ", paste(boxplot.stats(tempData$Temp)$out, collapse = ","))) #無黎群值</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2df5476852348-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2df5476852348-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2df5476852348-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2df5476852348-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2df5476852348-1"># (2)outlier detection 離群值偵測 =>都沒有了</div><div class="crayon-line" id="crayon-60ed86b4d2df5476852348-2">boxplot(tempData$Ozone, main="Ozone", sub=paste("Outlier rows: ", paste(boxplot.stats(tempData$Ozone)$out, collapse = ","))) #有離群值</div><div class="crayon-line" id="crayon-60ed86b4d2df5476852348-3">boxplot(tempData$Wind, main="Wind", sub=paste("Outlier rows: ", paste(boxplot.stats(tempData$Wind)$out, collapse = ","))) #有三個離群值</div><div class="crayon-line" id="crayon-60ed86b4d2df5476852348-4">boxplot(tempData$Temp, main="Temp", sub=paste("Outlier rows: ", paste(boxplot.stats(tempData$Temp)$out, collapse = ","))) #無黎群值</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p><div id="gallery-9" class="gallery galleryid-518 gallery-columns-2 gallery-size-full"><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot03-1.jpeg"><img width="700" height="586" src="/wp-content/uploads/2018/08/Rplot03-1.jpeg" class="attachment-full size-full" alt="Rplot03" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot03-1.jpeg 700w,/wp-content/uploads/2018/08/Rplot03-1-300x251.jpeg 300w,/wp-content/uploads/2018/08/Rplot03-1-230x193.jpeg 230w,/wp-content/uploads/2018/08/Rplot03-1-350x293.jpeg 350w,/wp-content/uploads/2018/08/Rplot03-1-480x402.jpeg 480w" sizes="(max-width: 700px) 100vw, 700px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot04-1.jpeg"><img width="700" height="586" src="/wp-content/uploads/2018/08/Rplot04-1.jpeg" class="attachment-full size-full" alt="Rplot04" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot04-1.jpeg 700w,/wp-content/uploads/2018/08/Rplot04-1-300x251.jpeg 300w,/wp-content/uploads/2018/08/Rplot04-1-230x193.jpeg 230w,/wp-content/uploads/2018/08/Rplot04-1-350x293.jpeg 350w,/wp-content/uploads/2018/08/Rplot04-1-480x402.jpeg 480w" sizes="(max-width: 700px) 100vw, 700px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot05-1.jpeg"><img width="700" height="586" src="/wp-content/uploads/2018/08/Rplot05-1.jpeg" class="attachment-full size-full" alt="Rplot05" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot05-1.jpeg 700w,/wp-content/uploads/2018/08/Rplot05-1-300x251.jpeg 300w,/wp-content/uploads/2018/08/Rplot05-1-230x193.jpeg 230w,/wp-content/uploads/2018/08/Rplot05-1-350x293.jpeg 350w,/wp-content/uploads/2018/08/Rplot05-1-480x402.jpeg 480w" sizes="(max-width: 700px) 100vw, 700px"></a>
			</div></figure>
		</div>

<h4>3-2. 標準化</h4>
<p>將所有變數標準化(0 to 1)。</p>

		<div id="crayon-60ed86b4d2df7043102436" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
tempData2 <- apply(tempData, 2, function(x){(x-min(x, na.rm = T))/(max(x, na.rm = T)-min(x, na.rm = T))})
tempData2 <- as.data.frame(tempData2)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2df7043102436-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2df7043102436-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2df7043102436-1">tempData2 <div class="crayon-line" id="crayon-60ed86b4d2df7043102436-2">tempData2 </div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<h4>3-3. 變數轉換(\(X_{transform} = \log_{10}X\))</h4>
<p>透過變數log10轉換，來使變數更近似常態分配(僅針對Ozone)。</p>

		<div id="crayon-60ed86b4d2df8894558727" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
subTempData <- tempData2[,c(1)]
subTempData2 <- sapply(subTempData, function(x){x <- log10(x+1)})
tempData2$Ozone_log10 <- as.vector(subTempData2)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2df8894558727-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2df8894558727-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2df8894558727-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2df8894558727-1">subTempData <div class="crayon-line" id="crayon-60ed86b4d2df8894558727-2">subTempData2 <div class="crayon-line" id="crayon-60ed86b4d2df8894558727-3">tempData2$Ozone_log10 </div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>檢視變數轉換後Ozone的機率密度分佈圖。</p>

		<div id="crayon-60ed86b4d2df9704447645" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# Ozone_log10(skewness = 1.21 -> 0.94 ->0.69)
plot(density(tempData2$Ozone_log10, na.rm = TRUE), main="Density Plot: Ozone", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(tempData2$Ozone_log10, na.rm = TRUE), 2)))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2df9704447645-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2df9704447645-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2df9704447645-1"># Ozone_log10(skewness = 1.21 -> 0.94 ->0.69)</div><div class="crayon-line" id="crayon-60ed86b4d2df9704447645-2">plot(density(tempData2$Ozone_log10, na.rm = TRUE), main="Density Plot: Ozone", ylab="Frequency", sub=paste("Skewness:", round(e1071::skewness(tempData2$Ozone_log10, na.rm = TRUE), 2)))</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>可以發現經log10轉換後的Ozone_log10的skewness有降低，但視覺上分佈還是不是那麼常態。(skewness = 1.21 -> 0.94 ->0.69)</p>
<p><img loading="lazy" class="alignnone size-full wp-image-727" src="/wp-content/uploads/2018/08/Rplot15.jpeg" alt="linear regression" width="800" height="787" srcset="/wp-content/uploads/2018/08/Rplot15.jpeg 800w,/wp-content/uploads/2018/08/Rplot15-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot15-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot15-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></p>
<h4>3-4. 空值填補(MICE, Multivariate Imputation by Chained Equations)</h4>
<p>當一個特徵變數空值資料占比超過5%就有必要做空值填補之處理。我們建立一個函數用來檢查每個特徵變數遺失資料列佔比。可以發現臭氧Ozone的遺失比例高達25%(原始資料遺失＋離群值NA)。</p>

		<div id="crayon-60ed86b4d2dfa954199946" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
pMiss <- function(x){sum(is.na(x))/length(x)*100}
apply(tempData2[,-1],2,pMiss)

#  Solar.R        Wind        Temp       Month         Day Ozone_log10 
# 4.575163    1.960784    0.000000    0.000000    0.000000   25.490196</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2dfa954199946-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfa954199946-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfa954199946-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfa954199946-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfa954199946-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2dfa954199946-1">pMiss <div class="crayon-line" id="crayon-60ed86b4d2dfa954199946-2">apply(tempData2[,-1],2,pMiss)</div><div class="crayon-line" id="crayon-60ed86b4d2dfa954199946-3"> </div><div class="crayon-line" id="crayon-60ed86b4d2dfa954199946-4">#  Solar.R        Wind        Temp       Month         Day Ozone_log10 </div><div class="crayon-line" id="crayon-60ed86b4d2dfa954199946-5"># 4.575163    1.960784    0.000000    0.000000    0.000000   25.490196</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>在此我們選擇使用<span style="text-decoration: underline;"><span style="color: #9f6ad4; text-decoration: underline;">MICE Package</span></span>來處理Ozone的遺失值。（更多有關遺失值處理請參考：「<a href="/%e3%80%8c%e7%b5%b1%e8%a8%88%e2%80%a2r%e8%aa%9e%e8%a8%80%e2%80%a2%e9%81%ba%e5%a4%b1%e5%80%bc%e8%99%95%e7%90%86%e3%80%8dmissing-value-treatment/" target="_blank" rel="noopener noreferrer">遺失值處理方法</a>」）</p>
<p><strong>MICE代表： Multivariate Imputations by Chained Equations (MICE)，具有以下幾個特點：</strong></p>
<ul>
<li>主要可用來產生<span style="text-decoration: underline;">多元變數(multivariate)</span>的<span style="text-decoration: underline;">多組空值填補值(multiple imputations)</span>（可透過mice()函式中的<span style="color: #9f6ad4;"><span style="text-decoration: underline;">參數m，number of mutiple imputations</span>，</span>來指定要產生幾組填補值解，預設為5組）。</li>
<li>透過<a href="https://zh.wikipedia.org/wiki/%E5%90%89%E5%B8%83%E6%96%AF%E9%87%87%E6%A0%B7">Gibbs sampling</a>法來對多元變數產稱多組空值填補值。</li>
<li>MICE填補方法是採用Fully Conditional Specification，即<span style="color: #9f6ad4;">每一個不完整的變數都是分別用獨立的模型來預測空值的</span>。</li>
<li>MICE可處理連續型變數(continuous)、二元變數(binary)、無順序類別型變數(unordered categorical)、有序類別變數(ordered categorical)。</li>
<li>MICE在預測目標欄位時(target column)，<span style="text-decoration: underline;">預設會使用其他非目標欄位來作為預測變數(predictors)</span>。如遇預測變數本身也不完整的情況，最新產生的一組填補值會被用來完整預測變數，再進行目標變數的填補預測。</li>
<li>我們可以替不同欄位指定各自的單變數填補模型(univariate imputation model)，使用方法範例：mice(data, meth=c(‘sample’,’pmm’,’logreg’,’norm’)))。</li>
<li>單變數填補模型可以使用<span style="text-decoration: underline;">內建的方法</span>或是<span style="text-decoration: underline; color: #9f6ad4;">自訂方法(mice.impute.myfunc)</span>(mice(method = c(“xxx”, “<span style="color: #9f6ad4;">myfunc</span>“))。</li>
<li>常見的幾種內建填補模型包括：
<ul>
<li>pmm (Predictive mean matching) : 任何變數型態</li>
<li>cart (Classification and regression trees) : 任何變數型態</li>
<li>rf (Random forest imputations) : 任何變數型態</li>
<li> logreg (Logistic regression) : 二元類別型態 (binary)</li>
</ul>
</li>
</ul>
<p><strong>MICE package套件中的主要函式說明：</strong></p>
<ul>
<li>md.pattern() : inspect the missing data pattern</li>
<li>mice(): impute the missing values *m* times</li>
<li>with(): analyzed completed data sets => Performs a computation of each of imputed datasets in data. with (data, expr<span style="color: #9f6ad4;"> = formula</span>, …)。將產生的m組填補值套用到計算公式。</li>
<li>pool(): combine parameter estimates => Pool the results of the repeated analyses。綜合m組填補數據所產生的模型的估計係數(estimates)、標準差(std.error)、和p-value。</li>
<li><a href="https://www.rdocumentation.org/packages/mice/versions/3.3.0/topics/pool.compare">pool.compare()</a> : pool.compare(fit1, fit0, method = c(“wald”, “likelihood”), data = NULL)。使用方法”wald”或”likelihood”來比較<span style="text-decoration: underline;">兩種模型公式</span>套用在所有填補數據的綜合結果。</li>
<li>complete(): export imputed data 儲存和輸出其中一組完整填補數據</li>
<li>ampute(): generate missing data => Generate simulated incomplete data 產生模擬的不完整數據</li>
</ul>
<p>首先，因為MICE處理遺失值的假設為，<span style="color: #9f6ad4;">資料為隨機遺失(Missing Completely At Random, MCAR)</span>，所以在使用套件前，<span style="color: #9f6ad4;">我們先使用mice套件中的md.pattern()函數來檢視資料遺失分佈的狀況</span>。我們可以看到有106列資料是完整的，37列資料缺Ozone，5列資料缺Solar.R，2列資料同時缺Ozone&Solar.R。3列資料缺Wind。Ozone總遺失數為39，Solar.R總遺失數為7，Wind總遺失數為3。</p>

		<div id="crayon-60ed86b4d2dfc997459510" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(mice)
md.pattern(tempData2[,-1])

#     Temp Month Day Wind Solar.R Ozone_log10   
# 106    1     1   1    1       1           1  0
# 37     1     1   1    1       1           0  1
# 5      1     1   1    1       0           1  1
# 2      1     1   1    1       0           0  2
# 3      1     1   1    0       1           1  1
#        0     0   0    3       7          39 49</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfc997459510-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-1">library(mice)</div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-2">md.pattern(tempData2[,-1])</div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-3"> </div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-4">#     Temp Month Day Wind Solar.R Ozone_log10   </div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-5"># 106    1     1   1    1       1           1  0</div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-6"># 37     1     1   1    1       1           0  1</div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-7"># 5      1     1   1    1       0           1  1</div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-8"># 2      1     1   1    1       0           0  2</div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-9"># 3      1     1   1    0       1           1  1</div><div class="crayon-line" id="crayon-60ed86b4d2dfc997459510-10">#        0     0   0    3       7          39 49</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>我們使用VIM(Visualization and Imputation of Missing Values)套件中的aggr()函數將上述結果用更有效的視覺化圖表來檢視。</p>

		<div id="crayon-60ed86b4d2dfe271345891" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(VIM)
aggr_plot <- aggr(tempData2[,-1], col=c('navyblue','red'), numbers=TRUE, sortVars=TRUE, labels=names(data), cex.axis=.7, gap=3, ylab=c("Histogram of missing data","Pattern"))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2dfe271345891-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2dfe271345891-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2dfe271345891-1">library(VIM)</div><div class="crayon-line" id="crayon-60ed86b4d2dfe271345891-2">aggr_plot </div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<ul>
<li>左圖：各特徵變數的遺失資料比例</li>
<li>右圖：遺失狀況分佈pattern。由圖可知，有近7成資料是完整的，單單遺失Ozone的資料列高達近25%。</li>
</ul>
<p><img loading="lazy" class="alignnone size-full wp-image-1415" src="/wp-content/uploads/2018/08/Rplot01-2.jpeg" alt="linear regression" width="700" height="586" srcset="/wp-content/uploads/2018/08/Rplot01-2.jpeg 700w,/wp-content/uploads/2018/08/Rplot01-2-300x251.jpeg 300w,/wp-content/uploads/2018/08/Rplot01-2-230x193.jpeg 230w,/wp-content/uploads/2018/08/Rplot01-2-350x293.jpeg 350w,/wp-content/uploads/2018/08/Rplot01-2-480x402.jpeg 480w" sizes="(max-width: 700px) 100vw, 700px"></p>
<p> </p>
<p>而如何檢視資料的<span style="color: #9f6ad4;">遺失分佈是屬於隨機(Missing Completely At Random, MCAR)</span>，就是使用<span style="color: #9f6ad4;">VIM套件的marginplot()</span>函數。關於marginplot()的一些特性如下：</p>
<ul>
<li>一次只能畫出兩維度(變量A&B)遺失分佈關係。在此，因為 Ozone和Solar.R的遺失比例最高，我們將檢視此二變數遺失分佈是否隨機</li>
<li>圖的兩軸最外側盒鬚圖：變量A中，對應變量B完整（藍色）/遺失（紅色）的分佈。</li>
<li>圖的兩軸內側散佈圖：單一變量A在的變量B發生遺失值的散佈圖。</li>
<li>圖的最左下角為變量A與變量B同時遺失的列數。其上方與右方數字則分別表單變量遺失的列數。</li>
<li>圖中央則為兩變數A&B的散佈圖。</li>
<li>如果IQR區間重疊，且盒鬚圖分佈相似，則變量A與變量B的遺失值分佈為隨機，符合MCAR假設。</li>
</ul>
<p></p>

		<div id="crayon-60ed86b4d2dff903191404" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# Solar.R & Ozone_log10
marginplot(tempData2[c(2,7)])</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2dff903191404-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2dff903191404-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2dff903191404-1"># Solar.R & Ozone_log10</div><div class="crayon-line" id="crayon-60ed86b4d2dff903191404-2">marginplot(tempData2[c(2,7)])</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>我們從下圖可觀察到：</p>
<ul>
<li>圖左側紅色盒鬚圖為Ozone中Solar.R遺失資料點的分佈，藍色則為其餘Ozone資料點分佈。</li>
<li>圖下側紅色盒鬚圖為Solar.R中Ozone遺失資料點的分佈，藍色則為其餘Solar.R資料點分佈。</li>
<li>從圖兩側我們可以發現，IQR區間是重疊的，且紅色藍色盒鬚圖分佈相似，因此Var1(Solar.R)與Var2(Ozone)的遺失分佈為隨機的，符合MCAR假設。</li>
</ul>
<p><img loading="lazy" class="alignnone size-full wp-image-1420" src="/wp-content/uploads/2018/08/Rplot02-3.jpeg" alt="linear regression" width="700" height="586" srcset="/wp-content/uploads/2018/08/Rplot02-3.jpeg 700w,/wp-content/uploads/2018/08/Rplot02-3-300x251.jpeg 300w,/wp-content/uploads/2018/08/Rplot02-3-230x193.jpeg 230w,/wp-content/uploads/2018/08/Rplot02-3-350x293.jpeg 350w,/wp-content/uploads/2018/08/Rplot02-3-480x402.jpeg 480w" sizes="(max-width: 700px) 100vw, 700px"></p>
<p> </p>
<p>使用mice()函數進行空值填補，幾個重要參數如下：</p>
<ul>
<li>參數m表示要產生幾組填補數據集。預設為產生5組填補數據集。我們將它設為50組。</li>
<li>參數method (or meth)表示填補方法。在本範例中，因為變數皆為數值，我將使用預設的pmm(predictive mean matching)法。其他方法包括：
<ul>
<li>PMM (Predictive Mean Matching) – For any type variables</li>
<li>logreg(Logistic Regression) – For binary variables( with 2 levels)</li>
<li>polyreg(Polytomous logistic regression) – For unordered categorical/factor variables (>= 2 levels)</li>
<li>polr (Proportional odds model) –  For ordered categorical variables ( >= 2 levels)</li>
</ul>
</li>
<li>參數maxit表示用於計算遺失值的<span style="color: #9f6ad4;">迭代次數，預設為5</span>。本範例將迭代次數設為50。</li>
</ul>
<p></p>

		<div id="crayon-60ed86b4d2e00160935884" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 先選取後續會分析的變數Wind,Temp,Ozone_log10
tempData2 <- tempData2[,c(3,4,7)]
tempData3 <- mice(tempData2,m=50,maxit=50,meth='pmm',seed=500)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e00160935884-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e00160935884-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e00160935884-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e00160935884-1"># 先選取後續會分析的變數Wind,Temp,Ozone_log10</div><div class="crayon-line" id="crayon-60ed86b4d2e00160935884-2">tempData2 <div class="crayon-line" id="crayon-60ed86b4d2e00160935884-3">tempData3 </div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>使用summary()來看一下填補的結果。可以看到各特徵變數所使用的補值法分別為何，以及填補各目標變數(y)所投入的預測變數(x)。</p>

		<div id="crayon-60ed86b4d2e02983901982" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(tempData3)

# Class: mids
# Number of multiple imputations:  50 
# Imputation methods:
#        Wind        Temp Ozone_log10 
#       "pmm"          ""       "pmm" 
# PredictorMatrix:
#             Wind Temp Ozone_log10
# Wind           0    1           1
# Temp           1    0           1
# Ozone_log10    1    1           0</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-11">11</div><div class="crayon-num" data-line="crayon-60ed86b4d2e02983901982-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-1">summary(tempData3)</div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-2"> </div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-3"># Class: mids</div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-4"># Number of multiple imputations:  50 </div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-5"># Imputation methods:</div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-6">#        Wind        Temp Ozone_log10 </div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-7">#       "pmm"          ""       "pmm" </div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-8"># PredictorMatrix:</div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-9">#             Wind Temp Ozone_log10</div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-10"># Wind           0    1           1</div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-11"># Temp           1    0           1</div><div class="crayon-line" id="crayon-60ed86b4d2e02983901982-12"># Ozone_log10    1    1           0</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>查看特定特徵值變數填補後的數值可用$imp$var。（列數為該變數有遺失值的列數，行數為各組填補數據集數，本範例為50組）。以Wind為例，遺失的三筆資料，填補後的50組數據集如下：</p>

		<div id="crayon-60ed86b4d2e07990928931" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
#> tempData3$imp$Wind
#> 1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19
#> 9  0.617 0.846 0.537 0.846 0.577 0.423 0.537 0.349 0.349 0.537 0.349 0.463 0.349 0.349 0.617 0.349 0.812 0.577 0.846
#> 18 0.846 0.577 0.577 0.846 0.537 0.423 0.537 0.577 0.577 0.537 0.886 0.537 0.577 0.537 0.537 0.349 0.846 0.537 0.577
#> 48 0.617 0.617 0.423 0.577 0.886 0.349 0.423 0.926 0.617 0.423 0.537 0.617 0.383 0.423 0.658 0.577 0.383 0.349 0.658
#> 20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38
#> 9  0.537 0.577 0.537 0.537 1.000 0.846 0.772 0.617 0.658 0.658 0.577 0.846 0.537 0.846 0.423 0.537 0.537 0.423 0.846
#> 18 0.537 0.617 0.537 0.537 0.732 0.423 0.658 0.503 0.423 0.658 0.846 0.577 0.846 0.846 0.537 0.617 0.577 0.423 0.463
#> 48 0.423 0.463 0.309 0.886 0.812 0.195 0.309 0.383 0.383 0.423 0.537 0.658 0.577 0.349 0.309 0.537 0.383 0.537 0.886
#> 39    40    41    42    43    44    45    46    47    48    49    50
#> 9  1.000 1.000 0.846 0.577 0.617 0.537 0.537 0.349 0.503 0.812 0.617 0.537
#> 18 0.577 0.537 0.886 0.732 0.537 0.537 0.537 0.537 0.846 0.846 0.846 0.537
#> 48 0.349 0.309 0.537 0.383 0.658 0.349 0.812 0.886 0.349 0.503 0.383 0.423</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-11">11</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-12">12</div><div class="crayon-num" data-line="crayon-60ed86b4d2e07990928931-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-1">#> tempData3$imp$Wind</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-2">#> 1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-3">#> 9  0.617 0.846 0.537 0.846 0.577 0.423 0.537 0.349 0.349 0.537 0.349 0.463 0.349 0.349 0.617 0.349 0.812 0.577 0.846</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-4">#> 18 0.846 0.577 0.577 0.846 0.537 0.423 0.537 0.577 0.577 0.537 0.886 0.537 0.577 0.537 0.537 0.349 0.846 0.537 0.577</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-5">#> 48 0.617 0.617 0.423 0.577 0.886 0.349 0.423 0.926 0.617 0.423 0.537 0.617 0.383 0.423 0.658 0.577 0.383 0.349 0.658</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-6">#> 20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-7">#> 9  0.537 0.577 0.537 0.537 1.000 0.846 0.772 0.617 0.658 0.658 0.577 0.846 0.537 0.846 0.423 0.537 0.537 0.423 0.846</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-8">#> 18 0.537 0.617 0.537 0.537 0.732 0.423 0.658 0.503 0.423 0.658 0.846 0.577 0.846 0.846 0.537 0.617 0.577 0.423 0.463</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-9">#> 48 0.423 0.463 0.309 0.886 0.812 0.195 0.309 0.383 0.383 0.423 0.537 0.658 0.577 0.349 0.309 0.537 0.383 0.537 0.886</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-10">#> 39    40    41    42    43    44    45    46    47    48    49    50</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-11">#> 9  1.000 1.000 0.846 0.577 0.617 0.537 0.537 0.349 0.503 0.812 0.617 0.537</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-12">#> 18 0.577 0.537 0.886 0.732 0.537 0.537 0.537 0.537 0.846 0.846 0.846 0.537</div><div class="crayon-line" id="crayon-60ed86b4d2e07990928931-13">#> 48 0.349 0.309 0.537 0.383 0.658 0.349 0.812 0.886 0.349 0.503 0.383 0.423</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<h3>4. 建立線性模型 linear regression model</h3>
<p>最後我們來使用處理好的數據來建立回歸模型。</p>
<p>4-1. Pooling: 使用剛剛填補的50組的資料建模，並摘要綜合50組模型的效果。建模結果顯示預測變數皆為顯著。(p-value < 0.05)</p>

		<div id="crayon-60ed86b4d2e08792611568" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 使用不同的datasets(m=50)分別建模，並綜合摘要結果
modelFit1 <- with(tempData3,lm(Ozone_log10 ~ Temp + Wind))
summary(pool(modelFit1))
# 根據p-value，預測變數Temp & Wind 都有顯著

#                estimate  std.error statistic       df      p.value
# (Intercept)  0.06810694 0.02245463  3.033091 67.91444 3.255054e-03
# Temp         0.19479181 0.02223289  8.761425 80.70210 2.420286e-13
# Wind        -0.10332966 0.02533499 -4.078536 64.42491 1.056795e-04</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2e08792611568-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e08792611568-1"># 使用不同的datasets(m=50)分別建模，並綜合摘要結果</div><div class="crayon-line" id="crayon-60ed86b4d2e08792611568-2">modelFit1 <div class="crayon-line" id="crayon-60ed86b4d2e08792611568-3">summary(pool(modelFit1))</div><div class="crayon-line" id="crayon-60ed86b4d2e08792611568-4"># 根據p-value，預測變數Temp & Wind 都有顯著</div><div class="crayon-line" id="crayon-60ed86b4d2e08792611568-5"> </div><div class="crayon-line" id="crayon-60ed86b4d2e08792611568-6">#                estimate  std.error statistic       df      p.value</div><div class="crayon-line" id="crayon-60ed86b4d2e08792611568-7"># (Intercept)  0.06810694 0.02245463  3.033091 67.91444 3.255054e-03</div><div class="crayon-line" id="crayon-60ed86b4d2e08792611568-8"># Temp         0.19479181 0.02223289  8.761425 80.70210 2.420286e-13</div><div class="crayon-line" id="crayon-60ed86b4d2e08792611568-9"># Wind        -0.10332966 0.02533499 -4.078536 64.42491 1.056795e-04</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>4-2. 使用complete()隨機挑選一組填補後的dataset來建模(預設是第一組，但也可以透過參數調整)。發現模型配適結果也是顯著的(p-value < 0.05)。</p>

		<div id="crayon-60ed86b4d2e0a056146752" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
completedData <- complete(tempData3,1) #預設是挑第一組，也可以更改第二個參數
modelFit2 <- lm(Ozone_log10 ~ Temp + Wind, completedData)
summary(modelFit2)

# Call:
# lm(formula = Ozone_log10 ~ Temp + Wind, data = completedData)
# 
# Residuals:
#       Min        1Q    Median        3Q       Max 
# -0.108651 -0.030307 -0.004117  0.034658  0.142650 
# 
# Coefficients:
#               Estimate Std. Error t value Pr(>|t|)    
#   (Intercept)  0.06882    0.01713   4.017 9.29e-05 ***
#   Temp         0.18569    0.01784  10.409  < 2e-16 ***
#   Wind        -0.10191    0.01883  -5.412 2.42e-07 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# Residual standard error: 0.04581 on 150 degrees of freedom
# Multiple R-squared:  0.6041,	Adjusted R-squared:  0.5988 
# F-statistic: 114.4 on 2 and 150 DF,  p-value: < 2.2e-16</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-11">11</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-12">12</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-13">13</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-14">14</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-15">15</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-16">16</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-17">17</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-18">18</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-19">19</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-20">20</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-21">21</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0a056146752-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-1">completedData <div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-2">modelFit2 <div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-3">summary(modelFit2)</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-4"> </div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-5"># Call:</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-6"># lm(formula = Ozone_log10 ~ Temp + Wind, data = completedData)</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-7"># </div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-8"># Residuals:</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-9">#       Min        1Q    Median        3Q       Max </div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-10"># -0.108651 -0.030307 -0.004117  0.034658  0.142650 </div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-11"># </div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-12"># Coefficients:</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-13">#               Estimate Std. Error t value Pr(>|t|)    </div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-14">#   (Intercept)  0.06882    0.01713   4.017 9.29e-05 ***</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-15">#   Temp         0.18569    0.01784  10.409  <div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-16">#   Wind        -0.10191    0.01883  -5.412 2.42e-07 ***</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-17">#   ---</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-18">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-19"># </div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-20"># Residual standard error: 0.04581 on 150 degrees of freedom</div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-21"># Multiple R-squared:  0.6041,	Adjusted R-squared:  0.5988 </div><div class="crayon-line" id="crayon-60ed86b4d2e0a056146752-22"># F-statistic: 114.4 on 2 and 150 DF,  p-value: </div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><span style="text-decoration: underline;">評估<strong>係數(Coefficients)</strong>指標說明：</span></p>
<ol>
<li>Estimate: 表示各變數的估計係數。</li>
<li>Std. Error (SE) of Estimate: 估計標準誤，用來衡量估計回歸式的精準度。表示觀測值與回歸線間的分散或離散程度。<br>
\(\beta_{0}, \beta_{1}\)計算方式分別如下：<br>
$$SE(\beta_{0})^2 = \sigma^2[\frac{1}{n}+\frac{\bar{x}^2}{\sum_{i=1}^n (x_{i} – \bar{x})^2}],\space \space SE(\beta_{1})^2 = \frac{\sigma^2}{\sum_{i=1}^n (x_{i} – \bar{x})^2}$$<br>
其中，\(\sigma^2 = Var(\epsilon)\)表示隨機誤差的變異數。<br>
我們可以透過標準誤SE來計算95%信心水準係數區間如下：<br>


		<div id="crayon-60ed86b4d2e0b538340301" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
confint(object = modelFit2,level = 0.95)
#                   2.5 %      97.5 %
# (Intercept)  0.03497014  0.10267304
# Temp         0.15044504  0.22094442
# Wind        -0.13912079 -0.06470414</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e0b538340301-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0b538340301-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0b538340301-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0b538340301-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0b538340301-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e0b538340301-1">confint(object = modelFit2,level = 0.95)</div><div class="crayon-line" id="crayon-60ed86b4d2e0b538340301-2">#                   2.5 %      97.5 %</div><div class="crayon-line" id="crayon-60ed86b4d2e0b538340301-3"># (Intercept)  0.03497014  0.10267304</div><div class="crayon-line" id="crayon-60ed86b4d2e0b538340301-4"># Temp         0.15044504  0.22094442</div><div class="crayon-line" id="crayon-60ed86b4d2e0b538340301-5"># Wind        -0.13912079 -0.06470414</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<br>
從以上數據來說，在95%信心水準下\(\beta{1}(Temp)\)的係數區間[0.15,0.22]並沒有包括0，也因此我們可以推論說，當溫度升高100度時，log(臭氧濃度)會增加15-22個單位。</li>
<li>t-value: 衡量\(\beta{1}\)距離0有多少個標準差。t-value越大，p-value越小，表示該變數與目標變數關係顯著。t-value計算公式如下：<br>
$$t = \frac{\beta_{1}-0}{SE(\beta_{1})}$$</li>
<li>Pr(>|t|): 兩個預測變數p-value都小於0.05(95%信心水準)，表示與目標變數有顯著關係。</li>
</ol>
<p><span style="text-decoration: underline;">評估<strong>模型正確性(Model Accuracy)</strong>指標說明：</span></p>
<p>我們可以透過以下幾個數值指標來了解模型配適資料的適合度(goodness-of-fit)。</p>
<ol>
<li><strong>Residual standard error (RSE)</strong>：估計誤差標準差(estimate the standard deviation of error \(\epsilon\))。此模型誤差標準差為0.0458 (越小越好)，表示平均來說，實際觀測到的臭氧濃度會偏離回歸預測值約0.0458個單位(這是取log轉換後的數值）。<br>
誤差標準差衡量的是平均觀測值偏離回歸的程度。計算公式如下：<br>
$$RSE = \sqrt{\frac{1}{n-2} \sum_{i=1}^n (y_{i} – \hat{y}_{i})^2}$$<br>
RSE除了顯示在sumary(modelFit2)的底端，亦可透過以下sigma()函數取得。<br>


		<div id="crayon-60ed86b4d2e0c683574821" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
sigma(modelFit2)
# [1] 0.04580728</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e0c683574821-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0c683574821-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e0c683574821-1">sigma(modelFit2)</div><div class="crayon-line" id="crayon-60ed86b4d2e0c683574821-2"># [1] 0.04580728</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<br>
但畢竟RSE評估模型配適資料合適度是用<span style="text-decoration: underline;">實際觀測值偏離回歸預測值多少個Y單位</span>，無從得知構成模型配適</li>
<li><strong>R-squared (判定係數)</strong>: 衡量的是預測變數共解釋了多少變異。\(R^2\)是一個介於0到1的數值，越大越好，且數值不受Y單位所影響。\(R^2\)計算公式如下：<br>
$$R^2 = 1 – \frac{SSR}{SST} = 1 – \frac{\sum_{i=1}^n (y_{i} – \hat{y}_{i})^2}{\sum_{i=1}^n (y_{i} – \bar{y}_{i})^2}$$<br>
除了可以從sumary(modelFit2)最後幾行得知\(R^2\)的資訊，我們亦可透過以下<span style="text-decoration: underline;">modelr套件中的rsqaure()函數</span>取得。<br>


		<div id="crayon-60ed86b4d2e0e439199018" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
rsquare(modelFit2, data = completedData)
# [1] 0.604058</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e0e439199018-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e0e439199018-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e0e439199018-1">rsquare(modelFit2, data = completedData)</div><div class="crayon-line" id="crayon-60ed86b4d2e0e439199018-2"># [1] 0.604058</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<br>
此模型的預測變數(Temp & Wind)共解釋了60%目標變數(Ozone)的變異。</li>
<li><strong>Adjusted R-squared</strong>: 調整後的\(R^2\)有綜合考量變數總數(模型複雜度)的懲罰效果。此模型adj.\(R^2\)為 0.599(會比\(R^2\)來的小)，近似60%。</li>
<li><strong>F-statistic</strong>: <span style="text-decoration: underline;"><span style="color: #9f6ad4; text-decoration: underline;">F-statistic test是用來檢測是否模型中至少有一預測變數係數不為0(當模型為複回歸時，此檢測結果特別重要)</span></span>。F統計量的計算公式如下：<br>
$$F = \frac{TSS – RSS/p}{RSS/n-p-1}$$<br>
F統計量越大，p-value越顯著(p<0.05)。<br>
<span style="text-decoration: underline;">此模型的F統計量為114</span><span style="color: #9f6ad4;"><span style="text-decoration: underline;">(越大越好)，對應的p-value為 p < 2.2e-16</span>。</span></li>
</ol>
<h3>5. linear regression 線性回歸模型適合度診斷</h3>
<h4>5-1. 基本假設檢定</h4>
<p>檢視模型配適度一個重要的步驟，就是透過<span style="text-decoration: underline;">視覺化<span style="color: #9f6ad4; text-decoration: underline;">殘差分佈</span></span>，來檢視模型基本假設是否皆符合。</p>

		<div id="crayon-60ed86b4d2e10741699712" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# Reset par to the default values at startup
dev.off()
# 5.1 是否符合線性迴歸之基本假設：殘差變異數均一性
plot(modelFit2, which = 1) # 殘差變異分佈不在水平線上，且不接近零
# 5.2 殘差是否為常態分佈
plot(modelFit2, which = 2) # 殘差值分佈不在45度線上
# 5.3 標準化殘差分佈亦不成水平線分佈
plot(modelFit2, which = 3)
# 5.4 沒有對模型影響力過強的資料點（如果有的話，會出現在虛線cook's distance之外）
plot(modelFit2, which = 5)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2e10741699712-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-1"># Reset par to the default values at startup</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-2">dev.off()</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-3"># 5.1 是否符合線性迴歸之基本假設：殘差變異數均一性</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-4">plot(modelFit2, which = 1) # 殘差變異分佈不在水平線上，且不接近零</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-5"># 5.2 殘差是否為常態分佈</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-6">plot(modelFit2, which = 2) # 殘差值分佈不在45度線上</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-7"># 5.3 標準化殘差分佈亦不成水平線分佈</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-8">plot(modelFit2, which = 3)</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-9"># 5.4 沒有對模型影響力過強的資料點（如果有的話，會出現在虛線cook's distance之外）</div><div class="crayon-line" id="crayon-60ed86b4d2e10741699712-10">plot(modelFit2, which = 5)</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>由下圖可以發現：</p>
<ul>
<li>左上：殘差變異數不符合均一性。(理想上，希望紅色線條要接近水平線並接近0)</li>
<li>右上：殘差分佈不符合常態。（理想上，希望殘差值分佈不在45度線上）</li>
<li>左下：標準化殘差變異數不符合均一性。(理想上，希望紅色線條要接近水平線並接近0)</li>
<li>右下：檢視是否有對模型影響力過高的資料點。（若是有，資料點將會超過cook’s distance虛線外）</li>
</ul>
<p>綜合以上，會發現線性模型似乎不適合用來配適此組資料。</p>
<div id="gallery-10" class="gallery galleryid-518 gallery-columns-2 gallery-size-full"><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot16.jpeg"><img width="800" height="787" src="/wp-content/uploads/2018/08/Rplot16.jpeg" class="attachment-full size-full" alt="Rplot16" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot16.jpeg 800w,/wp-content/uploads/2018/08/Rplot16-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot16-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot16-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot17.jpeg"><img width="800" height="787" src="/wp-content/uploads/2018/08/Rplot17.jpeg" class="attachment-full size-full" alt="Rplot17" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot17.jpeg 800w,/wp-content/uploads/2018/08/Rplot17-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot17-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot17-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot18.jpeg"><img width="800" height="787" src="/wp-content/uploads/2018/08/Rplot18.jpeg" class="attachment-full size-full" alt="Rplot18" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot18.jpeg 800w,/wp-content/uploads/2018/08/Rplot18-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot18-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot18-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></a>
			</div></figure><figure class="gallery-item">
			<div class="gallery-icon landscape">
				<a href="/wp-content/uploads/2018/08/Rplot19.jpeg"><img width="800" height="787" src="/wp-content/uploads/2018/08/Rplot19.jpeg" class="attachment-full size-full" alt="Rplot19" loading="lazy" srcset="/wp-content/uploads/2018/08/Rplot19.jpeg 800w,/wp-content/uploads/2018/08/Rplot19-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot19-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot19-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></a>
			</div></figure>
		</div>

<h4>5-2. gvlma package</h4>
<p>另外，也可以使用gvlma套件來檢定模型是否符合假設。可以發現有部分線性迴歸模型的基礎假設是不成立的。(不過要注意的是，gvlma套件結果相關說明的資料不是很充足。)</p>

		<div id="crayon-60ed86b4d2e11788860210" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# Check Assumptions Automatically
library(gvlma)
# mod <- lm(Ozone ~ Solar.R, data=airquality)
gvlma(modelFit2)
summary(gvlma(modelFit2))
# 但網路上相關資源目前並沒有太多有關gvlma套件產生結果的說明

# Call:
# lm(formula = Ozone_log10 ~ Temp + Wind, data = completedData)
# 
# Residuals:
#       Min        1Q    Median        3Q       Max 
# -0.108651 -0.030307 -0.004117  0.034658  0.142650 
# 
# Coefficients:
#               Estimate Std. Error t value Pr(>|t|)    
#   (Intercept)  0.06882    0.01713   4.017 9.29e-05 ***
#   Temp         0.18569    0.01784  10.409  < 2e-16 ***
#   Wind        -0.10191    0.01883  -5.412 2.42e-07 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# Residual standard error: 0.04581 on 150 degrees of freedom
# Multiple R-squared:  0.6041,	Adjusted R-squared:  0.5988 
# F-statistic: 114.4 on 2 and 150 DF,  p-value: < 2.2e-16
# 
# 
# ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
# USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
#   Level of Significance =  0.05 
# 
# Call:
#   gvlma(x = modelFit2) 
# 
#                          Value   p-value                   Decision
#   Global Stat        31.296325 2.664e-06 Assumptions NOT satisfied!
#   Skewness            1.321357 2.503e-01    Assumptions acceptable.
#   Kurtosis            0.004069 9.491e-01    Assumptions acceptable.
#   Link Function      28.858171 7.788e-08 Assumptions NOT satisfied!
#   Heteroscedasticity  1.112728 2.915e-01    Assumptions acceptable.</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-11">11</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-12">12</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-13">13</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-14">14</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-15">15</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-16">16</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-17">17</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-18">18</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-19">19</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-20">20</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-21">21</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-22">22</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-23">23</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-24">24</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-25">25</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-26">26</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-27">27</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-28">28</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-29">29</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-30">30</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-31">31</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-32">32</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-33">33</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-34">34</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-35">35</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-36">36</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-37">37</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-38">38</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-39">39</div><div class="crayon-num" data-line="crayon-60ed86b4d2e11788860210-40">40</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-1"># Check Assumptions Automatically</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-2">library(gvlma)</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-3"># mod <div class="crayon-line" id="crayon-60ed86b4d2e11788860210-4">gvlma(modelFit2)</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-5">summary(gvlma(modelFit2))</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-6"># 但網路上相關資源目前並沒有太多有關gvlma套件產生結果的說明</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-7"> </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-8"># Call:</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-9"># lm(formula = Ozone_log10 ~ Temp + Wind, data = completedData)</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-10"># </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-11"># Residuals:</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-12">#       Min        1Q    Median        3Q       Max </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-13"># -0.108651 -0.030307 -0.004117  0.034658  0.142650 </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-14"># </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-15"># Coefficients:</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-16">#               Estimate Std. Error t value Pr(>|t|)    </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-17">#   (Intercept)  0.06882    0.01713   4.017 9.29e-05 ***</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-18">#   Temp         0.18569    0.01784  10.409  <div class="crayon-line" id="crayon-60ed86b4d2e11788860210-19">#   Wind        -0.10191    0.01883  -5.412 2.42e-07 ***</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-20">#   ---</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-21">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-22"># </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-23"># Residual standard error: 0.04581 on 150 degrees of freedom</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-24"># Multiple R-squared:  0.6041,	Adjusted R-squared:  0.5988 </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-25"># F-statistic: 114.4 on 2 and 150 DF,  p-value: <div class="crayon-line" id="crayon-60ed86b4d2e11788860210-26"># </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-27"># </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-28"># ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-29"># USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-30">#   Level of Significance =  0.05 </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-31"># </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-32"># Call:</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-33">#   gvlma(x = modelFit2) </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-34"># </div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-35">#                          Value   p-value                   Decision</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-36">#   Global Stat        31.296325 2.664e-06 Assumptions NOT satisfied!</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-37">#   Skewness            1.321357 2.503e-01    Assumptions acceptable.</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-38">#   Kurtosis            0.004069 9.491e-01    Assumptions acceptable.</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-39">#   Link Function      28.858171 7.788e-08 Assumptions NOT satisfied!</div><div class="crayon-line" id="crayon-60ed86b4d2e11788860210-40">#   Heteroscedasticity  1.112728 2.915e-01    Assumptions acceptable.</div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<h4>5-3. shapiro test常態分佈檢定</h4>
<p>另外，我們亦使用shapiro test 來看鎖定變數是否成常態分佈(H0: 分佈等於常態分佈)。可以發現除了Wind符合常態分配，另外兩個變數都離常態分佈有些距離。<span style="color: #9f6ad4;">因此除非進一步將變數有效轉換以符合常態，否則不適合用線性迴規模性來進行資料配適</span>。</p>

		<div id="crayon-60ed86b4d2e12559477873" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
options(scipen = 999)
normality_test <- apply(X = completedData,MARGIN = 2,FUN = function(x) round(shapiro.test(x)$p.value, digits = 4))
normality_test
#   Wind        Temp Ozone_log10 
# 0.0928      0.0093      0.0000</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e12559477873-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e12559477873-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e12559477873-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e12559477873-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e12559477873-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e12559477873-1">options(scipen = 999)</div><div class="crayon-line" id="crayon-60ed86b4d2e12559477873-2">normality_test <div class="crayon-line" id="crayon-60ed86b4d2e12559477873-3">normality_test</div><div class="crayon-line" id="crayon-60ed86b4d2e12559477873-4">#   Wind        Temp Ozone_log10 </div><div class="crayon-line" id="crayon-60ed86b4d2e12559477873-5"># 0.0928      0.0093      0.0000</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<h3>6. 模型驗證Validation</h3>
<h4>6-1. 常見模型效果評估指標</h4>
<table style="width: 100%; border-collapse: collapse; height: 323px;" border="1">
<tbody>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" bgcolor="#ecd5ed"><strong>STATISTIC</strong></td>
<td style="width: 52.232%; height: 23px;" bgcolor="#ecd5ed"><strong>CRITERION</strong></td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"R-Squared"}'>R-Squared</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"R-Squared"}'>Higher the better (> 0.70)。表示解釋變異量佔總變異量的百分比。</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"Adj R-Squared"}'>Adj R-Squared</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"Adj R-Squared"}'>Higher the better。表示調整後(對模型複雜度加入懲罰)解釋變異量佔總變異量的百分比。</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"F-Statistic"}'>F-Statistic</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"F-Statistic"}'>Higher the better。</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"Std. Error"}'>Std. Error (標準誤)</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"Std. Error"}'>Closer to zero the better。 (表抽樣結果與母體的偏差)</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"t-statistic"}'>t-statistic</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"t-statistic"}'>Should be greater 1.96 for p-value to be less than 0.05</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"AIC"}'>AIC</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"AIC"}'>Lower the better</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"BIC"}'>BIC</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"BIC"}'>Lower the better</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"Mallows cp"}'>Mallows cp</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"Mallows cp"}'>Should be close to the number of predictors in model</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"MAPE (Mean absolute percentage error)"}'>MAPE (Mean absolute percentage error)</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"MAPE (Mean absolute percentage error)"}'>Lower the better</td>
</tr>
<tr style="height: 23px;">
<td style="width: 46.903%; height: 23px;" data-sheets-value='{"1":2,"2":"MSE (Mean squared error)"}'>MSE (Mean squared error)</td>
<td style="width: 52.232%; height: 23px;" data-sheets-value='{"1":2,"2":"MSE (Mean squared error)"}'>Lower the better</td>
</tr>
<tr style="height: 70px;">
<td style="width: 46.903%; height: 70px;" data-sheets-value='{"1":2,"2":"Min_Max Accuracy => \nmean(min(actual, predicted)/\nmax(actual, predicted))"}'>Min_Max Accuracy =><br>
mean(min(actual, predicted)/<br>
max(actual, predicted))</td>
<td style="width: 52.232%; height: 70px;" data-sheets-value='{"1":2,"2":"Min_Max Accuracy => \nmean(min(actual, predicted)/\nmax(actual, predicted))"}'>Higher the better</td>
</tr>
</tbody>
</table>
<h4>6-2. 模型驗證(80%Training20%Testing)</h4>
<p>將資料隨機區分為訓練資料集(80%)與測試資料集(20%)</p>

		<div id="crayon-60ed86b4d2e14619765699" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 將資料切分為訓練集與測試集
set.seed(1234)
trainingRowIndex <- sample(1:nrow(completedData),0.7*nrow(completedData))
trainingData <- completedData[trainingRowIndex,]
testData <- completedData[-trainingRowIndex,]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e14619765699-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e14619765699-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e14619765699-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e14619765699-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e14619765699-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e14619765699-1"># 將資料切分為訓練集與測試集</div><div class="crayon-line" id="crayon-60ed86b4d2e14619765699-2">set.seed(1234)</div><div class="crayon-line" id="crayon-60ed86b4d2e14619765699-3">trainingRowIndex <div class="crayon-line" id="crayon-60ed86b4d2e14619765699-4">trainingData <div class="crayon-line" id="crayon-60ed86b4d2e14619765699-5">testData </div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>使用訓練及資料建置模型 & 使用測試集資料預測結果。並摘要訓練的模型效果summary(mod)。</p>

		<div id="crayon-60ed86b4d2e16940891793" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 使用訓練及資料建置模型 & 使用測試集資料預測結果
mod <- lm(Ozone_log10 ~ ., data=trainingData, na.action = na.omit)
predictY <- predict(object = mod, newdata = testData)

summary(mod)

# Call:
# lm(formula = Ozone_log10 ~ ., data = trainingData, na.action = na.omit)
# 
# Residuals:
#       Min        1Q    Median        3Q       Max 
# -0.099618 -0.031069 -0.003893  0.032104  0.138297 
# 
# Coefficients:
#               Estimate Std. Error t value        Pr(>|t|)    
#   (Intercept)  0.08839    0.02154   4.103 0.0000812697310 ***
#   Wind        -0.11489    0.02344  -4.901 0.0000035281189 ***
#   Temp         0.16479    0.02187   7.534 0.0000000000188 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# Residual standard error: 0.04639 on 104 degrees of freedom
# Multiple R-squared:  0.5734,	Adjusted R-squared:  0.5652 
# F-statistic: 69.89 on 2 and 104 DF,  p-value: < 0.00000000000000022</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-4">4</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-5">5</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-6">6</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-7">7</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-8">8</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-9">9</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-10">10</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-11">11</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-12">12</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-13">13</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-14">14</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-15">15</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-16">16</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-17">17</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-18">18</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-19">19</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-20">20</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-21">21</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-22">22</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-23">23</div><div class="crayon-num" data-line="crayon-60ed86b4d2e16940891793-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-1"># 使用訓練及資料建置模型 & 使用測試集資料預測結果</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-2">mod <div class="crayon-line" id="crayon-60ed86b4d2e16940891793-3">predictY <div class="crayon-line" id="crayon-60ed86b4d2e16940891793-4"> </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-5">summary(mod)</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-6"> </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-7"># Call:</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-8"># lm(formula = Ozone_log10 ~ ., data = trainingData, na.action = na.omit)</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-9"># </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-10"># Residuals:</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-11">#       Min        1Q    Median        3Q       Max </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-12"># -0.099618 -0.031069 -0.003893  0.032104  0.138297 </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-13"># </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-14"># Coefficients:</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-15">#               Estimate Std. Error t value        Pr(>|t|)    </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-16">#   (Intercept)  0.08839    0.02154   4.103 0.0000812697310 ***</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-17">#   Wind        -0.11489    0.02344  -4.901 0.0000035281189 ***</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-18">#   Temp         0.16479    0.02187   7.534 0.0000000000188 ***</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-19">#   ---</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-20">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-21"># </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-22"># Residual standard error: 0.04639 on 104 degrees of freedom</div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-23"># Multiple R-squared:  0.5734,	Adjusted R-squared:  0.5652 </div><div class="crayon-line" id="crayon-60ed86b4d2e16940891793-24"># F-statistic: 69.89 on 2 and 104 DF,  p-value: </div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>檢視模型預測的效果。</p>

		<div id="crayon-60ed86b4d2e17182092310" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
actuals_predicts <- data.frame(cbind(actuals = testData$Ozone_log10, predicteds = predictY)])</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e17182092310-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e17182092310-1">actuals_predicts </div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>計算真實數據與預測數據的相關係數：越高越好。</p>

		<div id="crayon-60ed86b4d2e18051238062" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
cor(actuals_predicts,use="complete.obs") # 0.8136252
cor(actuals_predicts,use="pairwise.complete.obs") # 0.8136252</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e18051238062-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e18051238062-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e18051238062-1">cor(actuals_predicts,use="complete.obs") # 0.8136252</div><div class="crayon-line" id="crayon-60ed86b4d2e18051238062-2">cor(actuals_predicts,use="pairwise.complete.obs") # 0.8136252</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>計算AIC, BIC => 越低越好。</p>

		<div id="crayon-60ed86b4d2e1a686566770" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
AIC(mod)
# [1] -348.5126
BIC(mod)
# [1] -337.8213</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e1a686566770-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1a686566770-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1a686566770-3">3</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1a686566770-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e1a686566770-1">AIC(mod)</div><div class="crayon-line" id="crayon-60ed86b4d2e1a686566770-2"># [1] -348.5126</div><div class="crayon-line" id="crayon-60ed86b4d2e1a686566770-3">BIC(mod)</div><div class="crayon-line" id="crayon-60ed86b4d2e1a686566770-4"># [1] -337.8213</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>計算模型預測正確率min_max_accuracy： 70.4% = > 越高越好。</p>

		<div id="crayon-60ed86b4d2e1b632216558" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
min_max_accuracy <- mean(apply(actuals_predicts, 1, min) / apply(actuals_predicts, 1, max))
min_max_accuracy
# [1] 0.7036471</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e1b632216558-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1b632216558-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1b632216558-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e1b632216558-1">min_max_accuracy <div class="crayon-line" id="crayon-60ed86b4d2e1b632216558-2">min_max_accuracy</div><div class="crayon-line" id="crayon-60ed86b4d2e1b632216558-3"># [1] 0.7036471</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>計算模型預測錯誤率 MAPE (Mean absolute percentage error)： 56% => 越低越好。</p>

		<div id="crayon-60ed86b4d2e1c340092551" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
mape <- mean(abs((actuals_predicts$predicteds - actuals_predicts$actuals))/actuals_predicts$actuals)
mape
# [1] 0.5598302</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e1c340092551-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1c340092551-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1c340092551-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e1c340092551-1">mape <div class="crayon-line" id="crayon-60ed86b4d2e1c340092551-2">mape</div><div class="crayon-line" id="crayon-60ed86b4d2e1c340092551-3"># [1] 0.5598302</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<h4>6-3. 加強版模型驗證: K-fold Cross Validation</h4>
<p>使用k-fold交叉驗證。</p>

		<div id="crayon-60ed86b4d2e1d015307676" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(DAAG)
cvResults <- suppressWarnings(CVlm(data=completedData, form.lm=Ozone_log10 ~ ., m=5, dots=FALSE, seed=29, legend.pos="topleft", main="Small symbols are predicted values while bigger ones are actuals.")) # performs the CV</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e1d015307676-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1d015307676-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e1d015307676-1">library(DAAG)</div><div class="crayon-line" id="crayon-60ed86b4d2e1d015307676-2">cvResults </div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>查看交叉驗證的平均平方誤差(MSE):越低越好。</p>

		<div id="crayon-60ed86b4d2e1f207618955" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# MSE (Mean squared error): Lower the better
attr(cvResults, 'ms')  
# [1] 0.0105</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed86b4d2e1f207618955-1">1</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1f207618955-2">2</div><div class="crayon-num" data-line="crayon-60ed86b4d2e1f207618955-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed86b4d2e1f207618955-1"># MSE (Mean squared error): Lower the better</div><div class="crayon-line" id="crayon-60ed86b4d2e1f207618955-2">attr(cvResults, 'ms')  </div><div class="crayon-line" id="crayon-60ed86b4d2e1f207618955-3"># [1] 0.0105</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>交叉5次模型配適結果圖如下。小圖示為模型預測值，大圖示則為真實資料值。<span style="color: #9f6ad4;">可以發現第五次模型擬和的結果與其他四次有較大差異</span>。</p>
<p><img loading="lazy" class="alignnone size-full wp-image-738" src="/wp-content/uploads/2018/08/Rplot20.jpeg" alt="linear regression" width="800" height="787" srcset="/wp-content/uploads/2018/08/Rplot20.jpeg 800w,/wp-content/uploads/2018/08/Rplot20-300x295.jpeg 300w,/wp-content/uploads/2018/08/Rplot20-768x756.jpeg 768w,/wp-content/uploads/2018/08/Rplot20-75x75.jpeg 75w" sizes="(max-width: 800px) 100vw, 800px"></p>
<h3>7. 結論</h3>
<p>我們可以發現，由於airquality<span style="color: #9f6ad4;">資料型態不接近理想的常態分佈，故使用Linear Regression 線性迴歸模型做資料配適不是很合適<span style="color: #333333;">(根據「回歸模型適合度診斷」)</span></span>。如果遇到資料分配非常態時，建議可以考慮其他模型如<a href="/%e3%80%8c%e7%b5%b1%e8%a8%88%e2%80%a2r%e8%aa%9e%e8%a8%80%e2%80%a2%e6%b1%ba%e7%ad%96%e6%a8%b9%e3%80%8ddecision-tree-classification-and-regression-tree-cart/" target="_blank" rel="noopener noreferrer">決策樹</a>（不受限母體分配）。</p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<hr>
<p>更多線性回歸模型應用：</p>
<ol>
<li><a href="/app-mobile-ad-revenue-admob-%e8%a1%8c%e5%8b%95%e5%bb%a3%e5%91%8a%e6%94%b6%e5%85%a5/" target="_blank" rel="noopener noreferrer">開發一個免費App能賺多少錢? 靠 AdMod 廣告月收3萬實例分享</a></li>
</ol>
<p><strong>更多統計模型學習筆記連結：</strong></p>
<ol>
<li><a href="/regularized-regression-ridge-lasso-elastic/" target="_blank" rel="noopener noreferrer">Regularized Regression | 正規化迴歸 – Ridge, Lasso, Elastic Net | R語言</a></li>
<li><a href="/logistic-regression-part1-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" target="_blank" rel="noopener noreferrer">Logistic Regression 羅吉斯迴歸 | part1 – 資料探勘與處理 | 統計 R語言</a></li>
<li><a href="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" target="_blank" rel="noopener noreferrer">Logistic Regression 羅吉斯迴歸 | part2 – 模型建置、診斷與比較 | R語言</a></li>
<li><a href="/decision-tree-cart-%e6%b1%ba%e7%ad%96%e6%a8%b9/" target="_blank" rel="noopener noreferrer">Decision Tree 決策樹 | CART, Conditional Inference Tree, Random Forest</a></li>
<li><a href="/regression-tree-%e8%bf%b4%e6%ad%b8%e6%a8%b9-bagging-bootstrap-aggrgation-r%e8%aa%9e%e8%a8%80/" target="_blank" rel="noopener noreferrer">Regression Tree | 迴歸樹, Bagging, Bootstrap Aggregation | R語言</a></li>
<li><a href="/random-forests-%e9%9a%a8%e6%a9%9f%e6%a3%ae%e6%9e%97/" target="_blank" rel="noopener noreferrer">Random Forests 隨機森林 | randomForest, ranger, h2o | R語言</a></li>
<li><a href="/gradient-boosting-machines-gbm/" target="_blank" rel="noopener noreferrer">Gradient Boosting Machines GBM | gbm, xgboost, h2o | R語言</a></li>
<li><a href="/hierarchical-clustering-%e9%9a%8e%e5%b1%a4%e5%bc%8f%e5%88%86%e7%be%a4/" target="_blank" rel="noopener noreferrer">Hierarchical Clustering 階層式分群 | Clustering 資料分群 | R統計</a></li>
<li><a href="/partitional-clustering-kmeans-kmedoid/" target="_blank" rel="noopener noreferrer">Partitional Clustering | 切割式分群 | Kmeans, Kmedoid | Clustering 資料分群</a></li>
<li><a href="/principal-components-analysis-pca-%e4%b8%bb%e6%88%90%e4%bb%bd%e5%88%86%e6%9e%90/" target="_blank" rel="noopener noreferrer">Principal Components Analysis (PCA) | 主成份分析 | R 統計</a></li>
</ol>
<hr>
<p>參考文章連結：</p>
<ol>
<li><a href="http://r-statistics.co/Linear-Regression.html">Linear Regression</a></li>
<li><a href="http://rpubs.com/Nitika/linearRegression_Airquality">Linear Regression using AirQuality Dataset</a></li>
<li><a href="https://www.r-bloggers.com/imputing-missing-data-with-r-mice-package/">Imputing missing data with R; MICE package</a></li>
<li><a href="http://r-statistics.co/Assumptions-of-Linear-Regression.html">Assumptions of Linear Regression</a></li>
<li><a href="https://ademos.people.uic.edu/Chapter12.html">Chapter 12: Regression: Basics, Assumptions, & Diagnostics</a></li>
<li><a href="https://view.officeapps.live.com/op/view.aspx?src=http://cyber.mcu.edu.tw/%E7%AE%A1%E7%90%86%E5%AD%B8%E9%99%A2/%E7%B5%B1%E8%A8%88%E5%AD%B8%E9%A1%9E/%E8%A4%87%E8%BF%B4%E6%AD%B8%E5%88%86%E6%9E%90%E4%B8%80/%E8%A4%87%E8%BF%B4%E6%AD%B8%E5%88%86%E6%9E%90%E4%B8%80.ppt">複回歸分析</a></li>
<li><a href="http://uc-r.github.io/linear_regression">Linear Regression (2)</a></li>
</ol>
			</div>

	<footer class="entry-footer">
		<span class="tags-links"> <a href="/tag/aic/" rel="tag">AIC</a>0<a href="/tag/airquality/" rel="tag">airquality</a>0<a href="/tag/assumption-of-linear-regression/" rel="tag">assumption of linear regression</a>0<a href="/tag/bic/" rel="tag">BIC</a>0<a href="/tag/eda/" rel="tag">eda</a>0<a href="/tag/exploratory-data-analysis/" rel="tag">exploratory data analysis</a>0<a href="/tag/ggplot2/" rel="tag">ggplot2</a>0<a href="/tag/kfold-cross-validation/" rel="tag">kfold cross validation</a>0<a href="/tag/linear-regression/" rel="tag">Linear Regression</a>0<a href="/tag/linearregression/" rel="tag">linearregression</a>0<a href="/tag/lm/" rel="tag">lm</a>0<a href="/tag/missing-values-treatment/" rel="tag">Missing Values Treatment</a>0<a href="/tag/modeling/" rel="tag">modeling</a>0<a href="/tag/predict/" rel="tag">predict</a>0<a href="/tag/regression/" rel="tag">regression</a>0<a href="/tag/r%e8%aa%9e%e8%a8%80/" rel="tag">R語言</a>0<a href="/tag/test/" rel="tag">test</a>0<a href="/tag/train/" rel="tag">train</a>0<a href="/tag/%e7%b5%b1%e8%a8%88/" rel="tag">統計</a>0<a href="/tag/%e7%b7%9a%e6%80%a7%e5%9b%9e%e6%ad%b8/" rel="tag">線性回歸</a>0<a href="/tag/%e7%b7%9a%e6%80%a7%e5%9b%9e%e6%ad%b8%e5%81%87%e8%a8%ad/" rel="tag">線性回歸假設</a>0<a href="/tag/%e8%b3%87%e6%96%99%e8%a6%96%e8%a6%ba%e5%8c%96/" rel="tag">資料視覺化</a>0<a href="/tag/%e9%81%ba%e5%a4%b1%e5%80%bc%e5%a1%ab%e8%a3%9c/" rel="tag">遺失值填補</a></span>	</footer>

	
</article>

				<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">文章導覽列</h2>
		<div class="nav-links clearfix">
			<div class="nav-previous"><span>⟵</span><a href="/september-cafe-%e4%b9%9d%e6%9c%88%e5%92%96%e5%95%a1/" rel="prev">September Cafe 九月咖啡 | 忍不住拍個不停的網美餐廳 | 台北大安</a></div><div class="nav-next"><a href="/logistic-regression-part1-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" rel="next">Logistic Regression 羅吉斯迴歸 | part1 – 資料探勘與處理 | 統計 R語言</a><span>⟶</span></div>		</div>
	</nav>
	
			
<div id="comments" class="comments-area">

	
			<h4 class="comment-title">
			在《<span>Linear Regression | 線性迴歸模型 | using AirQuality Dataset</span>》中有 3 則留言		</h4>

		
		<ol class="comments-list">
					<li id="comment-3321" class="comment even thread-even depth-1">
			<article id="div-comment-3321" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="http://0.gravatar.com/avatar/0da9684f5ff17ce66f55d6d71b4274af?s=60&d=mm&r=g" srcset="http://0.gravatar.com/avatar/0da9684f5ff17ce66f55d6d71b4274af?s=120&d=mm&r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy">						<b class="fn">max</b><span class="says">表示:</span>					</div>

					<div class="comment-metadata">
						<a href="/linear-regression-%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%e6%a8%a1%e5%9e%8b/#comment-3321"><time datetime="2020-09-08T17:21:56+08:00">2020-09-0817:21:56</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>統計理論邏輯清晰、程式能力上乘 推</p>
				</div>

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="#comment-3321" data-commentid="3321" data-postid="518" data-belowelement="div-comment-3321" data-respondelement="respond" data-replyto="回覆給「max」" aria-label="回覆給「max」">回覆</a></div>			</article>
		</li>
		<li id="comment-3322" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-3322" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="http://0.gravatar.com/avatar/0da9684f5ff17ce66f55d6d71b4274af?s=60&d=mm&r=g" srcset="http://0.gravatar.com/avatar/0da9684f5ff17ce66f55d6d71b4274af?s=120&d=mm&r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy">						<b class="fn">max</b><span class="says">表示:</span>					</div>

					<div class="comment-metadata">
						<a href="/linear-regression-%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%e6%a8%a1%e5%9e%8b/#comment-3322"><time datetime="2020-09-09T11:20:51+08:00">2020-09-0911:20:51</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>想請問一下喔! 為什麼這邊的標準化作業，不直接下scale()函數，而要自行寫個函式去轉換呢?差別是在<br>
function(x){(x-min(x, na.rm = T))/(max(x, na.rm = T)-min(x, na.rm = T))})</p>
				</div>

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="#comment-3322" data-commentid="3322" data-postid="518" data-belowelement="div-comment-3322" data-respondelement="respond" data-replyto="回覆給「max」" aria-label="回覆給「max」">回覆</a></div>			</article>
		</li>
		<li id="comment-3434" class="pingback even thread-even depth-1">
			<div class="comment-body">
				自動引用通知: <a href="https://benhuangtw.wordpress.com/2020/11/08/%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8linear-regression/" rel="external nofollow ugc" class="url">線性迴歸(Linear Regression) – Ben Huang’s Notes</a> 			</div>
		</li>
		</ol>

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">發佈留言 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/linear-regression-%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%e6%a8%a1%e5%9e%8b/#respond" style="display:none;">取消回覆</a></small></h3><form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">發佈留言必須填寫的電子郵件地址不會公開。</span> 必填欄位標示為 <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">留言</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">顯示名稱 <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">電子郵件地址 <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">個人網站網址</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200"></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="發佈留言"> <input type="hidden" name="comment_post_ID" value="518" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><div class="wantispam-required-fields"><input type="hidden" name="wantispam_t" class="wantispam-control wantispam-control-t" value="1626179253"><div class="wantispam-group wantispam-group-q" style="clear: both;">
					<label>Current ye@r <span class="required">*</span></label>
					<input type="hidden" name="wantispam_a" class="wantispam-control wantispam-control-a" value="2021">
					<input type="text" name="wantispam_q" class="wantispam-control wantispam-control-q" value="7.2.0" autocomplete="off">
				  </div>
<div class="wantispam-group wantispam-group-e" style="display: none;">
					<label>Leave this field empty</label>
					<input type="text" name="wantispam_e_email_url_website" class="wantispam-control wantispam-control-e" value="" autocomplete="off">
				  </div>
</div></form>	</div>
	
</div>

		
		</main>
	</div>

	

<div id="secondary" class="widget-area col-md-3" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">搜尋關鍵字:</span>
					<input type="search" class="search-field" placeholder="搜尋..." value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="搜尋">
			</form></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h3 class="widget-title">近期文章</h3>
		<ul>
											<li>
					<a href="/jbs-diner/">JB’s Diner | 陽光、綠意、自然度假風美式早午餐 | 台北 天母</a>
									</li>
											<li>
					<a href="/%e9%82%80%e6%9c%88%e5%85%92/">邀月兒 | 適合放鬆小酌的迷人高級餐酒館 | 台北 民生社區 富錦街</a>
									</li>
											<li>
					<a href="/eslite-cafe-%e4%bf%a1%e7%be%a9%e8%aa%a0%e5%93%81%e5%92%96%e5%95%a1/">信義誠品咖啡 Eslite Café | 美美的 優雅的 文青咖啡廳 | 台北 信義區</a>
									</li>
											<li>
					<a href="/%e5%b0%8f%e9%bc%8e%e8%86%be/">小鼎膾 | 新鮮美味的高品質日式丼飯、海鮮料理 | 台北信義 Bellavita B2</a>
									</li>
											<li>
					<a href="/gradient-boosting-machines-gbm/">Gradient Boosting Machines GBM | gbm, xgboost, h2o | R語言</a>
									</li>
					</ul>

		</aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">彙整</h3>
			<ul>
					<li><a href="/2019/08/">2019 年 8 月</a></li>
	<li><a href="/2019/04/">2019 年 4 月</a></li>
	<li><a href="/2019/03/">2019 年 3 月</a></li>
	<li><a href="/2019/02/">2019 年 2 月</a></li>
	<li><a href="/2019/01/">2019 年 1 月</a></li>
	<li><a href="/2018/12/">2018 年 12 月</a></li>
	<li><a href="/2018/10/">2018 年 10 月</a></li>
	<li><a href="/2018/09/">2018 年 9 月</a></li>
	<li><a href="/2018/08/">2018 年 8 月</a></li>
	<li><a href="/2018/07/">2018 年 7 月</a></li>
	<li><a href="/2018/05/">2018 年 5 月</a></li>
			</ul>

			</aside></div>
			</div>
		</div>
	</div>

	
	
    <a class="go-top"><i class="fa fa-angle-up"></i></a>
		
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info container">
			<a href="https://tw.wordpress.org/">本站採用 WordPress 建置</a>
			<span class="sep"> | </span>
			佈景主題採用由 aThemes 所設計的 <a href="https://athemes.com/theme/sydney" rel="designer">Sydney</a>。		</div>
	</footer>

	
</div>


<script type="text/javascript">
var sbiajaxurl = "/wp-admin/admin-ajax.php";
</script>
<script type="text/javascript" src="/wp-content/plugins/anti-spam/assets/js/anti-spam.js" id="anti-spam-script-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/scripts.js" id="sydney-scripts-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/main.min.js" id="sydney-main-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/skip-link-focus-fix.js" id="sydney-skip-link-focus-fix-js"></script>


</body></html>
