<!DOCTYPE html>
<html lang="zh-TW" prefix="og: http://ogp.me/ns#">
<head>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


	
<title>Logistic Regression 羅吉斯迴歸 | part1 - 資料探勘與處理 | 統計 R語言</title>
<meta name="robots" content="max-image-preview:large">


<meta name="description" content="Logistic Regression, 羅吉斯迴歸模型，適用於預測二元類別目標變數的發生機率(p)，和線性迴歸模型類似，與線性回歸主要不同之處在於：(1) 目標變數是目標事件發生機率P經過log函數轉換成log odds值才進行線性預測，且(2)羅吉斯迴歸的各項參數是透過最大概似法(MLE)進行估計的。">

<meta property="og:locale" content="zh_TW">
<meta property="og:type" content="article">
<meta property="og:title" content="Logistic Regression 羅吉斯回歸 | part1 - 資料探勘與處理 | 統計 R語言">
<meta property="og:description" content="Logistic Regression, 羅吉斯回歸模型，適用於預測二元類別目標變數的發生機率(p)，和線性回歸模型類似，與線性回歸主要不同之處在於：(1) 目標變數是目標事件發生機率P經過log函數轉換成log odds值才進行線性預測，且(2)羅吉斯回歸的各項參數是透過最大概似法(MLE)進行估計的。">
<meta property="og:url" content="/logistic-regression-part1-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/">
<meta property="og:site_name" content="果醬珍珍•JamJam">
<meta property="article:tag" content="data pre processing">
<meta property="article:tag" content="eda">
<meta property="article:tag" content="exploratory data analysis">
<meta property="article:tag" content="glm">
<meta property="article:tag" content="information value">
<meta property="article:tag" content="IV">
<meta property="article:tag" content="logistic regression">
<meta property="article:tag" content="羅吉斯回歸">
<meta property="article:tag" content="資料探索">
<meta property="article:tag" content="資料預處理">
<meta property="article:section" content=" 程式與統計">
<meta property="article:published_time" content="2018-08-28T06:24:19+08:00">
<meta property="article:modified_time" content="2020-07-03T02:33:23+08:00">
<meta property="og:updated_time" content="2020-07-03T02:33:23+08:00">
<meta property="og:image" content="/wp-content/uploads/2018/08/domenico-loia-364221-unsplash-1024x683.jpg">
<meta property="og:image:width" content="1024">
<meta property="og:image:height" content="683">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="Logistic Regression, 羅吉斯迴歸模型，適用於預測二元類別目標變數的發生機率(p)，和線性迴歸模型類似，與線性回歸主要不同之處在於：(1) 目標變數是目標事件發生機率P經過log函數轉換成log odds值才進行線性預測，且(2)羅吉斯迴歸的各項參數是透過最大概似法(MLE)進行估計的。">
<meta name="twitter:title" content="Logistic Regression 羅吉斯迴歸 | part1 - 資料探勘與處理 | 統計 R語言">
<meta name="twitter:image" content="/wp-content/uploads/2018/08/domenico-loia-364221-unsplash.jpg">


<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">



<link rel="stylesheet" id="crayon-css" href="/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-hwj-based-on-monokai-css" href="/wp-content/uploads/crayon-syntax-highlighter/themes/hwj-based-on-monokai/hwj-based-on-monokai.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monospace-css" href="/wp-content/plugins/crayon-syntax-highlighter/fonts/monospace.css" type="text/css" media="all">
<link rel="stylesheet" id="sb_instagram_styles-css" href="/wp-content/plugins/instagram-feed/css/sb-instagram-2-2.min.css" type="text/css" media="all">
<link rel="stylesheet" id="sydney-bootstrap-css" href="/wp-content/themes/hwj-based-on-sydney/css/bootstrap/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="titan-adminbar-styles-css" href="/wp-content/plugins/anti-spam/assets/css/admin-bar.css" type="text/css" media="all">
<link rel="stylesheet" id="sydney-fonts-css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C600%7CRaleway%3A400%2C500%2C600" type="text/css" media="all">
<link rel="stylesheet" id="sydney-style-css" href="/wp-content/themes/hwj-based-on-sydney/style.css" type="text/css" media="all">
<style id="sydney-style-inline-css" type="text/css">
.site-title { font-size:32px; }
.site-description { font-size:16px; }
#mainnav ul li a { font-size:14px; }
h1 { font-size:52px; }
h2 { font-size:42px; }
h3 { font-size:32px; }
h4 { font-size:25px; }
h5 { font-size:20px; }
h6 { font-size:18px; }
body { font-size:16px; }
.single .hentry .title-post { font-size:24px; }
.header-image { background-size:cover;}
.header-image { height:500px; }
.widget-area .widget_fp_social a,#mainnav ul li a:hover, .sydney_contact_info_widget span, .roll-team .team-content .name,.roll-team .team-item .team-pop .team-social li:hover a,.roll-infomation li.address:before,.roll-infomation li.phone:before,.roll-infomation li.email:before,.roll-testimonials .name,.roll-button.border,.roll-button:hover,.roll-icon-list .icon i,.roll-icon-list .content h3 a:hover,.roll-icon-box.white .content h3 a,.roll-icon-box .icon i,.roll-icon-box .content h3 a:hover,.switcher-container .switcher-icon a:focus,.go-top:hover,.hentry .meta-post a:hover,#mainnav > ul > li > a.active, #mainnav > ul > li > a:hover, button:hover, input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover, .text-color, .social-menu-widget a, .social-menu-widget a:hover, .archive .team-social li a, a, h1 a, h2 a, h3 a, h4 a, h5 a, h6 a,.classic-alt .meta-post a,.single .hentry .meta-post a { color:#3d3d3d}
.reply,.woocommerce div.product .woocommerce-tabs ul.tabs li.active,.woocommerce #respond input#submit,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.project-filter li a.active, .project-filter li a:hover,.preloader .pre-bounce1, .preloader .pre-bounce2,.roll-team .team-item .team-pop,.roll-progress .progress-animate,.roll-socials li a:hover,.roll-project .project-item .project-pop,.roll-project .project-filter li.active,.roll-project .project-filter li:hover,.roll-button.light:hover,.roll-button.border:hover,.roll-button,.roll-icon-box.white .icon,.owl-theme .owl-controls .owl-page.active span,.owl-theme .owl-controls.clickable .owl-page:hover span,.go-top,.bottom .socials li:hover a,.sidebar .widget:before,.blog-pagination ul li.active,.blog-pagination ul li:hover a,.content-area .hentry:after,.text-slider .maintitle:after,.error-wrap #search-submit:hover,#mainnav .sub-menu li:hover > a,#mainnav ul li ul:after, button, input[type="button"], input[type="reset"], input[type="submit"], .panel-grid-cell .widget-title:after { background-color:#3d3d3d}
.roll-socials li a:hover,.roll-socials li a,.roll-button.light:hover,.roll-button.border,.roll-button,.roll-icon-list .icon,.roll-icon-box .icon,.owl-theme .owl-controls .owl-page span,.comment .comment-detail,.widget-tags .tag-list a:hover,.blog-pagination ul li,.hentry blockquote,.error-wrap #search-submit:hover,textarea:focus,input[type="text"]:focus,input[type="password"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="time"]:focus,input[type="week"]:focus,input[type="number"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="color"]:focus, button, input[type="button"], input[type="reset"], input[type="submit"], .archive .team-social li a { border-color:#3d3d3d}
.site-header.float-header { background-color:rgba(0,0,0,0.9);}
@media only screen and (max-width: 1024px) { .site-header { background-color:#000000;}}
.site-title a, .site-title a:hover { color:#ffffff}
.site-description { color:#ffffff}
#mainnav ul li a, #mainnav ul li::before { color:#ffffff}
#mainnav .sub-menu li a { color:#ffffff}
#mainnav .sub-menu li a { background:#1c1c1c}
.text-slider .maintitle, .text-slider .subtitle { color:#ffffff}
body { color:#5e5e5e}
#secondary { background-color:#ffffff}
#secondary, #secondary a, #secondary .widget-title { color:#767676}
.footer-widgets { background-color:#252525}
.btn-menu { color:#ffffff}
#mainnav ul li a:hover { color:#d65050}
.site-footer { background-color:#1c1c1c}
.site-footer,.site-footer a { color:#666666}
.overlay { background-color:#000000}
.page-wrap { padding-top:10px;}
.page-wrap { padding-bottom:100px;}
@media only screen and (max-width: 1025px) {		
			.mobile-slide {
				display: block;
			}
			.slide-item {
				background-image: none !important;
			}
			.header-slider {
			}
			.slide-item {
				height: auto !important;
			}
			.slide-inner {
				min-height: initial;
			} 
		}
@media only screen and (max-width: 780px) { 
    	h1 { font-size: 32px;}
		h2 { font-size: 28px;}
		h3 { font-size: 22px;}
		h4 { font-size: 18px;}
		h5 { font-size: 16px;}
		h6 { font-size: 14px;}
    }

</style>
<link rel="stylesheet" id="sydney-font-awesome-css" href="/wp-content/themes/hwj-based-on-sydney/fonts/font-awesome.min.css" type="text/css" media="all">

<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="text/javascript" id="crayon_js-js-extra">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/localhost\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js" id="crayon_js-js"></script>





</head><body><div id="fb-root"></div><script>(function(d, s, id) {

	var js, fjs = d.getElementsByTagName(s)[0];

	if (d.getElementById(id)) return;

	js = d.createElement(s); js.id = id;

	js.src = '//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.3';

	fjs.parentNode.insertBefore(js, fjs);

	}(document, 'script', 'facebook-jssdk'));</script>	<style type="text/css">
		.header-image {
			background-image: url(/wp-content/uploads/2018/09/果醬珍珍_首圖_10.jpg);
			display: block;
		}
		@media only screen and (max-width: 1024px) {
			.header-inner {
				display: block;
			}
			.header-image {
				background-image: none;
				height: auto !important;
			}		
		}
	</style>
			<style type="text/css" id="wp-custom-css">
			.entry-content a {
	text-decoration: underline;
	color: #9f6ad4;
}		</style>
			<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
	

	




	<div class="preloader">
	    <div class="spinner">
	        <div class="pre-bounce1"></div>
	        <div class="pre-bounce2"></div>
	    </div>
	</div>
	
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">跳至主內容區</a>

	
	
	
	<div id="masthead" class="site-header" role="banner" style="display:none;"> 
		<div class="header-wrap">
            <div class="container">
                <div class="row">
				<div class="col-md-4 col-sm-8 col-xs-12">
		        					<a href="/" title="果醬珍珍•JamJam"><img class="site-logo" src="/wp-content/uploads/2018/09/grape_320.png" alt="果醬珍珍•JamJam"></a>
		        				</div>
				<div class="col-md-8 col-sm-4 col-xs-12">
					<div class="btn-menu"></div>
					<nav id="mainnav" class="mainnav" role="navigation">
						<div class="menu-jamleecute-container"><ul id="menu-jamleecute" class="menu"><li id="menu-item-1691" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1691"><a href="/category/programming-statistics/"> 程式與統計</a></li>
<li id="menu-item-626" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-626"><a href="/category/travel/">旅遊</a></li>
<li id="menu-item-627" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-627"><a href="/category/foodie/">美食</a></li>
<li id="menu-item-2415" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2415"><a href="/%e7%b0%a1%e4%bb%8b/">關於我</a></li>
</ul></div>					</nav>
				</div>
				</div>
			</div>
		</div>
	</div>
	
	
	

	
	<style>
	.header-img-bounding-box {
	  background-image: url("/wp-content/uploads/2018/09/%E8%83%8C%E6%99%AF%E5%8E%9F%E5%9C%96_v2.jpg");
    background-size:     cover;                      /* <------ */
    background-repeat:   no-repeat;
    background-position: center center;              /* optional, center the image */
/* 	height: 300px; */
	padding-top:55px;
	padding-bottom:55px;
		}
		.title_img {
		    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
		min-width: 340px;
			max-width: 800px;

		}
		
		
		.subtitle_img {
			display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
		min-width: 340px;
			max-width: 800px;
		}
		
		
		.subtitle_overlay {
			margin-top:20px;
			background-color: rgba(255, 255, 255, 0.7);
			padding-bottom:8px;
		}
	</style>
	
	<div>
		<a href="/">
		<div class="header-img-bounding-box">

			<img src="/wp-content/uploads/2018/09/title.png" class="title_img">
			<div class="subtitle_overlay">
			<img src="/wp-content/uploads/2018/09/subtitle.png" class="subtitle_img">
			</div>			
		</div>	
		</a>
	</div>
	
	
	
	<header>
		<nav id="my_mainnav" class="my_mainnav" role="navigation">
				<div class="menu-jamleecute-container"><ul id="menu-jamleecute-1" class="menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1691"><a href="/category/programming-statistics/"> 程式與統計</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-626"><a href="/category/travel/">旅遊</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-627"><a href="/category/foodie/">美食</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2415"><a href="/%e7%b0%a1%e4%bb%8b/">關於我</a></li>
</ul></div>		</nav>
	</header>

	
	
	
	<div id="content" class="page-wrap">
		
		
		
		<style>
			.home_intro {
				    margin: 0 12%;
					/*height: 400px;*/
    				/*background: yellow;*/
				
			}
			
			.home_intro .content{
				display: flex; 
    display: -webkit-flex;
    justify-content: center;
    -webkit-justify-content: center;
    flex-wrap: wrap;
			}
			.home_intro .content .intro {
				width: 240px;
    			
				margin: 0 auto;
				
			}
			.home_intro .content .intro .image {
				/*width: 240px;
    			padding: 0px;
				margin: 0 auto;
				display: inline-block;*/
			  position: relative;
			  width: 240px;
			  height: 240px;
			  overflow: hidden;
			  border-radius: 50%;
			}
			.home_intro .content .description{
				padding: 0 0px;
    			margin: 0 auto;
    			width: 240px;
				text-align: center;
			}
			.home_intro .content .social_icon {
				margin: 0 7px;
			}
			
			.circular--landscape {
			  display: inline-block;
			  position: relative;
			  width: 200px;
			  height: 200px;
			  overflow: hidden;
			  border-radius: 50%;
			}

			.home_intro .content .intro .image img {
			  width: auto;
			  height: 100%;
			  /*margin-left: -50px;*/
			}
		</style>
		

					
				
		
		<div class="container content-wrapper">
			<div class="row">	
				
				
				
	
	
	<div id="primary" class="content-area col-md-9 ">

		
		<main id="main" class="post-wrap" role="main">

		
			
<article id="post-846" class="post-846 post type-post status-publish format-standard has-post-thumbnail hentry category-programming-statistics category-statistics-model tag-data-pre-processing tag-eda tag-exploratory-data-analysis tag-glm tag-information-value tag-iv tag-logistic-regression tag-221 tag-222 tag-226">
	
	
			<div class="entry-thumb">
			<img width="5847" height="3898" src="/wp-content/uploads/2018/08/domenico-loia-364221-unsplash.jpg" class="attachment-large-thumb size-large-thumb wp-post-image" alt="domenico-loia-364221-unsplash" loading="lazy" srcset="/wp-content/uploads/2018/08/domenico-loia-364221-unsplash.jpg 5847w,/wp-content/uploads/2018/08/domenico-loia-364221-unsplash-300x200.jpg 300w,/wp-content/uploads/2018/08/domenico-loia-364221-unsplash-768x512.jpg 768w,/wp-content/uploads/2018/08/domenico-loia-364221-unsplash-1024x683.jpg 1024w,/wp-content/uploads/2018/08/domenico-loia-364221-unsplash-830x553.jpg 830w,/wp-content/uploads/2018/08/domenico-loia-364221-unsplash-230x153.jpg 230w,/wp-content/uploads/2018/08/domenico-loia-364221-unsplash-350x233.jpg 350w,/wp-content/uploads/2018/08/domenico-loia-364221-unsplash-480x320.jpg 480w" sizes="(max-width: 5847px) 100vw, 5847px">		</div>
		
	<header class="entry-header">
		
		<div class="meta-post">
			<a href="/category/programming-statistics/" title=" 程式與統計" class="post-cat"> 程式與統計</a><a href="/category/programming-statistics/statistics-model/" title="統計模型" class="post-cat">統計模型</a>		</div>

		<h1 class="title-post entry-title">Logistic Regression 羅吉斯迴歸 | part1 – 資料探勘與處理 | 統計 R語言</h1>
				<div class="single-meta">
			<span class="posted-on">發表於 <a href="/logistic-regression-part1-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" rel="bookmark"><time class="entry-date published" datetime="2018-08-28T14:24:19+08:00">2018-08-28</time><time class="updated" datetime="2020-07-03T10:33:23+08:00">2020-07-03</time></a></span><span class="byline"> <span class="author vcard"><a class="url fn n" href="/author/jamleecute/">jamleecute</a></span></span>		</div>
			</header>

	

	<div class="entry-content">
		<p class=""></p>
<p>Logistic Regression, 羅吉斯回歸模型，適用於<span style="color: #9f6ad4;">預測<span style="text-decoration: underline;">二元類別目標變數</span>的發生機率(p)</span>，和線性回歸模型類似，與線性回歸主要不同之處在於：(1) 目標變數是目標事件發生機率P經過log函數轉換成log odds值才進行線性預測，且(2)羅吉斯回歸的各項參數是透過最大概似法(MLE)進行估計的。</p>
<h3>Logistic Regression 羅吉斯回歸模型簡介</h3>
<p>線性迴歸模型是用來預測連續型變數，而羅吉斯回歸則是用來預測類別型變數。<br>
羅吉斯回歸和線性回歸模型類似，只不過<span style="color: #9d6ad4;">預測類別目標變數是經過log函數轉換才投入線性模型中的</span>。羅吉斯回歸方程式<span style="color: #9d6ad4;">將類別目標變數轉換為事件的log odds值，也就是\(\log\lgroup\frac{P_{i}}{1-P_{i}}\rgroup\)</span>，來預測Z與預測變數間(X1~Xn)的線性關係。</p>
<p><strong>羅吉斯回歸方程式：</strong></p>
<p><span id="MathJax-Span-15" class="mrow"><span id="MathJax-Span-43" class="mo">$$Z_{i}=\log\lgroup\frac{P_{i}}{1-P_{i}}\rgroup=\beta_{0}+\beta_{1}*x_{1}+…+\beta_{n}*x_{n}$$</span></span></p>
<p>其中：</p>
<p>(1) \(P_{i}\)為事件發生的機率值。</p>
<p>(2) \(\lgroup\frac{P_{i}}{1-P_{i}}\rgroup\)為勝算比(Odds Ratio)。</p>
<p>在R語言中，上述模型可透過<span style="color: #9d6ad4;">glm()函式</span>，將參數設定為<span style="color: #0000ff;"><span style="color: #9d6ad4;">family=”binomial”</span><span style="color: #000000;">來執行</span></span>。</p>
<p>但因為我們真正關心的是模型預測的事件發生機率值Pi。所以，預測結果則透過plogis()函數將事件的log odds轉換為Pi。轉換公式如下：</p>
<p>$$P_{i}=1-\lgroup\frac{1}{1+e_{i}^z}\rgroup$$</p>
<p>羅吉斯回歸透過log函數轉換，產生了一個臨界遞增的S型函數，<span style="color: #9d6ad4;">適用於分析機率模型</span>。<br>
而不同於線性迴歸，羅吉斯回歸分析的各項參數係數，是透過最大概似法(MLE)進行估計。</p>
<h3>分析資料與問題</h3>
<p>Problem: 預測薪資大於50K(ABOVE50K)的影響特徵因素有哪些？</p>
<p>Data: <a href="https://archive.ics.uci.edu/ml/datasets/adult">adult dataset</a> (snapshot)</p>
<p>目標變數(1)：ABOVE50K</p>
<p>預測變數(13)：AGE, WORKCLASS, EDUCATION, EDUCATIONNUM, MARITALSTATUS, OCCUPATION, RELATIONSHIP, RACE, SEX, CAPITALGAIN, CAPITALLOSS, HOURSPERWEEK, NATIVECOUNTRY</p>
<h3>分析步驟</h3>
<p>(part 1 篇會說明步驟1~5的部分)</p>
<ol>
<li><span style="color: #9d6ad4;">資料載入與檢視</span></li>
<li><span style="color: #9d6ad4;">資料探勘</span></li>
<li><span style="color: #9d6ad4;">資料前處理</span></li>
<li><span style="color: #9d6ad4;">產生訓練資料集與測試資料集</span></li>
<li><span style="color: #9d6ad4;">計算特徵變數IV值(Information Value)，篩選變數</span></li>
<li>訓練模型與預測</li>
<li>模型診斷與調整</li>
<li> 模型比較(v.s. Machine Learning Methods)</li>
</ol>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<h3>1. 資料載入與檢視</h3>
<p></p>

		<div id="crayon-60ed954725b55474610655" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# download from google drive's shareable link:
# https://drive.google.com/file/d/1L71tumU33xmVa2EtxjTyrZ2F6CaXn9iR/view?usp=sharing
id <- "1L71tumU33xmVa2EtxjTyrZ2F6CaXn9iR" # google file ID
inputData <- read.csv(sprintf("https://docs.google.com/uc?id=%s&export=download", id))
# 摘要資料集
summary(inputData)

# AGE                    WORKCLASS         FNLWGT                EDUCATION    
# Min.   :17.00    Private         :22696   Min.   :  12285    HS-grad     :10501  
# 1st Qu.:28.00    Self-emp-not-inc: 2541   1st Qu.: 117827    Some-college: 7291  
# Median :37.00    Local-gov       : 2093   Median : 178356    Bachelors   : 5355  
# Mean   :38.58    ?               : 1836   Mean   : 189778    Masters     : 1723  
# 3rd Qu.:48.00    State-gov       : 1298   3rd Qu.: 237051    Assoc-voc   : 1382  
# Max.   :90.00    Self-emp-inc    : 1116   Max.   :1484705    11th        : 1175  
#                 (Other)          :  981                     (Other)      : 5134  
# EDUCATIONNUM                  MARITALSTATUS              OCCUPATION  
# Min.   : 1.00    Divorced             : 4443    Prof-specialty :4140  
# 1st Qu.: 9.00    Married-AF-spouse    :   23    Craft-repair   :4099  
# Median :10.00    Married-civ-spouse   :14976    Exec-managerial:4066  
# Mean   :10.08    Married-spouse-absent:  418    Adm-clerical   :3770  
# 3rd Qu.:12.00    Never-married        :10683    Sales          :3650  
# Max.   :16.00    Separated            : 1025    Other-service  :3295  
#                  Widowed              :  993   (Other)         :9541  
# RELATIONSHIP                    RACE            SEX       
# Husband       :13193    Amer-Indian-Eskimo:  311    Female:10771  
# Not-in-family : 8305    Asian-Pac-Islander: 1039    Male  :21790  
# Other-relative:  981    Black             : 3124                  
# Own-child     : 5068    Other             :  271                  
# Unmarried     : 3446    White             :27816                  
# Wife          : 1568                                              
# 
# CAPITALGAIN     CAPITALLOSS      HOURSPERWEEK          NATIVECOUNTRY  
# Min.   :    0   Min.   :   0.0   Min.   : 1.00    United-States:29170  
# 1st Qu.:    0   1st Qu.:   0.0   1st Qu.:40.00    Mexico       :  643  
# Median :    0   Median :   0.0   Median :40.00    ?            :  583  
# Mean   : 1078   Mean   :  87.3   Mean   :40.44    Philippines  :  198  
# 3rd Qu.:    0   3rd Qu.:   0.0   3rd Qu.:45.00    Germany      :  137  
# Max.   :99999   Max.   :4356.0   Max.   :99.00    Canada       :  121  
#                                                  (Other)       : 1709  
# ABOVE50K     
# Min.   :0.0000  
# 1st Qu.:0.0000  
# Median :0.0000  
# Mean   :0.2408  
# 3rd Qu.:0.0000  
# Max.   :1.0000</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b55474610655-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-19">19</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-20">20</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-21">21</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-22">22</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-23">23</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-24">24</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-25">25</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-26">26</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-27">27</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-28">28</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-29">29</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-30">30</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-31">31</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-32">32</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-33">33</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-34">34</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-35">35</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-36">36</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-37">37</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-38">38</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-39">39</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-40">40</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-41">41</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-42">42</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-43">43</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-44">44</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-45">45</div><div class="crayon-num" data-line="crayon-60ed954725b55474610655-46">46</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b55474610655-1"># download from google drive's shareable link:</div><div class="crayon-line" id="crayon-60ed954725b55474610655-2"># https://drive.google.com/file/d/1L71tumU33xmVa2EtxjTyrZ2F6CaXn9iR/view?usp=sharing</div><div class="crayon-line" id="crayon-60ed954725b55474610655-3">id <div class="crayon-line" id="crayon-60ed954725b55474610655-4">inputData <div class="crayon-line" id="crayon-60ed954725b55474610655-5"># 摘要資料集</div><div class="crayon-line" id="crayon-60ed954725b55474610655-6">summary(inputData)</div><div class="crayon-line" id="crayon-60ed954725b55474610655-7"> </div><div class="crayon-line" id="crayon-60ed954725b55474610655-8"># AGE                    WORKCLASS         FNLWGT                EDUCATION    </div><div class="crayon-line" id="crayon-60ed954725b55474610655-9"># Min.   :17.00    Private         :22696   Min.   :  12285    HS-grad     :10501  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-10"># 1st Qu.:28.00    Self-emp-not-inc: 2541   1st Qu.: 117827    Some-college: 7291  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-11"># Median :37.00    Local-gov       : 2093   Median : 178356    Bachelors   : 5355  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-12"># Mean   :38.58    ?               : 1836   Mean   : 189778    Masters     : 1723  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-13"># 3rd Qu.:48.00    State-gov       : 1298   3rd Qu.: 237051    Assoc-voc   : 1382  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-14"># Max.   :90.00    Self-emp-inc    : 1116   Max.   :1484705    11th        : 1175  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-15">#                 (Other)          :  981                     (Other)      : 5134  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-16"># EDUCATIONNUM                  MARITALSTATUS              OCCUPATION  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-17"># Min.   : 1.00    Divorced             : 4443    Prof-specialty :4140  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-18"># 1st Qu.: 9.00    Married-AF-spouse    :   23    Craft-repair   :4099  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-19"># Median :10.00    Married-civ-spouse   :14976    Exec-managerial:4066  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-20"># Mean   :10.08    Married-spouse-absent:  418    Adm-clerical   :3770  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-21"># 3rd Qu.:12.00    Never-married        :10683    Sales          :3650  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-22"># Max.   :16.00    Separated            : 1025    Other-service  :3295  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-23">#                  Widowed              :  993   (Other)         :9541  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-24"># RELATIONSHIP                    RACE            SEX       </div><div class="crayon-line" id="crayon-60ed954725b55474610655-25"># Husband       :13193    Amer-Indian-Eskimo:  311    Female:10771  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-26"># Not-in-family : 8305    Asian-Pac-Islander: 1039    Male  :21790  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-27"># Other-relative:  981    Black             : 3124                  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-28"># Own-child     : 5068    Other             :  271                  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-29"># Unmarried     : 3446    White             :27816                  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-30"># Wife          : 1568                                              </div><div class="crayon-line" id="crayon-60ed954725b55474610655-31"># </div><div class="crayon-line" id="crayon-60ed954725b55474610655-32"># CAPITALGAIN     CAPITALLOSS      HOURSPERWEEK          NATIVECOUNTRY  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-33"># Min.   :    0   Min.   :   0.0   Min.   : 1.00    United-States:29170  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-34"># 1st Qu.:    0   1st Qu.:   0.0   1st Qu.:40.00    Mexico       :  643  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-35"># Median :    0   Median :   0.0   Median :40.00    ?            :  583  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-36"># Mean   : 1078   Mean   :  87.3   Mean   :40.44    Philippines  :  198  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-37"># 3rd Qu.:    0   3rd Qu.:   0.0   3rd Qu.:45.00    Germany      :  137  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-38"># Max.   :99999   Max.   :4356.0   Max.   :99.00    Canada       :  121  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-39">#                                                  (Other)       : 1709  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-40"># ABOVE50K     </div><div class="crayon-line" id="crayon-60ed954725b55474610655-41"># Min.   :0.0000  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-42"># 1st Qu.:0.0000  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-43"># Median :0.0000  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-44"># Mean   :0.2408  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-45"># 3rd Qu.:0.0000  </div><div class="crayon-line" id="crayon-60ed954725b55474610655-46"># Max.   :1.0000</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>由於我們的目標變數目前是數值0,1，為了後續分析，我們決定(1)ABOVE50K轉變成(<=50K, >50K)的factor變數，並(2)另外新增ABOVE50K_y(0,1)的factor變數。</p>

		<div id="crayon-60ed954725b5a653075267" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 將ABOVE50K原始0,1轉換成<=50K, > 50K的factor資料類型
inputData$ABOVE50K <- factor(x = inputData$ABOVE50K, levels = c(0,1), labels = c('<=50K', '>50K'))
# 產生新factor變數ABOVE50K_y：
library(dplyr)
inputData$ABOVE50K_y <- as.factor(case_when(inputData$ABOVE50K == "<=50K" ~ 0,
                                             inputData$ABOVE50K == ">50K" ~ 1))
# 確認轉換後的變數沒有問題
summary(inputData$ABOVE50K)
# <=50K  >50K 
# 24720  7841 
summary(inputData$ABOVE50K_y)
# 0     1 
# 24720  7841</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b5a653075267-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b5a653075267-1"># 將ABOVE50K原始0,1轉換成 50K的factor資料類型</div><div class="crayon-line" id="crayon-60ed954725b5a653075267-2">inputData$ABOVE50K 50K'))</div><div class="crayon-line" id="crayon-60ed954725b5a653075267-3"># 產生新factor變數ABOVE50K_y：</div><div class="crayon-line" id="crayon-60ed954725b5a653075267-4">library(dplyr)</div><div class="crayon-line" id="crayon-60ed954725b5a653075267-5">inputData$ABOVE50K_y <div class="crayon-line" id="crayon-60ed954725b5a653075267-6">                                             inputData$ABOVE50K == ">50K" ~ 1))</div><div class="crayon-line" id="crayon-60ed954725b5a653075267-7"># 確認轉換後的變數沒有問題</div><div class="crayon-line" id="crayon-60ed954725b5a653075267-8">summary(inputData$ABOVE50K)</div><div class="crayon-line" id="crayon-60ed954725b5a653075267-9"># 50K </div><div class="crayon-line" id="crayon-60ed954725b5a653075267-10"># 24720  7841 </div><div class="crayon-line" id="crayon-60ed954725b5a653075267-11">summary(inputData$ABOVE50K_y)</div><div class="crayon-line" id="crayon-60ed954725b5a653075267-12"># 0     1 </div><div class="crayon-line" id="crayon-60ed954725b5a653075267-13"># 24720  7841</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>最後再確認一次資料集所有變數型態。</p>

		<div id="crayon-60ed954725b5c113080909" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 查看資料結構:資料變數、型態
str(inputData)

# 'data.frame':	32561 obs. of  16 variables:
# $ AGE          : int  39 50 38 53 28 37 49 52 31 42 ...
# $ WORKCLASS    : Factor w/ 9 levels " ?"," Federal-gov",..: 8 7 5 5 5 5 5 7 5 5 ...
# $ FNLWGT       : int  77516 83311 215646 234721 338409 284582 160187 209642 45781 159449 ...
# $ EDUCATION    : Factor w/ 16 levels " 10th"," 11th",..: 10 10 12 2 10 13 7 12 13 10 ...
# $ EDUCATIONNUM : int  13 13 9 7 13 14 5 9 14 13 ...
# $ MARITALSTATUS: Factor w/ 7 levels " Divorced"," Married-AF-spouse",..: 5 3 1 3 3 3 4 3 5 3 ...
# $ OCCUPATION   : Factor w/ 15 levels " ?"," Adm-clerical",..: 2 5 7 7 11 5 9 5 11 5 ...
# $ RELATIONSHIP : Factor w/ 6 levels " Husband"," Not-in-family",..: 2 1 2 1 6 6 2 1 2 1 ...
# $ RACE         : Factor w/ 5 levels " Amer-Indian-Eskimo",..: 5 5 5 3 3 5 3 5 5 5 ...
# $ SEX          : Factor w/ 2 levels " Female"," Male": 2 2 2 2 1 1 1 2 1 2 ...
# $ CAPITALGAIN  : int  2174 0 0 0 0 0 0 0 14084 5178 ...
# $ CAPITALLOSS  : int  0 0 0 0 0 0 0 0 0 0 ...
# $ HOURSPERWEEK : int  40 13 40 40 40 40 16 45 50 40 ...
# $ NATIVECOUNTRY: Factor w/ 42 levels " ?"," Cambodia",..: 40 40 40 40 6 40 24 40 40 40 ...
# $ ABOVE50K     : Factor w/ 2 levels "<=50K",">50K": 1 1 1 1 1 1 1 2 2 2 ...
# $ ABOVE50K_y   : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 2 2 2 ...</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-19">19</div><div class="crayon-num" data-line="crayon-60ed954725b5c113080909-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b5c113080909-1"># 查看資料結構:資料變數、型態</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-2">str(inputData)</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-3"> </div><div class="crayon-line" id="crayon-60ed954725b5c113080909-4"># 'data.frame':	32561 obs. of  16 variables:</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-5"># $ AGE          : int  39 50 38 53 28 37 49 52 31 42 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-6"># $ WORKCLASS    : Factor w/ 9 levels " ?"," Federal-gov",..: 8 7 5 5 5 5 5 7 5 5 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-7"># $ FNLWGT       : int  77516 83311 215646 234721 338409 284582 160187 209642 45781 159449 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-8"># $ EDUCATION    : Factor w/ 16 levels " 10th"," 11th",..: 10 10 12 2 10 13 7 12 13 10 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-9"># $ EDUCATIONNUM : int  13 13 9 7 13 14 5 9 14 13 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-10"># $ MARITALSTATUS: Factor w/ 7 levels " Divorced"," Married-AF-spouse",..: 5 3 1 3 3 3 4 3 5 3 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-11"># $ OCCUPATION   : Factor w/ 15 levels " ?"," Adm-clerical",..: 2 5 7 7 11 5 9 5 11 5 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-12"># $ RELATIONSHIP : Factor w/ 6 levels " Husband"," Not-in-family",..: 2 1 2 1 6 6 2 1 2 1 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-13"># $ RACE         : Factor w/ 5 levels " Amer-Indian-Eskimo",..: 5 5 5 3 3 5 3 5 5 5 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-14"># $ SEX          : Factor w/ 2 levels " Female"," Male": 2 2 2 2 1 1 1 2 1 2 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-15"># $ CAPITALGAIN  : int  2174 0 0 0 0 0 0 0 14084 5178 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-16"># $ CAPITALLOSS  : int  0 0 0 0 0 0 0 0 0 0 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-17"># $ HOURSPERWEEK : int  40 13 40 40 40 40 16 45 50 40 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-18"># $ NATIVECOUNTRY: Factor w/ 42 levels " ?"," Cambodia",..: 40 40 40 40 6 40 24 40 40 40 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-19"># $ ABOVE50K     : Factor w/ 2 levels "50K": 1 1 1 1 1 1 1 2 2 2 ...</div><div class="crayon-line" id="crayon-60ed954725b5c113080909-20"># $ ABOVE50K_y   : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 2 2 2 ...</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>幾個光看變數名稱不足以了解的變數說明如下：<br>
(1) fnlwgt : 代表final weight，即該代表個體在母體所佔比例<br>
(2) educatoin_num：代表受教育的時間(年份)<br>
<span style="color: #9d6ad4;">為了簡化分析，我們將忽略fnlwgt每個代表個體在母體中所佔比重。</span></p>
<h3>2. 資料探勘(Exploratory Data Analysis)</h3>
<p></p>

		<div id="crayon-60ed954725b5e533796162" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 載入繪圖所需套件
library(ggplot2)
library(scales) # needed for labels=percent</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b5e533796162-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b5e533796162-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b5e533796162-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b5e533796162-1"># 載入繪圖所需套件</div><div class="crayon-line" id="crayon-60ed954725b5e533796162-2">library(ggplot2)</div><div class="crayon-line" id="crayon-60ed954725b5e533796162-3">library(scales) # needed for labels=percent</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>2-1. Age</p>
<p>查看年齡變數(AGE)各區間次數分佈與每區間薪資水準組成比例。</p>

		<div id="crayon-60ed954725b60015507245" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 2-1. age
summary(inputData$AGE)
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 17.00   28.00   37.00   38.58   48.00   90.00 

gg <- 
  ggplot(data = inputData, aes(x = as.numeric(AGE))) +
  geom_histogram(color = "black",binwidth = 1, aes(group=ABOVE50K, fill = ABOVE50K)) +
  geom_vline(xintercept = mean(inputData$AGE[inputData$ABOVE50K == 1]), col = "blue", lty = 5, lwd = 0.8) +
  geom_vline(xintercept = mean(inputData$AGE[inputData$ABOVE50K == 0]), col = "black", lty = 5, lwd = 0.8)
gg</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b60015507245-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b60015507245-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b60015507245-1"># 2-1. age</div><div class="crayon-line" id="crayon-60ed954725b60015507245-2">summary(inputData$AGE)</div><div class="crayon-line" id="crayon-60ed954725b60015507245-3"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </div><div class="crayon-line" id="crayon-60ed954725b60015507245-4"># 17.00   28.00   37.00   38.58   48.00   90.00 </div><div class="crayon-line" id="crayon-60ed954725b60015507245-5"> </div><div class="crayon-line" id="crayon-60ed954725b60015507245-6">gg <div class="crayon-line" id="crayon-60ed954725b60015507245-7">  ggplot(data = inputData, aes(x = as.numeric(AGE))) +</div><div class="crayon-line" id="crayon-60ed954725b60015507245-8">  geom_histogram(color = "black",binwidth = 1, aes(group=ABOVE50K, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b60015507245-9">  geom_vline(xintercept = mean(inputData$AGE[inputData$ABOVE50K == 1]), col = "blue", lty = 5, lwd = 0.8) +</div><div class="crayon-line" id="crayon-60ed954725b60015507245-10">  geom_vline(xintercept = mean(inputData$AGE[inputData$ABOVE50K == 0]), col = "black", lty = 5, lwd = 0.8)</div><div class="crayon-line" id="crayon-60ed954725b60015507245-11">gg</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>可以發現薪資水平高於50K的年齡偏高，平均數約落在40-50歲，而薪資水平小於等於50K的族群偏年輕。</p>
<p><img loading="lazy" class="alignnone size-large wp-image-890" src="/wp-content/uploads/2018/08/pic01-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic01-1024x659.png 1024w,/wp-content/uploads/2018/08/pic01-300x193.png 300w,/wp-content/uploads/2018/08/pic01-768x494.png 768w,/wp-content/uploads/2018/08/pic01-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>2-2. Workclass</p>

		<div id="crayon-60ed954725b61984161639" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$WORKCLASS)
# ?       Federal-gov         Local-gov      Never-worked 
# 1836               960              2093                 7 
# Private      Self-emp-inc  Self-emp-not-inc         State-gov 
# 22696              1116              2541              1298 
# Without-pay 
# 14</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b61984161639-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b61984161639-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b61984161639-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b61984161639-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b61984161639-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b61984161639-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b61984161639-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b61984161639-1">summary(inputData$WORKCLASS)</div><div class="crayon-line" id="crayon-60ed954725b61984161639-2"># ?       Federal-gov         Local-gov      Never-worked </div><div class="crayon-line" id="crayon-60ed954725b61984161639-3"># 1836               960              2093                 7 </div><div class="crayon-line" id="crayon-60ed954725b61984161639-4"># Private      Self-emp-inc  Self-emp-not-inc         State-gov </div><div class="crayon-line" id="crayon-60ed954725b61984161639-5"># 22696              1116              2541              1298 </div><div class="crayon-line" id="crayon-60ed954725b61984161639-6"># Without-pay </div><div class="crayon-line" id="crayon-60ed954725b61984161639-7"># 14</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>查看workclass各類別次數分佈。</p>

		<div id="crayon-60ed954725b62349187993" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$WORKCLASS <- factor(x = inputData$WORKCLASS,levels = names(sort(table(inputData$WORKCLASS),decreasing = TRUE)))
ggplot(data = inputData, aes(x = WORKCLASS, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b62349187993-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b62349187993-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b62349187993-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b62349187993-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b62349187993-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b62349187993-1">inputData$WORKCLASS <div class="crayon-line" id="crayon-60ed954725b62349187993-2">ggplot(data = inputData, aes(x = WORKCLASS, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b62349187993-3">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b62349187993-4">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b62349187993-5">  scale_fill_brewer(palette="Paired")</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-891" src="/wp-content/uploads/2018/08/pic02-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic02-1024x659.png 1024w,/wp-content/uploads/2018/08/pic02-300x193.png 300w,/wp-content/uploads/2018/08/pic02-768x494.png 768w,/wp-content/uploads/2018/08/pic02-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>查看workclass各類別薪資水準組成比例。</p>

		<div id="crayon-60ed954725b64698855595" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例
df2 <- cbind.data.frame(WORKCLASS = inputData$WORKCLASS,ABOVE50K = inputData$ABOVE50K)
df2.summary <- 
  df2 %>% group_by(WORKCLASS,ABOVE50K) %>% 
  summarise(n = n()) %>% 
  mutate(ratio=scales::percent(n/sum(n)))

# 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例
ggplot(inputData, aes(x = forcats::fct_reorder(f = WORKCLASS, x = as.numeric(ABOVE50K),fun = mean, .desc = TRUE), fill = ABOVE50K)) +
  geom_bar(position = "fill") + 
  geom_text(data=df2.summary, aes(y=n,label=ratio),
            position=position_fill(vjust=0.5)) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette="Paired")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b64698855595-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b64698855595-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b64698855595-1"># 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例</div><div class="crayon-line" id="crayon-60ed954725b64698855595-2">df2 <div class="crayon-line" id="crayon-60ed954725b64698855595-3">df2.summary <div class="crayon-line" id="crayon-60ed954725b64698855595-4">  df2 %>% group_by(WORKCLASS,ABOVE50K) %>% </div><div class="crayon-line" id="crayon-60ed954725b64698855595-5">  summarise(n = n()) %>% </div><div class="crayon-line" id="crayon-60ed954725b64698855595-6">  mutate(ratio=scales::percent(n/sum(n)))</div><div class="crayon-line" id="crayon-60ed954725b64698855595-7"> </div><div class="crayon-line" id="crayon-60ed954725b64698855595-8"># 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例</div><div class="crayon-line" id="crayon-60ed954725b64698855595-9">ggplot(inputData, aes(x = forcats::fct_reorder(f = WORKCLASS, x = as.numeric(ABOVE50K),fun = mean, .desc = TRUE), fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b64698855595-10">  geom_bar(position = "fill") + </div><div class="crayon-line" id="crayon-60ed954725b64698855595-11">  geom_text(data=df2.summary, aes(y=n,label=ratio),</div><div class="crayon-line" id="crayon-60ed954725b64698855595-12">            position=position_fill(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b64698855595-13">  scale_y_continuous(labels = scales::percent) +</div><div class="crayon-line" id="crayon-60ed954725b64698855595-14">  scale_fill_brewer(palette="Paired")</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-957" src="/wp-content/uploads/2018/08/pic03-1024x928.png" alt="logistic regression" width="960" height="870" srcset="/wp-content/uploads/2018/08/pic03-1024x928.png 1024w,/wp-content/uploads/2018/08/pic03-300x272.png 300w,/wp-content/uploads/2018/08/pic03-768x696.png 768w,/wp-content/uploads/2018/08/pic03-1140x1034.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<p>2-3. Education</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b65383558066" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$EDUCATION)
# 10th          11th          12th       1st-4th       5th-6th       7th-8th 
# 933          1175           433           168           333           646 
# 9th    Assoc-acdm     Assoc-voc     Bachelors     Doctorate       HS-grad 
# 514          1067          1382          5355           413         10501 
# Masters     Preschool   Prof-school  Some-college 
# 1723            51           576          7291</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b65383558066-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b65383558066-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b65383558066-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b65383558066-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b65383558066-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b65383558066-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b65383558066-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b65383558066-1">summary(inputData$EDUCATION)</div><div class="crayon-line" id="crayon-60ed954725b65383558066-2"># 10th          11th          12th       1st-4th       5th-6th       7th-8th </div><div class="crayon-line" id="crayon-60ed954725b65383558066-3"># 933          1175           433           168           333           646 </div><div class="crayon-line" id="crayon-60ed954725b65383558066-4"># 9th    Assoc-acdm     Assoc-voc     Bachelors     Doctorate       HS-grad </div><div class="crayon-line" id="crayon-60ed954725b65383558066-5"># 514          1067          1382          5355           413         10501 </div><div class="crayon-line" id="crayon-60ed954725b65383558066-6"># Masters     Preschool   Prof-school  Some-college </div><div class="crayon-line" id="crayon-60ed954725b65383558066-7"># 1723            51           576          7291</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>次數分配圖</p>

		<div id="crayon-60ed954725b66002314807" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$EDUCATION <- factor(x = inputData$EDUCATION,levels = names(sort(table(inputData$EDUCATION),decreasing = TRUE)))
ggplot(data = inputData, aes(x = EDUCATION, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b66002314807-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b66002314807-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b66002314807-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b66002314807-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b66002314807-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b66002314807-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b66002314807-1">inputData$EDUCATION <div class="crayon-line" id="crayon-60ed954725b66002314807-2">ggplot(data = inputData, aes(x = EDUCATION, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b66002314807-3">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b66002314807-4">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b66002314807-5">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b66002314807-6">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-893" src="/wp-content/uploads/2018/08/pic04-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic04-1024x659.png 1024w,/wp-content/uploads/2018/08/pic04-300x193.png 300w,/wp-content/uploads/2018/08/pic04-768x494.png 768w,/wp-content/uploads/2018/08/pic04-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>各類別水準值中目標變數分佈圖</p>

		<div id="crayon-60ed954725b68276256525" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例
df2 <- cbind.data.frame(EDUCATION = inputData$EDUCATION,ABOVE50K = inputData$ABOVE50K)
df2.summary <- 
  df2 %>% group_by(EDUCATION) %>% 
  count(ABOVE50K) %>% 
  mutate(ratio=scales::percent(n/sum(n))) %>% 
  ungroup()

# 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例
ggplot(inputData, aes(x = forcats::fct_reorder(f = EDUCATION, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +
  geom_bar(position = "fill") + 
  geom_text(data=df2.summary, aes(y=n,label=ratio),
            position=position_fill(vjust=0.5)) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette="Paired") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b68276256525-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b68276256525-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b68276256525-1"># 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例</div><div class="crayon-line" id="crayon-60ed954725b68276256525-2">df2 <div class="crayon-line" id="crayon-60ed954725b68276256525-3">df2.summary <div class="crayon-line" id="crayon-60ed954725b68276256525-4">  df2 %>% group_by(EDUCATION) %>% </div><div class="crayon-line" id="crayon-60ed954725b68276256525-5">  count(ABOVE50K) %>% </div><div class="crayon-line" id="crayon-60ed954725b68276256525-6">  mutate(ratio=scales::percent(n/sum(n))) %>% </div><div class="crayon-line" id="crayon-60ed954725b68276256525-7">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b68276256525-8"> </div><div class="crayon-line" id="crayon-60ed954725b68276256525-9"># 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例</div><div class="crayon-line" id="crayon-60ed954725b68276256525-10">ggplot(inputData, aes(x = forcats::fct_reorder(f = EDUCATION, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b68276256525-11">  geom_bar(position = "fill") + </div><div class="crayon-line" id="crayon-60ed954725b68276256525-12">  geom_text(data=df2.summary, aes(y=n,label=ratio),</div><div class="crayon-line" id="crayon-60ed954725b68276256525-13">            position=position_fill(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b68276256525-14">  scale_y_continuous(labels = scales::percent) +</div><div class="crayon-line" id="crayon-60ed954725b68276256525-15">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b68276256525-16">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-960" src="/wp-content/uploads/2018/08/pic05-1024x928.png" alt="logistic regression" width="960" height="870" srcset="/wp-content/uploads/2018/08/pic05-1024x928.png 1024w,/wp-content/uploads/2018/08/pic05-300x272.png 300w,/wp-content/uploads/2018/08/pic05-768x696.png 768w,/wp-content/uploads/2018/08/pic05-1140x1034.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>2-4. Educationnum (教育年份)</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b69395424330" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$AGE)
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 17.00   28.00   37.00   38.58   48.00   90.00</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b69395424330-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b69395424330-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b69395424330-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b69395424330-1">summary(inputData$AGE)</div><div class="crayon-line" id="crayon-60ed954725b69395424330-2"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </div><div class="crayon-line" id="crayon-60ed954725b69395424330-3"># 17.00   28.00   37.00   38.58   48.00   90.00</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>次數分配圖</p>

		<div id="crayon-60ed954725b6a634157795" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$AGE_cut <- inputData$AGE 
inputData$AGE_cut <- cut(inputData$AGE_cut, breaks = seq(15,90,5),include.lowest = TRUE)
ggplot(data = inputData, aes(x = AGE_cut, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired") +
  labs(x = "AGE")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b6a634157795-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b6a634157795-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b6a634157795-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b6a634157795-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b6a634157795-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b6a634157795-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b6a634157795-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b6a634157795-1">inputData$AGE_cut <div class="crayon-line" id="crayon-60ed954725b6a634157795-2">inputData$AGE_cut <div class="crayon-line" id="crayon-60ed954725b6a634157795-3">ggplot(data = inputData, aes(x = AGE_cut, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b6a634157795-4">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b6a634157795-5">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b6a634157795-6">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b6a634157795-7">  labs(x = "AGE")</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-895" src="/wp-content/uploads/2018/08/pic06-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic06-1024x659.png 1024w,/wp-content/uploads/2018/08/pic06-300x193.png 300w,/wp-content/uploads/2018/08/pic06-768x494.png 768w,/wp-content/uploads/2018/08/pic06-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>各類別水準值中目標變數分佈圖</p>

		<div id="crayon-60ed954725b6e282617599" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例
df2 <- cbind.data.frame(AGE_cut = inputData$AGE_cut,ABOVE50K = inputData$ABOVE50K)
df2.summary <- 
  df2 %>% group_by(AGE_cut) %>% 
  count(ABOVE50K) %>% 
  mutate(ratio=scales::percent(n/sum(n))) %>% 
  ungroup()

# 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例
ggplot(inputData, aes(x = forcats::fct_reorder(f = AGE_cut, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +
  geom_bar(position = "fill") + 
  geom_text(data=df2.summary, aes(y=n,label=ratio),
            position=position_fill(vjust=0.5)) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette="Paired") +
  labs(x = "AGE")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b6e282617599-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b6e282617599-1"># 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例</div><div class="crayon-line" id="crayon-60ed954725b6e282617599-2">df2 <div class="crayon-line" id="crayon-60ed954725b6e282617599-3">df2.summary <div class="crayon-line" id="crayon-60ed954725b6e282617599-4">  df2 %>% group_by(AGE_cut) %>% </div><div class="crayon-line" id="crayon-60ed954725b6e282617599-5">  count(ABOVE50K) %>% </div><div class="crayon-line" id="crayon-60ed954725b6e282617599-6">  mutate(ratio=scales::percent(n/sum(n))) %>% </div><div class="crayon-line" id="crayon-60ed954725b6e282617599-7">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b6e282617599-8"> </div><div class="crayon-line" id="crayon-60ed954725b6e282617599-9"># 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例</div><div class="crayon-line" id="crayon-60ed954725b6e282617599-10">ggplot(inputData, aes(x = forcats::fct_reorder(f = AGE_cut, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b6e282617599-11">  geom_bar(position = "fill") + </div><div class="crayon-line" id="crayon-60ed954725b6e282617599-12">  geom_text(data=df2.summary, aes(y=n,label=ratio),</div><div class="crayon-line" id="crayon-60ed954725b6e282617599-13">            position=position_fill(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b6e282617599-14">  scale_y_continuous(labels = scales::percent) +</div><div class="crayon-line" id="crayon-60ed954725b6e282617599-15">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b6e282617599-16">  labs(x = "AGE")</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-896" src="/wp-content/uploads/2018/08/pic07-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic07-1024x659.png 1024w,/wp-content/uploads/2018/08/pic07-300x193.png 300w,/wp-content/uploads/2018/08/pic07-768x494.png 768w,/wp-content/uploads/2018/08/pic07-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>2-5. MaritalStatus</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b6f032906040" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$MARITALSTATUS)
# Divorced      Married-AF-spouse     Married-civ-spouse 
# 4443                     23                  14976 
# Married-spouse-absent          Never-married              Separated 
# 418                  10683                   1025 
# Widowed 
# 993</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b6f032906040-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b6f032906040-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b6f032906040-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b6f032906040-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b6f032906040-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b6f032906040-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b6f032906040-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b6f032906040-1">summary(inputData$MARITALSTATUS)</div><div class="crayon-line" id="crayon-60ed954725b6f032906040-2"># Divorced      Married-AF-spouse     Married-civ-spouse </div><div class="crayon-line" id="crayon-60ed954725b6f032906040-3"># 4443                     23                  14976 </div><div class="crayon-line" id="crayon-60ed954725b6f032906040-4"># Married-spouse-absent          Never-married              Separated </div><div class="crayon-line" id="crayon-60ed954725b6f032906040-5"># 418                  10683                   1025 </div><div class="crayon-line" id="crayon-60ed954725b6f032906040-6"># Widowed </div><div class="crayon-line" id="crayon-60ed954725b6f032906040-7"># 993</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>次數分配圖</p>

		<div id="crayon-60ed954725b70744211839" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$MARITALSTATUS <- factor(x = inputData$MARITALSTATUS,levels = names(sort(table(inputData$MARITALSTATUS),decreasing = TRUE)))
ggplot(data = inputData, aes(x = MARITALSTATUS, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b70744211839-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b70744211839-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b70744211839-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b70744211839-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b70744211839-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b70744211839-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b70744211839-1">inputData$MARITALSTATUS <div class="crayon-line" id="crayon-60ed954725b70744211839-2">ggplot(data = inputData, aes(x = MARITALSTATUS, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b70744211839-3">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b70744211839-4">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b70744211839-5">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b70744211839-6">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-897" src="/wp-content/uploads/2018/08/pic08-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic08-1024x659.png 1024w,/wp-content/uploads/2018/08/pic08-300x193.png 300w,/wp-content/uploads/2018/08/pic08-768x494.png 768w,/wp-content/uploads/2018/08/pic08-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>各類別水準值中目標變數分佈圖</p>

		<div id="crayon-60ed954725b72933184695" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例
df2 <- cbind.data.frame(MARITALSTATUS = inputData$MARITALSTATUS,ABOVE50K = inputData$ABOVE50K)
df2.summary <- 
  df2 %>% group_by(MARITALSTATUS) %>% 
  count(ABOVE50K) %>% 
  mutate(ratio=scales::percent(n/sum(n))) %>% 
  ungroup()

# 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例
ggplot(inputData, aes(x = forcats::fct_reorder(f = MARITALSTATUS, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +
  geom_bar(position = "fill") + 
  geom_text(data=df2.summary, aes(y=n,label=ratio),
            position=position_fill(vjust=0.5)) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette="Paired") +
  labs(x = "MARITALSTATUS", y = "percentage") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b72933184695-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b72933184695-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b72933184695-1"># 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例</div><div class="crayon-line" id="crayon-60ed954725b72933184695-2">df2 <div class="crayon-line" id="crayon-60ed954725b72933184695-3">df2.summary <div class="crayon-line" id="crayon-60ed954725b72933184695-4">  df2 %>% group_by(MARITALSTATUS) %>% </div><div class="crayon-line" id="crayon-60ed954725b72933184695-5">  count(ABOVE50K) %>% </div><div class="crayon-line" id="crayon-60ed954725b72933184695-6">  mutate(ratio=scales::percent(n/sum(n))) %>% </div><div class="crayon-line" id="crayon-60ed954725b72933184695-7">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b72933184695-8"> </div><div class="crayon-line" id="crayon-60ed954725b72933184695-9"># 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例</div><div class="crayon-line" id="crayon-60ed954725b72933184695-10">ggplot(inputData, aes(x = forcats::fct_reorder(f = MARITALSTATUS, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b72933184695-11">  geom_bar(position = "fill") + </div><div class="crayon-line" id="crayon-60ed954725b72933184695-12">  geom_text(data=df2.summary, aes(y=n,label=ratio),</div><div class="crayon-line" id="crayon-60ed954725b72933184695-13">            position=position_fill(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b72933184695-14">  scale_y_continuous(labels = scales::percent) +</div><div class="crayon-line" id="crayon-60ed954725b72933184695-15">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b72933184695-16">  labs(x = "MARITALSTATUS", y = "percentage") +</div><div class="crayon-line" id="crayon-60ed954725b72933184695-17">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-898" src="/wp-content/uploads/2018/08/pic09-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic09-1024x659.png 1024w,/wp-content/uploads/2018/08/pic09-300x193.png 300w,/wp-content/uploads/2018/08/pic09-768x494.png 768w,/wp-content/uploads/2018/08/pic09-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>如果想要同一張圖y軸可以看到frequency，stacked bar可以看到目標類別水平的比例分佈，可以使用下面方法繪製。</p>

		<div id="crayon-60ed954725b73773374804" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 如果想要在同一張圖同時看到frequencies & proportion:
# 先新增一欄label位置的欄位
# (依照ABOVE50K的類別水準順序，計算累積數值，並將數值置中於各類別累積高度)
df3.summary <-
  df2.summary %>%
  group_by(MARITALSTATUS) %>%
  #因為繪圖資訊是先畫>50K，再畫<=50K，故要調整累積數值計算的順序
  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% 
  ungroup() %>% 
  group_by(MARITALSTATUS) %>%
  mutate(pos = (cumsum(n) - (0.5 * n))) %>%
  as.data.frame() %>% 
  ungroup()

ggplot(data = df3.summary,mapping = aes(x = MARITALSTATUS, y = n, fill = ABOVE50K)) +
  geom_bar(stat = "identity") + 
  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +
  scale_fill_brewer(palette="Paired") +
  labs(title = "MARITALSTATUS VS ABOVE50K",
       x = "MARITALSTATUS", y = "Frequencies") + # Add Title and Labels
  theme(plot.title = element_text(hjust = 0.5)) # Change the appearance of the main title</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b73773374804-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-19">19</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-20">20</div><div class="crayon-num" data-line="crayon-60ed954725b73773374804-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b73773374804-1"># 如果想要在同一張圖同時看到frequencies & proportion:</div><div class="crayon-line" id="crayon-60ed954725b73773374804-2"># 先新增一欄label位置的欄位</div><div class="crayon-line" id="crayon-60ed954725b73773374804-3"># (依照ABOVE50K的類別水準順序，計算累積數值，並將數值置中於各類別累積高度)</div><div class="crayon-line" id="crayon-60ed954725b73773374804-4">df3.summary <div class="crayon-line" id="crayon-60ed954725b73773374804-5">  df2.summary %>%</div><div class="crayon-line" id="crayon-60ed954725b73773374804-6">  group_by(MARITALSTATUS) %>%</div><div class="crayon-line" id="crayon-60ed954725b73773374804-7">  #因為繪圖資訊是先畫>50K，再畫<div class="crayon-line" id="crayon-60ed954725b73773374804-8">  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% </div><div class="crayon-line" id="crayon-60ed954725b73773374804-9">  ungroup() %>% </div><div class="crayon-line" id="crayon-60ed954725b73773374804-10">  group_by(MARITALSTATUS) %>%</div><div class="crayon-line" id="crayon-60ed954725b73773374804-11">  mutate(pos = (cumsum(n) - (0.5 * n))) %>%</div><div class="crayon-line" id="crayon-60ed954725b73773374804-12">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b73773374804-13">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b73773374804-14"> </div><div class="crayon-line" id="crayon-60ed954725b73773374804-15">ggplot(data = df3.summary,mapping = aes(x = MARITALSTATUS, y = n, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b73773374804-16">  geom_bar(stat = "identity") + </div><div class="crayon-line" id="crayon-60ed954725b73773374804-17">  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +</div><div class="crayon-line" id="crayon-60ed954725b73773374804-18">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b73773374804-19">  labs(title = "MARITALSTATUS VS ABOVE50K",</div><div class="crayon-line" id="crayon-60ed954725b73773374804-20">       x = "MARITALSTATUS", y = "Frequencies") + # Add Title and Labels</div><div class="crayon-line" id="crayon-60ed954725b73773374804-21">  theme(plot.title = element_text(hjust = 0.5)) # Change the appearance of the main title</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-958" src="/wp-content/uploads/2018/08/pic10-1024x928.png" alt="logistic regression" width="960" height="870" srcset="/wp-content/uploads/2018/08/pic10-1024x928.png 1024w,/wp-content/uploads/2018/08/pic10-300x272.png 300w,/wp-content/uploads/2018/08/pic10-768x696.png 768w,/wp-content/uploads/2018/08/pic10-1140x1034.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>2-6. Occupation職業</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b74654678115" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$OCCUPATION)
# ?       Adm-clerical       Armed-Forces       Craft-repair 
# 1843               3770                  9               4099 
# Exec-managerial    Farming-fishing  Handlers-cleaners  Machine-op-inspct 
# 4066                994               1370               2002 
# Other-service    Priv-house-serv     Prof-specialty    Protective-serv 
# 3295                149               4140                649 
# Sales       Tech-support   Transport-moving 
# 3650                928               1597</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b74654678115-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b74654678115-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b74654678115-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b74654678115-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b74654678115-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b74654678115-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b74654678115-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b74654678115-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b74654678115-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b74654678115-1">summary(inputData$OCCUPATION)</div><div class="crayon-line" id="crayon-60ed954725b74654678115-2"># ?       Adm-clerical       Armed-Forces       Craft-repair </div><div class="crayon-line" id="crayon-60ed954725b74654678115-3"># 1843               3770                  9               4099 </div><div class="crayon-line" id="crayon-60ed954725b74654678115-4"># Exec-managerial    Farming-fishing  Handlers-cleaners  Machine-op-inspct </div><div class="crayon-line" id="crayon-60ed954725b74654678115-5"># 4066                994               1370               2002 </div><div class="crayon-line" id="crayon-60ed954725b74654678115-6"># Other-service    Priv-house-serv     Prof-specialty    Protective-serv </div><div class="crayon-line" id="crayon-60ed954725b74654678115-7"># 3295                149               4140                649 </div><div class="crayon-line" id="crayon-60ed954725b74654678115-8"># Sales       Tech-support   Transport-moving </div><div class="crayon-line" id="crayon-60ed954725b74654678115-9"># 3650                928               1597</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>可以發現類別水準值滿複雜的。</p>
<p>次數分配圖</p>

		<div id="crayon-60ed954725b76075884864" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$OCCUPATION <- factor(x = inputData$OCCUPATION,levels = names(sort(table(inputData$OCCUPATION),decreasing = TRUE)))
ggplot(data = inputData, aes(x = OCCUPATION, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b76075884864-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b76075884864-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b76075884864-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b76075884864-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b76075884864-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b76075884864-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b76075884864-1">inputData$OCCUPATION <div class="crayon-line" id="crayon-60ed954725b76075884864-2">ggplot(data = inputData, aes(x = OCCUPATION, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b76075884864-3">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b76075884864-4">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b76075884864-5">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b76075884864-6">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-900" src="/wp-content/uploads/2018/08/pic11-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic11-1024x659.png 1024w,/wp-content/uploads/2018/08/pic11-300x193.png 300w,/wp-content/uploads/2018/08/pic11-768x494.png 768w,/wp-content/uploads/2018/08/pic11-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>各類別水準值中目標變數分佈圖</p>

		<div id="crayon-60ed954725b77452332796" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例
df2 <- cbind.data.frame(OCCUPATION = inputData$OCCUPATION,ABOVE50K = inputData$ABOVE50K)
df2.summary <- 
  df2 %>% group_by(OCCUPATION) %>% 
  count(ABOVE50K) %>% 
  mutate(ratio=scales::percent(n/sum(n))) %>% 
  as.data.frame() %>% 
  ungroup()

# 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例
ggplot(inputData, aes(x = forcats::fct_reorder(f = OCCUPATION, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +
  geom_bar(position = "fill") + 
  geom_text(data=df2.summary, aes(y=n,label=ratio),
            position=position_fill(vjust=0.5)) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette="Paired") +
  labs(x = "OCCUPATION", y = "percentage") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b77452332796-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b77452332796-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b77452332796-1"># 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例</div><div class="crayon-line" id="crayon-60ed954725b77452332796-2">df2 <div class="crayon-line" id="crayon-60ed954725b77452332796-3">df2.summary <div class="crayon-line" id="crayon-60ed954725b77452332796-4">  df2 %>% group_by(OCCUPATION) %>% </div><div class="crayon-line" id="crayon-60ed954725b77452332796-5">  count(ABOVE50K) %>% </div><div class="crayon-line" id="crayon-60ed954725b77452332796-6">  mutate(ratio=scales::percent(n/sum(n))) %>% </div><div class="crayon-line" id="crayon-60ed954725b77452332796-7">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b77452332796-8">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b77452332796-9"> </div><div class="crayon-line" id="crayon-60ed954725b77452332796-10"># 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例</div><div class="crayon-line" id="crayon-60ed954725b77452332796-11">ggplot(inputData, aes(x = forcats::fct_reorder(f = OCCUPATION, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b77452332796-12">  geom_bar(position = "fill") + </div><div class="crayon-line" id="crayon-60ed954725b77452332796-13">  geom_text(data=df2.summary, aes(y=n,label=ratio),</div><div class="crayon-line" id="crayon-60ed954725b77452332796-14">            position=position_fill(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b77452332796-15">  scale_y_continuous(labels = scales::percent) +</div><div class="crayon-line" id="crayon-60ed954725b77452332796-16">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b77452332796-17">  labs(x = "OCCUPATION", y = "percentage") +</div><div class="crayon-line" id="crayon-60ed954725b77452332796-18">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-901" src="/wp-content/uploads/2018/08/pic12-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic12-1024x659.png 1024w,/wp-content/uploads/2018/08/pic12-300x193.png 300w,/wp-content/uploads/2018/08/pic12-768x494.png 768w,/wp-content/uploads/2018/08/pic12-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>如果想要同一張圖y軸可以看到frequency，stacked bar可以看到目標類別水平的比例分佈，可以使用下面方法繪製。</p>

		<div id="crayon-60ed954725b79911345187" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
df3.summary <-
  df2.summary %>%
  group_by(OCCUPATION) %>%
  #因為繪圖資訊是先畫>50K，再畫<=50K，故要調整累積數值計算的順序
  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% 
  ungroup() %>% 
  group_by(OCCUPATION) %>%
  mutate(pos = (cumsum(n) - (0.5 * n))) %>%
  as.data.frame() %>% 
  ungroup()

ggplot(data = df3.summary,mapping = aes(x = OCCUPATION, y = n, fill = ABOVE50K)) +
  geom_bar(stat = "identity") + 
  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +
  scale_fill_brewer(palette="Paired") +
  labs(title = "OCCUPATION VS ABOVE50K",
       x = "OCCUPATION", y = "Frequencies") + # Add Title and Labels
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b79911345187-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b79911345187-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b79911345187-1">df3.summary <div class="crayon-line" id="crayon-60ed954725b79911345187-2">  df2.summary %>%</div><div class="crayon-line" id="crayon-60ed954725b79911345187-3">  group_by(OCCUPATION) %>%</div><div class="crayon-line" id="crayon-60ed954725b79911345187-4">  #因為繪圖資訊是先畫>50K，再畫<div class="crayon-line" id="crayon-60ed954725b79911345187-5">  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% </div><div class="crayon-line" id="crayon-60ed954725b79911345187-6">  ungroup() %>% </div><div class="crayon-line" id="crayon-60ed954725b79911345187-7">  group_by(OCCUPATION) %>%</div><div class="crayon-line" id="crayon-60ed954725b79911345187-8">  mutate(pos = (cumsum(n) - (0.5 * n))) %>%</div><div class="crayon-line" id="crayon-60ed954725b79911345187-9">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b79911345187-10">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b79911345187-11"> </div><div class="crayon-line" id="crayon-60ed954725b79911345187-12">ggplot(data = df3.summary,mapping = aes(x = OCCUPATION, y = n, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b79911345187-13">  geom_bar(stat = "identity") + </div><div class="crayon-line" id="crayon-60ed954725b79911345187-14">  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +</div><div class="crayon-line" id="crayon-60ed954725b79911345187-15">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b79911345187-16">  labs(title = "OCCUPATION VS ABOVE50K",</div><div class="crayon-line" id="crayon-60ed954725b79911345187-17">       x = "OCCUPATION", y = "Frequencies") + # Add Title and Labels</div><div class="crayon-line" id="crayon-60ed954725b79911345187-18">  theme(plot.title = element_text(hjust = 0.5),</div><div class="crayon-line" id="crayon-60ed954725b79911345187-19">        axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-902" src="/wp-content/uploads/2018/08/pic13-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic13-1024x659.png 1024w,/wp-content/uploads/2018/08/pic13-300x193.png 300w,/wp-content/uploads/2018/08/pic13-768x494.png 768w,/wp-content/uploads/2018/08/pic13-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>2-7. Relationship</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b7a029758700" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$RELATIONSHIP)
# Husband   Not-in-family  Other-relative       Own-child       Unmarried 
# 13193            8305             981            5068            3446 
# Wife 
# 1568</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b7a029758700-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b7a029758700-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b7a029758700-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b7a029758700-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b7a029758700-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b7a029758700-1">summary(inputData$RELATIONSHIP)</div><div class="crayon-line" id="crayon-60ed954725b7a029758700-2"># Husband   Not-in-family  Other-relative       Own-child       Unmarried </div><div class="crayon-line" id="crayon-60ed954725b7a029758700-3"># 13193            8305             981            5068            3446 </div><div class="crayon-line" id="crayon-60ed954725b7a029758700-4"># Wife </div><div class="crayon-line" id="crayon-60ed954725b7a029758700-5"># 1568</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>次數分配圖</p>

		<div id="crayon-60ed954725b7b603350130" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$RELATIONSHIP <- factor(x = inputData$RELATIONSHIP,levels = names(sort(table(inputData$RELATIONSHIP),decreasing = TRUE)))
ggplot(data = inputData, aes(x = RELATIONSHIP, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b7b603350130-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b7b603350130-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b7b603350130-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b7b603350130-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b7b603350130-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b7b603350130-1">inputData$RELATIONSHIP <div class="crayon-line" id="crayon-60ed954725b7b603350130-2">ggplot(data = inputData, aes(x = RELATIONSHIP, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b7b603350130-3">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b7b603350130-4">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b7b603350130-5">  scale_fill_brewer(palette="Paired")</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-903" src="/wp-content/uploads/2018/08/pic14-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic14-1024x659.png 1024w,/wp-content/uploads/2018/08/pic14-300x193.png 300w,/wp-content/uploads/2018/08/pic14-768x494.png 768w,/wp-content/uploads/2018/08/pic14-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>各類別水準值中目標變數分佈圖</p>

		<div id="crayon-60ed954725b7c206945498" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例
df2 <- cbind.data.frame(RELATIONSHIP = inputData$RELATIONSHIP,ABOVE50K = inputData$ABOVE50K)
df2.summary <- 
  df2 %>% group_by(RELATIONSHIP) %>% 
  count(ABOVE50K) %>% 
  mutate(ratio=scales::percent(n/sum(n))) %>% 
  as.data.frame() %>% 
  ungroup()

# 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例
ggplot(inputData, aes(x = forcats::fct_reorder(f = RELATIONSHIP, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +
  geom_bar(position = "fill") + 
  geom_text(data=df2.summary, aes(y=n,label=ratio),
            position=position_fill(vjust=0.5)) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette="Paired") +
  labs(x = "RELATIONSHIP", y = "percentage") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b7c206945498-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b7c206945498-1"># 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-2">df2 <div class="crayon-line" id="crayon-60ed954725b7c206945498-3">df2.summary <div class="crayon-line" id="crayon-60ed954725b7c206945498-4">  df2 %>% group_by(RELATIONSHIP) %>% </div><div class="crayon-line" id="crayon-60ed954725b7c206945498-5">  count(ABOVE50K) %>% </div><div class="crayon-line" id="crayon-60ed954725b7c206945498-6">  mutate(ratio=scales::percent(n/sum(n))) %>% </div><div class="crayon-line" id="crayon-60ed954725b7c206945498-7">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b7c206945498-8">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-9"> </div><div class="crayon-line" id="crayon-60ed954725b7c206945498-10"># 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-11">ggplot(inputData, aes(x = forcats::fct_reorder(f = RELATIONSHIP, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-12">  geom_bar(position = "fill") + </div><div class="crayon-line" id="crayon-60ed954725b7c206945498-13">  geom_text(data=df2.summary, aes(y=n,label=ratio),</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-14">            position=position_fill(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-15">  scale_y_continuous(labels = scales::percent) +</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-16">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-17">  labs(x = "RELATIONSHIP", y = "percentage") +</div><div class="crayon-line" id="crayon-60ed954725b7c206945498-18">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-904" src="/wp-content/uploads/2018/08/pic15-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic15-1024x659.png 1024w,/wp-content/uploads/2018/08/pic15-300x193.png 300w,/wp-content/uploads/2018/08/pic15-768x494.png 768w,/wp-content/uploads/2018/08/pic15-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>繪製同時一張圖呈現frequency與stacked bar目標類別水平的比例分佈圖。</p>

		<div id="crayon-60ed954725b7e029848236" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
df3.summary <-
  df2.summary %>%
  group_by(RELATIONSHIP) %>%
  #因為繪圖資訊是先畫>50K，再畫<=50K，故要調整累積數值計算的順序
  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% 
  ungroup() %>% 
  group_by(RELATIONSHIP) %>%
  mutate(pos = (cumsum(n) - (0.5 * n))) %>%
  as.data.frame() %>% 
  ungroup()

ggplot(data = df3.summary,mapping = aes(x = RELATIONSHIP, y = n, fill = ABOVE50K)) +
  geom_bar(stat = "identity") + 
  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +
  scale_fill_brewer(palette="Paired") +
  labs(title = "RELATIONSHIP VS ABOVE50K",
       x = "RELATIONSHIP", y = "Frequencies") + # Add Title and Labels
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 30, hjust = 1)) # Change the appearance of the main title</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b7e029848236-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b7e029848236-1">df3.summary <div class="crayon-line" id="crayon-60ed954725b7e029848236-2">  df2.summary %>%</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-3">  group_by(RELATIONSHIP) %>%</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-4">  #因為繪圖資訊是先畫>50K，再畫<div class="crayon-line" id="crayon-60ed954725b7e029848236-5">  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% </div><div class="crayon-line" id="crayon-60ed954725b7e029848236-6">  ungroup() %>% </div><div class="crayon-line" id="crayon-60ed954725b7e029848236-7">  group_by(RELATIONSHIP) %>%</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-8">  mutate(pos = (cumsum(n) - (0.5 * n))) %>%</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-9">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b7e029848236-10">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-11"> </div><div class="crayon-line" id="crayon-60ed954725b7e029848236-12">ggplot(data = df3.summary,mapping = aes(x = RELATIONSHIP, y = n, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-13">  geom_bar(stat = "identity") + </div><div class="crayon-line" id="crayon-60ed954725b7e029848236-14">  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-15">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-16">  labs(title = "RELATIONSHIP VS ABOVE50K",</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-17">       x = "RELATIONSHIP", y = "Frequencies") + # Add Title and Labels</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-18">  theme(plot.title = element_text(hjust = 0.5),</div><div class="crayon-line" id="crayon-60ed954725b7e029848236-19">        axis.text.x = element_text(angle = 30, hjust = 1)) # Change the appearance of the main title</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-905" src="/wp-content/uploads/2018/08/pic16-1024x659.png" alt="logistic regression" width="960" height="618" srcset="/wp-content/uploads/2018/08/pic16-1024x659.png 1024w,/wp-content/uploads/2018/08/pic16-300x193.png 300w,/wp-content/uploads/2018/08/pic16-768x494.png 768w,/wp-content/uploads/2018/08/pic16-1140x734.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>2-8. Race種族</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b7f588207235" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$RACE)
# Amer-Indian-Eskimo  Asian-Pac-Islander               Black               Other               White 
# 311                1039                3124                 271               27816</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b7f588207235-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b7f588207235-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b7f588207235-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b7f588207235-1">summary(inputData$RACE)</div><div class="crayon-line" id="crayon-60ed954725b7f588207235-2"># Amer-Indian-Eskimo  Asian-Pac-Islander               Black               Other               White </div><div class="crayon-line" id="crayon-60ed954725b7f588207235-3"># 311                1039                3124                 271               27816</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>次數分配圖</p>

		<div id="crayon-60ed954725b80830362486" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$RACE <- factor(x = inputData$RACE,levels = names(sort(table(inputData$RACE),decreasing = TRUE)))
ggplot(data = inputData, aes(x = RACE, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b80830362486-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b80830362486-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b80830362486-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b80830362486-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b80830362486-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b80830362486-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b80830362486-1">inputData$RACE <div class="crayon-line" id="crayon-60ed954725b80830362486-2">ggplot(data = inputData, aes(x = RACE, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b80830362486-3">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b80830362486-4">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b80830362486-5">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b80830362486-6">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-906" src="/wp-content/uploads/2018/08/pic17-1024x933.png" alt="logistic regression" width="960" height="875" srcset="/wp-content/uploads/2018/08/pic17-1024x933.png 1024w,/wp-content/uploads/2018/08/pic17-300x273.png 300w,/wp-content/uploads/2018/08/pic17-768x700.png 768w,/wp-content/uploads/2018/08/pic17-1140x1039.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>各類別水準值中目標變數分佈圖</p>

		<div id="crayon-60ed954725b81714543464" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例
df2 <- cbind.data.frame(RACE = inputData$RACE,ABOVE50K = inputData$ABOVE50K)
df2.summary <- 
  df2 %>% group_by(RACE) %>% 
  count(ABOVE50K) %>% 
  mutate(ratio=scales::percent(n/sum(n))) %>% 
  as.data.frame() %>% 
  ungroup()

# 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例
ggplot(inputData, aes(x = forcats::fct_reorder(f = RACE, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +
  geom_bar(position = "fill") + 
  geom_text(data=df2.summary, aes(y=n,label=ratio),
            position=position_fill(vjust=0.5)) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette="Paired") +
  labs(x = "RACE", y = "percentage") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b81714543464-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b81714543464-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b81714543464-1"># 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例</div><div class="crayon-line" id="crayon-60ed954725b81714543464-2">df2 <div class="crayon-line" id="crayon-60ed954725b81714543464-3">df2.summary <div class="crayon-line" id="crayon-60ed954725b81714543464-4">  df2 %>% group_by(RACE) %>% </div><div class="crayon-line" id="crayon-60ed954725b81714543464-5">  count(ABOVE50K) %>% </div><div class="crayon-line" id="crayon-60ed954725b81714543464-6">  mutate(ratio=scales::percent(n/sum(n))) %>% </div><div class="crayon-line" id="crayon-60ed954725b81714543464-7">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b81714543464-8">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b81714543464-9"> </div><div class="crayon-line" id="crayon-60ed954725b81714543464-10"># 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例</div><div class="crayon-line" id="crayon-60ed954725b81714543464-11">ggplot(inputData, aes(x = forcats::fct_reorder(f = RACE, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b81714543464-12">  geom_bar(position = "fill") + </div><div class="crayon-line" id="crayon-60ed954725b81714543464-13">  geom_text(data=df2.summary, aes(y=n,label=ratio),</div><div class="crayon-line" id="crayon-60ed954725b81714543464-14">            position=position_fill(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b81714543464-15">  scale_y_continuous(labels = scales::percent) +</div><div class="crayon-line" id="crayon-60ed954725b81714543464-16">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b81714543464-17">  labs(x = "RACE", y = "percentage") +</div><div class="crayon-line" id="crayon-60ed954725b81714543464-18">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-1581" src="/wp-content/uploads/2018/09/pic18-1-1024x928.png" alt="logistic regression" width="1024" height="928" srcset="/wp-content/uploads/2018/09/pic18-1-1024x928.png 1024w,/wp-content/uploads/2018/09/pic18-1-300x272.png 300w,/wp-content/uploads/2018/09/pic18-1-768x696.png 768w,/wp-content/uploads/2018/09/pic18-1-830x753.png 830w,/wp-content/uploads/2018/09/pic18-1-230x209.png 230w,/wp-content/uploads/2018/09/pic18-1-350x317.png 350w,/wp-content/uploads/2018/09/pic18-1-480x435.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>繪製同時一張圖呈現frequency與stacked bar目標類別水平的比例分佈圖。</p>

		<div id="crayon-60ed954725b83911187553" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
df3.summary <-
  df2.summary %>%
  group_by(RACE) %>%
  #因為繪圖資訊是先畫>50K，再畫<=50K，故要調整累積數值計算的順序
  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% 
  ungroup() %>% 
  group_by(RACE) %>%
  mutate(pos = (cumsum(n) - (0.5 * n))) %>%
  as.data.frame() %>% 
  ungroup()

ggplot(data = df3.summary,mapping = aes(x = RACE, y = n, fill = ABOVE50K)) +
  geom_bar(stat = "identity") + 
  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +
  scale_fill_brewer(palette="Paired") +
  labs(title = "RACE VS ABOVE50K",
       x = "RACE", y = "Frequencies") + # Add Title and Labels
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 30, hjust = 1)) # Change the appearance of the main title</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b83911187553-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b83911187553-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b83911187553-1">df3.summary <div class="crayon-line" id="crayon-60ed954725b83911187553-2">  df2.summary %>%</div><div class="crayon-line" id="crayon-60ed954725b83911187553-3">  group_by(RACE) %>%</div><div class="crayon-line" id="crayon-60ed954725b83911187553-4">  #因為繪圖資訊是先畫>50K，再畫<div class="crayon-line" id="crayon-60ed954725b83911187553-5">  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% </div><div class="crayon-line" id="crayon-60ed954725b83911187553-6">  ungroup() %>% </div><div class="crayon-line" id="crayon-60ed954725b83911187553-7">  group_by(RACE) %>%</div><div class="crayon-line" id="crayon-60ed954725b83911187553-8">  mutate(pos = (cumsum(n) - (0.5 * n))) %>%</div><div class="crayon-line" id="crayon-60ed954725b83911187553-9">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b83911187553-10">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b83911187553-11"> </div><div class="crayon-line" id="crayon-60ed954725b83911187553-12">ggplot(data = df3.summary,mapping = aes(x = RACE, y = n, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b83911187553-13">  geom_bar(stat = "identity") + </div><div class="crayon-line" id="crayon-60ed954725b83911187553-14">  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +</div><div class="crayon-line" id="crayon-60ed954725b83911187553-15">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b83911187553-16">  labs(title = "RACE VS ABOVE50K",</div><div class="crayon-line" id="crayon-60ed954725b83911187553-17">       x = "RACE", y = "Frequencies") + # Add Title and Labels</div><div class="crayon-line" id="crayon-60ed954725b83911187553-18">  theme(plot.title = element_text(hjust = 0.5),</div><div class="crayon-line" id="crayon-60ed954725b83911187553-19">        axis.text.x = element_text(angle = 30, hjust = 1)) # Change the appearance of the main title</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-1572" src="/wp-content/uploads/2018/09/pic19-1024x602.png" alt="logistic regression" width="1024" height="602" srcset="/wp-content/uploads/2018/09/pic19-1024x602.png 1024w,/wp-content/uploads/2018/09/pic19-300x176.png 300w,/wp-content/uploads/2018/09/pic19-768x451.png 768w,/wp-content/uploads/2018/09/pic19-830x488.png 830w,/wp-content/uploads/2018/09/pic19-230x135.png 230w,/wp-content/uploads/2018/09/pic19-350x206.png 350w,/wp-content/uploads/2018/09/pic19-480x282.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>2-9. Sex 性別</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b84223682032" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$SEX)
# Female    Male 
# 10771   21790</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b84223682032-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b84223682032-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b84223682032-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b84223682032-1">summary(inputData$SEX)</div><div class="crayon-line" id="crayon-60ed954725b84223682032-2"># Female    Male </div><div class="crayon-line" id="crayon-60ed954725b84223682032-3"># 10771   21790</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>次數分配圖</p>

		<div id="crayon-60ed954725b85285407154" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$SEX <- factor(x = inputData$SEX,levels = names(sort(table(inputData$SEX),decreasing = TRUE)))
ggplot(data = inputData, aes(x = SEX, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b85285407154-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b85285407154-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b85285407154-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b85285407154-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b85285407154-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b85285407154-1">inputData$SEX <div class="crayon-line" id="crayon-60ed954725b85285407154-2">ggplot(data = inputData, aes(x = SEX, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b85285407154-3">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b85285407154-4">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b85285407154-5">  scale_fill_brewer(palette="Paired")</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-1574" src="/wp-content/uploads/2018/09/pic20-1024x602.png" alt="logistic regression" width="1024" height="602" srcset="/wp-content/uploads/2018/09/pic20-1024x602.png 1024w,/wp-content/uploads/2018/09/pic20-300x176.png 300w,/wp-content/uploads/2018/09/pic20-768x451.png 768w,/wp-content/uploads/2018/09/pic20-830x488.png 830w,/wp-content/uploads/2018/09/pic20-230x135.png 230w,/wp-content/uploads/2018/09/pic20-350x206.png 350w,/wp-content/uploads/2018/09/pic20-480x282.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>各類別水準值中目標變數分佈圖</p>

		<div id="crayon-60ed954725b86884508213" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例
df2 <- cbind.data.frame(SEX = inputData$SEX,ABOVE50K = inputData$ABOVE50K)
df2.summary <- 
  df2 %>% group_by(SEX) %>% 
  count(ABOVE50K) %>% 
  mutate(ratio=scales::percent(n/sum(n))) %>% 
  as.data.frame() %>% 
  ungroup()

# 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例
ggplot(inputData, aes(x = forcats::fct_reorder(f = SEX, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +
  geom_bar(position = "fill") + 
  geom_text(data=df2.summary, aes(y=n,label=ratio),
            position=position_fill(vjust=0.5)) +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_brewer(palette="Paired") +
  labs(x = "SEX", y = "percentage") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b86884508213-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b86884508213-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b86884508213-1"># 首先，先計算類別變數中，不同類別水準值中的薪資水平分佈比例</div><div class="crayon-line" id="crayon-60ed954725b86884508213-2">df2 <div class="crayon-line" id="crayon-60ed954725b86884508213-3">df2.summary <div class="crayon-line" id="crayon-60ed954725b86884508213-4">  df2 %>% group_by(SEX) %>% </div><div class="crayon-line" id="crayon-60ed954725b86884508213-5">  count(ABOVE50K) %>% </div><div class="crayon-line" id="crayon-60ed954725b86884508213-6">  mutate(ratio=scales::percent(n/sum(n))) %>% </div><div class="crayon-line" id="crayon-60ed954725b86884508213-7">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b86884508213-8">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b86884508213-9"> </div><div class="crayon-line" id="crayon-60ed954725b86884508213-10"># 依據ABOVE50K的比例排序，更可以看出哪些類別水準有較高ABOVE50K比例</div><div class="crayon-line" id="crayon-60ed954725b86884508213-11">ggplot(inputData, aes(x = forcats::fct_reorder(f = SEX, x = as.numeric(ABOVE50K), fun = mean, .desc = TRUE), fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b86884508213-12">  geom_bar(position = "fill") + </div><div class="crayon-line" id="crayon-60ed954725b86884508213-13">  geom_text(data=df2.summary, aes(y=n,label=ratio),</div><div class="crayon-line" id="crayon-60ed954725b86884508213-14">            position=position_fill(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b86884508213-15">  scale_y_continuous(labels = scales::percent) +</div><div class="crayon-line" id="crayon-60ed954725b86884508213-16">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b86884508213-17">  labs(x = "SEX", y = "percentage") +</div><div class="crayon-line" id="crayon-60ed954725b86884508213-18">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-1575" src="/wp-content/uploads/2018/09/pic21-1024x602.png" alt="logistic regression" width="1024" height="602" srcset="/wp-content/uploads/2018/09/pic21-1024x602.png 1024w,/wp-content/uploads/2018/09/pic21-300x176.png 300w,/wp-content/uploads/2018/09/pic21-768x451.png 768w,/wp-content/uploads/2018/09/pic21-830x488.png 830w,/wp-content/uploads/2018/09/pic21-230x135.png 230w,/wp-content/uploads/2018/09/pic21-350x206.png 350w,/wp-content/uploads/2018/09/pic21-480x282.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>繪製同時一張圖呈現frequency與stacked bar目標類別水平的比例分佈圖。</p>

		<div id="crayon-60ed954725b88546723192" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
df3.summary <-
  df2.summary %>%
  group_by(SEX) %>%
  #因為繪圖資訊是先畫>50K，再畫<=50K，故要調整累積數值計算的順序
  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% 
  ungroup() %>% 
  group_by(SEX) %>%
  mutate(pos = (cumsum(n) - (0.5 * n))) %>%
  as.data.frame() %>% 
  ungroup()

ggplot(data = df3.summary,mapping = aes(x = SEX, y = n, fill = ABOVE50K)) +
  geom_bar(stat = "identity") + 
  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +
  scale_fill_brewer(palette="Paired") +
  labs(title = "SEX VS ABOVE50K",
       x = "SEX", y = "Frequencies") + # Add Title and Labels
  theme(plot.title = element_text(hjust = 0.5),
        axis.text.x = element_text(angle = 30, hjust = 1)) # Change the appearance of the main title</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b88546723192-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b88546723192-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b88546723192-1">df3.summary <div class="crayon-line" id="crayon-60ed954725b88546723192-2">  df2.summary %>%</div><div class="crayon-line" id="crayon-60ed954725b88546723192-3">  group_by(SEX) %>%</div><div class="crayon-line" id="crayon-60ed954725b88546723192-4">  #因為繪圖資訊是先畫>50K，再畫<div class="crayon-line" id="crayon-60ed954725b88546723192-5">  do( data.frame(with(data=., .[order(desc(ABOVE50K)),] )) ) %>% </div><div class="crayon-line" id="crayon-60ed954725b88546723192-6">  ungroup() %>% </div><div class="crayon-line" id="crayon-60ed954725b88546723192-7">  group_by(SEX) %>%</div><div class="crayon-line" id="crayon-60ed954725b88546723192-8">  mutate(pos = (cumsum(n) - (0.5 * n))) %>%</div><div class="crayon-line" id="crayon-60ed954725b88546723192-9">  as.data.frame() %>% </div><div class="crayon-line" id="crayon-60ed954725b88546723192-10">  ungroup()</div><div class="crayon-line" id="crayon-60ed954725b88546723192-11"> </div><div class="crayon-line" id="crayon-60ed954725b88546723192-12">ggplot(data = df3.summary,mapping = aes(x = SEX, y = n, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b88546723192-13">  geom_bar(stat = "identity") + </div><div class="crayon-line" id="crayon-60ed954725b88546723192-14">  geom_text(mapping = aes(y = pos, label = ratio), size = 3) +</div><div class="crayon-line" id="crayon-60ed954725b88546723192-15">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b88546723192-16">  labs(title = "SEX VS ABOVE50K",</div><div class="crayon-line" id="crayon-60ed954725b88546723192-17">       x = "SEX", y = "Frequencies") + # Add Title and Labels</div><div class="crayon-line" id="crayon-60ed954725b88546723192-18">  theme(plot.title = element_text(hjust = 0.5),</div><div class="crayon-line" id="crayon-60ed954725b88546723192-19">        axis.text.x = element_text(angle = 30, hjust = 1)) # Change the appearance of the main title</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p> </p>
<p><img loading="lazy" class="alignnone size-large wp-image-1576" src="/wp-content/uploads/2018/09/pic22-1024x602.png" alt="logistic regression" width="1024" height="602" srcset="/wp-content/uploads/2018/09/pic22-1024x602.png 1024w,/wp-content/uploads/2018/09/pic22-300x176.png 300w,/wp-content/uploads/2018/09/pic22-768x451.png 768w,/wp-content/uploads/2018/09/pic22-830x488.png 830w,/wp-content/uploads/2018/09/pic22-230x135.png 230w,/wp-content/uploads/2018/09/pic22-350x206.png 350w,/wp-content/uploads/2018/09/pic22-480x282.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>2-10. CapitalGain 資本獲利</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b89288213892" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$CAPITALGAIN)
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 0       0       0    1078       0   99999</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b89288213892-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b89288213892-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b89288213892-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b89288213892-1">summary(inputData$CAPITALGAIN)</div><div class="crayon-line" id="crayon-60ed954725b89288213892-2"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </div><div class="crayon-line" id="crayon-60ed954725b89288213892-3"># 0       0       0    1078       0   99999</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>可以發現資料很右偏，至少有75％(第三個四分位數)的資料都是0。</p>
<p>次數分配圖</p>

		<div id="crayon-60ed954725b8a609759015" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
ggplot(data = inputData,mapping = aes(x = CAPITALGAIN, fill = ABOVE50K, group = ABOVE50K)) +
  geom_histogram(bins = 10,color = 'black',lwd =0.3, binwidth = 10000) +  # default bins = 30
  stat_bin(binwidth = 10000, geom = "text", color = "white", size = 3.5,
           mapping = aes(label = ..count.., group = ABOVE50K),position=position_stack(vjust=0.5)) +
  scale_fill_brewer(palette="Paired") +
  scale_x_continuous(breaks= seq(0,max(inputData$CAPITALGAIN), 10000))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b8a609759015-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b8a609759015-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b8a609759015-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b8a609759015-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b8a609759015-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b8a609759015-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b8a609759015-1">ggplot(data = inputData,mapping = aes(x = CAPITALGAIN, fill = ABOVE50K, group = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b8a609759015-2">  geom_histogram(bins = 10,color = 'black',lwd =0.3, binwidth = 10000) +  # default bins = 30</div><div class="crayon-line" id="crayon-60ed954725b8a609759015-3">  stat_bin(binwidth = 10000, geom = "text", color = "white", size = 3.5,</div><div class="crayon-line" id="crayon-60ed954725b8a609759015-4">           mapping = aes(label = ..count.., group = ABOVE50K),position=position_stack(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b8a609759015-5">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b8a609759015-6">  scale_x_continuous(breaks= seq(0,max(inputData$CAPITALGAIN), 10000))</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>我們可以觀察到，視覺化的資料極右偏，幾乎所有資料都是0</p>
<p><img loading="lazy" class="alignnone size-large wp-image-1577" src="/wp-content/uploads/2018/09/pic23-1024x602.png" alt="logistic regression" width="1024" height="602" srcset="/wp-content/uploads/2018/09/pic23-1024x602.png 1024w,/wp-content/uploads/2018/09/pic23-300x176.png 300w,/wp-content/uploads/2018/09/pic23-768x451.png 768w,/wp-content/uploads/2018/09/pic23-830x488.png 830w,/wp-content/uploads/2018/09/pic23-230x135.png 230w,/wp-content/uploads/2018/09/pic23-350x206.png 350w,/wp-content/uploads/2018/09/pic23-480x282.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>看一下capitalgain資料是0的比例：</p>

		<div id="crayon-60ed954725b8b994321288" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
sum(inputData$CAPITALGAIN == 0)/length(inputData$CAPITALGAIN)
# [1] 0.9167102</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b8b994321288-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b8b994321288-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b8b994321288-1">sum(inputData$CAPITALGAIN == 0)/length(inputData$CAPITALGAIN)</div><div class="crayon-line" id="crayon-60ed954725b8b994321288-2"># [1] 0.9167102</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>2-11. Capital Loss 資本失利</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b8d547149974" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$CAPITALLOSS)
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 0.0     0.0     0.0    87.3     0.0  4356.0</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b8d547149974-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b8d547149974-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b8d547149974-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b8d547149974-1">summary(inputData$CAPITALLOSS)</div><div class="crayon-line" id="crayon-60ed954725b8d547149974-2"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </div><div class="crayon-line" id="crayon-60ed954725b8d547149974-3"># 0.0     0.0     0.0    87.3     0.0  4356.0</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>次數分配圖</p>

		<div id="crayon-60ed954725b8e966507867" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
ggplot(data = inputData,mapping = aes(x = CAPITALLOSS, fill = ABOVE50K, group = ABOVE50K)) +
  geom_histogram(color = 'black',lwd =0.3, binwidth = 1000) +  # default bins = 30
  stat_bin(geom = "text", color = "white", size = 3.5, binwidth = 1000,
           mapping = aes(label = ..count.., group = ABOVE50K),position=position_stack(vjust=0.5)) +
  scale_fill_brewer(palette="Paired")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b8e966507867-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b8e966507867-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b8e966507867-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b8e966507867-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b8e966507867-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b8e966507867-1">ggplot(data = inputData,mapping = aes(x = CAPITALLOSS, fill = ABOVE50K, group = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b8e966507867-2">  geom_histogram(color = 'black',lwd =0.3, binwidth = 1000) +  # default bins = 30</div><div class="crayon-line" id="crayon-60ed954725b8e966507867-3">  stat_bin(geom = "text", color = "white", size = 3.5, binwidth = 1000,</div><div class="crayon-line" id="crayon-60ed954725b8e966507867-4">           mapping = aes(label = ..count.., group = ABOVE50K),position=position_stack(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b8e966507867-5">  scale_fill_brewer(palette="Paired")</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-1578" src="/wp-content/uploads/2018/09/pic24-1024x602.png" alt="logistic regression" width="1024" height="602" srcset="/wp-content/uploads/2018/09/pic24-1024x602.png 1024w,/wp-content/uploads/2018/09/pic24-300x176.png 300w,/wp-content/uploads/2018/09/pic24-768x451.png 768w,/wp-content/uploads/2018/09/pic24-830x488.png 830w,/wp-content/uploads/2018/09/pic24-230x135.png 230w,/wp-content/uploads/2018/09/pic24-350x206.png 350w,/wp-content/uploads/2018/09/pic24-480x282.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>看一下CAPITALLOSS資料是0的比例：</p>

		<div id="crayon-60ed954725b8f172289823" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
sum(inputData$CAPITALLOSS == 0)/length(inputData$CAPITALLOSS)
# [1] 0.9533491</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b8f172289823-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b8f172289823-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b8f172289823-1">sum(inputData$CAPITALLOSS == 0)/length(inputData$CAPITALLOSS)</div><div class="crayon-line" id="crayon-60ed954725b8f172289823-2"># [1] 0.9533491</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>2-12. HOURSPERWEEK</p>
<p>基礎敘述統計</p>

		<div id="crayon-60ed954725b90071787383" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
summary(inputData$HOURSPERWEEK)
# Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
# 1.00   40.00   40.00   40.44   45.00   99.00</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b90071787383-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b90071787383-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b90071787383-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b90071787383-1">summary(inputData$HOURSPERWEEK)</div><div class="crayon-line" id="crayon-60ed954725b90071787383-2"># Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </div><div class="crayon-line" id="crayon-60ed954725b90071787383-3"># 1.00   40.00   40.00   40.44   45.00   99.00</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>次數分配圖</p>

		<div id="crayon-60ed954725b91990020144" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
ggplot(data = inputData,mapping = aes(x = HOURSPERWEEK, fill = ABOVE50K, group = ABOVE50K)) +
  geom_histogram(bins = 10, color = 'black',lwd =0.3) +  # default bins = 30
  stat_bin(geom = "text", color = "white", size = 3.5, bins = 10,
           mapping = aes(label = ..count.., group = ABOVE50K),position=position_stack(vjust=0.5)) +
  scale_fill_brewer(palette="Paired")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b91990020144-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b91990020144-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b91990020144-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b91990020144-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b91990020144-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b91990020144-1">ggplot(data = inputData,mapping = aes(x = HOURSPERWEEK, fill = ABOVE50K, group = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b91990020144-2">  geom_histogram(bins = 10, color = 'black',lwd =0.3) +  # default bins = 30</div><div class="crayon-line" id="crayon-60ed954725b91990020144-3">  stat_bin(geom = "text", color = "white", size = 3.5, bins = 10,</div><div class="crayon-line" id="crayon-60ed954725b91990020144-4">           mapping = aes(label = ..count.., group = ABOVE50K),position=position_stack(vjust=0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b91990020144-5">  scale_fill_brewer(palette="Paired")</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-1579" src="/wp-content/uploads/2018/09/pic25-1024x602.png" alt="logistic regression" width="1024" height="602" srcset="/wp-content/uploads/2018/09/pic25-1024x602.png 1024w,/wp-content/uploads/2018/09/pic25-300x176.png 300w,/wp-content/uploads/2018/09/pic25-768x451.png 768w,/wp-content/uploads/2018/09/pic25-830x488.png 830w,/wp-content/uploads/2018/09/pic25-230x135.png 230w,/wp-content/uploads/2018/09/pic25-350x206.png 350w,/wp-content/uploads/2018/09/pic25-480x282.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p>2-13. NATIVECOUNTRY 國籍</p>
<p>次數分配圖</p>

		<div id="crayon-60ed954725b93360506771" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
inputData$NATIVECOUNTRY <- factor(x = inputData$NATIVECOUNTRY,levels = names(sort(table(inputData$NATIVECOUNTRY),decreasing = TRUE)))
ggplot(data = inputData, aes(x = NATIVECOUNTRY, fill = ABOVE50K)) +
  geom_bar() +
  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette="Paired") +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b93360506771-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b93360506771-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b93360506771-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b93360506771-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b93360506771-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b93360506771-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b93360506771-1">inputData$NATIVECOUNTRY <div class="crayon-line" id="crayon-60ed954725b93360506771-2">ggplot(data = inputData, aes(x = NATIVECOUNTRY, fill = ABOVE50K)) +</div><div class="crayon-line" id="crayon-60ed954725b93360506771-3">  geom_bar() +</div><div class="crayon-line" id="crayon-60ed954725b93360506771-4">  geom_text(stat = "count", aes(label=..count..),size=3.5,position = position_stack(vjust = 0.5)) +</div><div class="crayon-line" id="crayon-60ed954725b93360506771-5">  scale_fill_brewer(palette="Paired") +</div><div class="crayon-line" id="crayon-60ed954725b93360506771-6">  theme(axis.text.x = element_text(angle = 30, hjust = 1))</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-1580" src="/wp-content/uploads/2018/09/pic26-1024x602.png" alt="logistic regression" width="1024" height="602" srcset="/wp-content/uploads/2018/09/pic26-1024x602.png 1024w,/wp-content/uploads/2018/09/pic26-300x176.png 300w,/wp-content/uploads/2018/09/pic26-768x451.png 768w,/wp-content/uploads/2018/09/pic26-830x488.png 830w,/wp-content/uploads/2018/09/pic26-230x135.png 230w,/wp-content/uploads/2018/09/pic26-350x206.png 350w,/wp-content/uploads/2018/09/pic26-480x282.png 480w" sizes="(max-width: 1024px) 100vw, 1024px"></p>
<p><span style="color: #9d6ad4;">可以發現資料超偏，都集中在美國，因此不適合投入模型</span>。</p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<h3>3. 資料前處理</h3>
<p>3- 1. 類別水準值簡化</p>
<p>OCCUPATION的部分，因為水平值偏多，且沒有替代變數欄位，故我們考慮將此變數水平值簡化。我們將之簡化為以下幾群：<br>
Blue-Collar, Professional, Sales, Service, and White-Collar, Other/Unknown。</p>

		<div id="crayon-60ed954725b94195805712" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 先將?改命名成Unknown
levels(inputData$OCCUPATION)[1] <- "Unknown"

# 新增一個replacement水準值後的欄位：
inputData$OCCUPATION_rep <- inputData$OCCUPATION

# (1) Craft-repair, Farming-fishing, Handlers-cleaners , Machine-op-inspct, Transport-moving => 合併成Blue-Collar
inputData$OCCUPATION_rep <- gsub(pattern = '^ Craft-repair', replacement = 'Blue-Collar', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Farming-fishing', replacement = 'Blue-Collar', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Handlers-cleaners', replacement = 'Blue-Collar', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Machine-op-inspct', replacement = 'Blue-Collar', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Transport-moving', replacement = 'Blue-Collar', x = inputData$OCCUPATION_rep)

# (2) Prof-specialty, => Professional
inputData$OCCUPATION_rep <- gsub(pattern = '^ Prof-specialty', replacement = 'Professional', x = inputData$OCCUPATION_rep)

# (3) Sales => Sales不變

# (4) Other-service, Priv-house-serv, Protective-serv, Tech-support, => Service
inputData$OCCUPATION_rep <- gsub(pattern = '^ Other-service', replacement = 'Service', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Priv-house-serv', replacement = 'Service', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Protective-serv', replacement = 'Service', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Tech-support', replacement = 'Service', x = inputData$OCCUPATION_rep)

# (5) Adm-clerical, Exec-managerial => 合併成White-Collar
inputData$OCCUPATION_rep <- gsub(pattern = '^ Adm-clerical', replacement = 'White-Collar', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Exec-managerial', replacement = 'White-Collar', x = inputData$OCCUPATION_rep)
# (6) ?,Armed-Forces => Other/Unknown
inputData$OCCUPATION_rep <- gsub(pattern = '^Unknown', replacement = 'Other/Unknown', x = inputData$OCCUPATION_rep)
inputData$OCCUPATION_rep <- gsub(pattern = '^ Armed-Forces', replacement = 'Other/Unknown', x = inputData$OCCUPATION_rep)

inputData$OCCUPATION_rep <- as.factor(inputData$OCCUPATION_rep)

summary(inputData$OCCUPATION_rep)
# Sales   Blue-Collar Other/Unknown  Professional       Service  White-Collar 
# 3650         10062          1852          4140          5021          7836
levels(inputData$OCCUPATION_rep)
# [1] " Sales"        "Blue-Collar"   "Other/Unknown" "Professional"  "Service"       "White-Collar"</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b94195805712-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-19">19</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-20">20</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-21">21</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-22">22</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-23">23</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-24">24</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-25">25</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-26">26</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-27">27</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-28">28</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-29">29</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-30">30</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-31">31</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-32">32</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-33">33</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-34">34</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-35">35</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-36">36</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-37">37</div><div class="crayon-num" data-line="crayon-60ed954725b94195805712-38">38</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b94195805712-1"># 先將?改命名成Unknown</div><div class="crayon-line" id="crayon-60ed954725b94195805712-2">levels(inputData$OCCUPATION)[1] <div class="crayon-line" id="crayon-60ed954725b94195805712-3"> </div><div class="crayon-line" id="crayon-60ed954725b94195805712-4"># 新增一個replacement水準值後的欄位：</div><div class="crayon-line" id="crayon-60ed954725b94195805712-5">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-6"> </div><div class="crayon-line" id="crayon-60ed954725b94195805712-7"># (1) Craft-repair, Farming-fishing, Handlers-cleaners , Machine-op-inspct, Transport-moving => 合併成Blue-Collar</div><div class="crayon-line" id="crayon-60ed954725b94195805712-8">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-9">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-10">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-11">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-12">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-13"> </div><div class="crayon-line" id="crayon-60ed954725b94195805712-14"># (2) Prof-specialty, => Professional</div><div class="crayon-line" id="crayon-60ed954725b94195805712-15">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-16"> </div><div class="crayon-line" id="crayon-60ed954725b94195805712-17"># (3) Sales => Sales不變</div><div class="crayon-line" id="crayon-60ed954725b94195805712-18"> </div><div class="crayon-line" id="crayon-60ed954725b94195805712-19"># (4) Other-service, Priv-house-serv, Protective-serv, Tech-support, => Service</div><div class="crayon-line" id="crayon-60ed954725b94195805712-20">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-21">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-22">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-23">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-24"> </div><div class="crayon-line" id="crayon-60ed954725b94195805712-25"># (5) Adm-clerical, Exec-managerial => 合併成White-Collar</div><div class="crayon-line" id="crayon-60ed954725b94195805712-26">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-27">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-28"># (6) ?,Armed-Forces => Other/Unknown</div><div class="crayon-line" id="crayon-60ed954725b94195805712-29">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-30">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-31"> </div><div class="crayon-line" id="crayon-60ed954725b94195805712-32">inputData$OCCUPATION_rep <div class="crayon-line" id="crayon-60ed954725b94195805712-33"> </div><div class="crayon-line" id="crayon-60ed954725b94195805712-34">summary(inputData$OCCUPATION_rep)</div><div class="crayon-line" id="crayon-60ed954725b94195805712-35"># Sales   Blue-Collar Other/Unknown  Professional       Service  White-Collar </div><div class="crayon-line" id="crayon-60ed954725b94195805712-36"># 3650         10062          1852          4140          5021          7836</div><div class="crayon-line" id="crayon-60ed954725b94195805712-37">levels(inputData$OCCUPATION_rep)</div><div class="crayon-line" id="crayon-60ed954725b94195805712-38"># [1] " Sales"        "Blue-Collar"   "Other/Unknown" "Professional"  "Service"       "White-Collar"</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>3-2. (optional)產生類別變數的WOE值<span style="color: #9d6ad4;">(本分析不會執行此段程式碼）</span></p>

		<div id="crayon-60ed954725b95642532499" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 這是一個選擇性的步驟，我們在本分析不會執行
# factor_vars <- c ("WORKCLASS", "EDUCATION", "MARITALSTATUS", "OCCUPATION", "OCCUPATION_rep", "RELATIONSHIP", "RACE", "SEX", "NATIVECOUNTRY")

# not run
# for(factor_var in factor_vars){
#   inputData[[factor_var]] <- WOE(X = inputData[,factor_var], Y = inputData$ABOVE50K_y)
# }</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b95642532499-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b95642532499-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b95642532499-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b95642532499-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b95642532499-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b95642532499-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b95642532499-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b95642532499-1"># 這是一個選擇性的步驟，我們在本分析不會執行</div><div class="crayon-line" id="crayon-60ed954725b95642532499-2"># factor_vars <div class="crayon-line" id="crayon-60ed954725b95642532499-3"> </div><div class="crayon-line" id="crayon-60ed954725b95642532499-4"># not run</div><div class="crayon-line" id="crayon-60ed954725b95642532499-5"># for(factor_var in factor_vars){</div><div class="crayon-line" id="crayon-60ed954725b95642532499-6">#   inputData[[factor_var]] <div class="crayon-line" id="crayon-60ed954725b95642532499-7"># }</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<h3>4. 產生訓練資料集與測試資料集</h3>
<p></p>

		<div id="crayon-60ed954725b97185489959" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 產生訓練資料集
input_ones <- inputData[which(inputData$ABOVE50K_y == 1),]
input_zeros <- inputData[which(inputData$ABOVE50K_y == 0), ]
set.seed(100)
input_ones_training_row <- sample(1:nrow(input_ones),0.7*nrow(input_ones))
input_zeros_training_row <- sample(1:nrow(input_zeros),0.7*nrow(input_zeros))

training_ones <- input_ones[input_ones_training_row,]
training_zeros <- input_zeros[input_zeros_training_row,]
trainingData <- rbind(training_ones, training_zeros)

# 產生測試資料集
test_ones <- input_ones[-input_ones_training_row,]
test_zeros <- input_zeros[-input_zeros_training_row,]
testData <- rbind(test_ones, test_zeros)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b97185489959-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b97185489959-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b97185489959-1"># 產生訓練資料集</div><div class="crayon-line" id="crayon-60ed954725b97185489959-2">input_ones <div class="crayon-line" id="crayon-60ed954725b97185489959-3">input_zeros <div class="crayon-line" id="crayon-60ed954725b97185489959-4">set.seed(100)</div><div class="crayon-line" id="crayon-60ed954725b97185489959-5">input_ones_training_row <div class="crayon-line" id="crayon-60ed954725b97185489959-6">input_zeros_training_row <div class="crayon-line" id="crayon-60ed954725b97185489959-7"> </div><div class="crayon-line" id="crayon-60ed954725b97185489959-8">training_ones <div class="crayon-line" id="crayon-60ed954725b97185489959-9">training_zeros <div class="crayon-line" id="crayon-60ed954725b97185489959-10">trainingData <div class="crayon-line" id="crayon-60ed954725b97185489959-11"> </div><div class="crayon-line" id="crayon-60ed954725b97185489959-12"># 產生測試資料集</div><div class="crayon-line" id="crayon-60ed954725b97185489959-13">test_ones <div class="crayon-line" id="crayon-60ed954725b97185489959-14">test_zeros <div class="crayon-line" id="crayon-60ed954725b97185489959-15">testData </div></div></div></div></div></div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<h3>5. 計算IV值，篩選變數</h3>
<p></p>

		<div id="crayon-60ed954725b98459167016" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 我們會使用套件中的函數smbinning::smbinning，來將連續變數切割為類別變數
library(smbinning)
# 將連續型變數和類別型變數分開
# 記得加入"OCCUPATION_rep"
factor_vars <- c ("WORKCLASS", "EDUCATION", "MARITALSTATUS", "OCCUPATION","OCCUPATION_rep", "RELATIONSHIP", "RACE", "SEX", "NATIVECOUNTRY")
continuous_vars <- c("AGE", "FNLWGT","EDUCATIONNUM", "HOURSPERWEEK", "CAPITALGAIN", "CAPITALLOSS")

# 建立一個變數IV值表格 : numeric(參數要放變數行數)
iv_df <- data.frame(VARS = c(factor_vars, continuous_vars), IV = numeric(15))

# 計算類別變數的IV值
for(factor_var in factor_vars){
  smb <- smbinning.factor(df = trainingData ,y = "ABOVE50K_y",x = factor_var)
  if(class(smb) != "character"){
    iv_df[iv_df$VARS == factor_var,"IV"] <- smb$iv
  }
}
# 計算連續變數的IV值
for(continuous_var in continuous_vars){
  smb <- smbinning(df = trainingData,y = "ABOVE50K_y",x = continuous_var)
  if(class(smb) != "character"){
    iv_df[iv_df$VARS == continuous_var,"IV"] <- smb$iv
  }
}

# 將變數依據IV值高低排列
iv_df <- iv_df[order(-iv_df$IV),]
iv_df

# VARS     IV
# 6    RELATIONSHIP 1.5435
# 3   MARITALSTATUS 1.3195
# 10            AGE 1.1815
# 12   EDUCATIONNUM 0.7169
# 14    CAPITALGAIN 0.6849
# 13   HOURSPERWEEK 0.4592
# 5  OCCUPATION_rep 0.3594
# 8             SEX 0.3127
# 1       WORKCLASS 0.1673
# 7            RACE 0.0634
# 2       EDUCATION 0.0000
# 4      OCCUPATION 0.0000
# 9   NATIVECOUNTRY 0.0000
# 11         FNLWGT 0.0000
# 15    CAPITALLOSS 0.0000</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed954725b98459167016-1">1</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-2">2</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-3">3</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-4">4</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-5">5</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-6">6</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-7">7</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-8">8</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-9">9</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-10">10</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-11">11</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-12">12</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-13">13</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-14">14</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-15">15</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-16">16</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-17">17</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-18">18</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-19">19</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-20">20</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-21">21</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-22">22</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-23">23</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-24">24</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-25">25</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-26">26</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-27">27</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-28">28</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-29">29</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-30">30</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-31">31</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-32">32</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-33">33</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-34">34</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-35">35</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-36">36</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-37">37</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-38">38</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-39">39</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-40">40</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-41">41</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-42">42</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-43">43</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-44">44</div><div class="crayon-num" data-line="crayon-60ed954725b98459167016-45">45</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed954725b98459167016-1"># 我們會使用套件中的函數smbinning::smbinning，來將連續變數切割為類別變數</div><div class="crayon-line" id="crayon-60ed954725b98459167016-2">library(smbinning)</div><div class="crayon-line" id="crayon-60ed954725b98459167016-3"># 將連續型變數和類別型變數分開</div><div class="crayon-line" id="crayon-60ed954725b98459167016-4"># 記得加入"OCCUPATION_rep"</div><div class="crayon-line" id="crayon-60ed954725b98459167016-5">factor_vars <div class="crayon-line" id="crayon-60ed954725b98459167016-6">continuous_vars <div class="crayon-line" id="crayon-60ed954725b98459167016-7"> </div><div class="crayon-line" id="crayon-60ed954725b98459167016-8"># 建立一個變數IV值表格 : numeric(參數要放變數行數)</div><div class="crayon-line" id="crayon-60ed954725b98459167016-9">iv_df <div class="crayon-line" id="crayon-60ed954725b98459167016-10"> </div><div class="crayon-line" id="crayon-60ed954725b98459167016-11"># 計算類別變數的IV值</div><div class="crayon-line" id="crayon-60ed954725b98459167016-12">for(factor_var in factor_vars){</div><div class="crayon-line" id="crayon-60ed954725b98459167016-13">  smb <div class="crayon-line" id="crayon-60ed954725b98459167016-14">  if(class(smb) != "character"){</div><div class="crayon-line" id="crayon-60ed954725b98459167016-15">    iv_df[iv_df$VARS == factor_var,"IV"] <div class="crayon-line" id="crayon-60ed954725b98459167016-16">  }</div><div class="crayon-line" id="crayon-60ed954725b98459167016-17">}</div><div class="crayon-line" id="crayon-60ed954725b98459167016-18"># 計算連續變數的IV值</div><div class="crayon-line" id="crayon-60ed954725b98459167016-19">for(continuous_var in continuous_vars){</div><div class="crayon-line" id="crayon-60ed954725b98459167016-20">  smb <div class="crayon-line" id="crayon-60ed954725b98459167016-21">  if(class(smb) != "character"){</div><div class="crayon-line" id="crayon-60ed954725b98459167016-22">    iv_df[iv_df$VARS == continuous_var,"IV"] <div class="crayon-line" id="crayon-60ed954725b98459167016-23">  }</div><div class="crayon-line" id="crayon-60ed954725b98459167016-24">}</div><div class="crayon-line" id="crayon-60ed954725b98459167016-25"> </div><div class="crayon-line" id="crayon-60ed954725b98459167016-26"># 將變數依據IV值高低排列</div><div class="crayon-line" id="crayon-60ed954725b98459167016-27">iv_df <div class="crayon-line" id="crayon-60ed954725b98459167016-28">iv_df</div><div class="crayon-line" id="crayon-60ed954725b98459167016-29"> </div><div class="crayon-line" id="crayon-60ed954725b98459167016-30"># VARS     IV</div><div class="crayon-line" id="crayon-60ed954725b98459167016-31"># 6    RELATIONSHIP 1.5435</div><div class="crayon-line" id="crayon-60ed954725b98459167016-32"># 3   MARITALSTATUS 1.3195</div><div class="crayon-line" id="crayon-60ed954725b98459167016-33"># 10            AGE 1.1815</div><div class="crayon-line" id="crayon-60ed954725b98459167016-34"># 12   EDUCATIONNUM 0.7169</div><div class="crayon-line" id="crayon-60ed954725b98459167016-35"># 14    CAPITALGAIN 0.6849</div><div class="crayon-line" id="crayon-60ed954725b98459167016-36"># 13   HOURSPERWEEK 0.4592</div><div class="crayon-line" id="crayon-60ed954725b98459167016-37"># 5  OCCUPATION_rep 0.3594</div><div class="crayon-line" id="crayon-60ed954725b98459167016-38"># 8             SEX 0.3127</div><div class="crayon-line" id="crayon-60ed954725b98459167016-39"># 1       WORKCLASS 0.1673</div><div class="crayon-line" id="crayon-60ed954725b98459167016-40"># 7            RACE 0.0634</div><div class="crayon-line" id="crayon-60ed954725b98459167016-41"># 2       EDUCATION 0.0000</div><div class="crayon-line" id="crayon-60ed954725b98459167016-42"># 4      OCCUPATION 0.0000</div><div class="crayon-line" id="crayon-60ed954725b98459167016-43"># 9   NATIVECOUNTRY 0.0000</div><div class="crayon-line" id="crayon-60ed954725b98459167016-44"># 11         FNLWGT 0.0000</div><div class="crayon-line" id="crayon-60ed954725b98459167016-45"># 15    CAPITALLOSS 0.0000</div></div></div></div></div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>關於IV Table的部分，我們可以得出以下資訊：</p>
<ol>
<li>根據經驗，IV>=0.3即表示該預測變數與目標變數有較強的關係。</li>
<li>類別變數IV=0表示類別水準值過多。
<ul>
<li>EDUCATION: 可以使用IV值較高的EDUCATIONNUM代替。</li>
<li>NATIVECOUNTRY:如我們一開始在資料探勘時所見，絕大多數資料皆為United States，因此不予進一步討論。</li>
</ul>
</li>
<li>連續變數IV=0表示沒有顯著的切點存在。
<ul>
<li>FNLWGT：一開始為簡化分析，即不考慮納入模型分析。</li>
<li>CAPITALLOSS: 因為該特徵資料分佈極偏，故不納入進一步模型分析。</li>
</ul>
</li>
<li>從IV表數值，我們決定初步篩選出變數RELATIONSHIP, MARITALSTATUS, AGE, EDUCATIONNUM, CAPITALGAIN, OCCUPATION_rep進行模型分析。</li>
</ol>
<p>Logistic Regression Modeling <span style="color: #9f6ad4;">羅吉斯回歸建模 part2 </span>的部分請參考: <a href="/logistic_regression_part2/" target="_blank" rel="noopener noreferrer">羅吉斯回歸 – part2 模型建置、診斷與比較</a>。</p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<hr>
<p>更多模型建置筆記連結：</p>
<ol>
<li><a href="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" target="_blank" rel="noopener noreferrer">Logistic Regression 羅吉斯迴歸 | part2 – 模型建置、診斷與比較 | R語言</a></li>
<li><a href="/linear-regression-%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%e6%a8%a1%e5%9e%8b/" target="_blank" rel="noopener noreferrer">Linear Regression | 線性迴歸模型 | using AirQuality Dataset</a></li>
<li><a href="/regularized-regression-ridge-lasso-elastic/" target="_blank" rel="noopener noreferrer">Regularized Regression | 正規化迴歸 – Ridge, Lasso, Elastic Net | R語言</a></li>
<li><a href="/decision-tree-cart-%e6%b1%ba%e7%ad%96%e6%a8%b9/" target="_blank" rel="noopener noreferrer">Decision Tree 決策樹 | CART, Conditional Inference Tree, Random Forest</a></li>
<li><a href="/regression-tree-%e8%bf%b4%e6%ad%b8%e6%a8%b9-bagging-bootstrap-aggrgation-r%e8%aa%9e%e8%a8%80/" target="_blank" rel="noopener noreferrer">Regression Tree | 迴歸樹, Bagging, Bootstrap Aggregation | R語言</a></li>
<li><a href="/random-forests-%e9%9a%a8%e6%a9%9f%e6%a3%ae%e6%9e%97/" target="_blank" rel="noopener noreferrer">Random Forests 隨機森林 | randomForest, ranger, h2o | R語言</a></li>
<li><a href="/gradient-boosting-machines-gbm/" target="_blank" rel="noopener noreferrer">Gradient Boosting Machines GBM | gbm, xgboost, h2o | R語言</a></li>
<li><a href="/hierarchical-clustering-%e9%9a%8e%e5%b1%a4%e5%bc%8f%e5%88%86%e7%be%a4/" target="_blank" rel="noopener noreferrer">Hierarchical Clustering 階層式分群 | Clustering 資料分群 | R統計</a></li>
<li><a href="/partitional-clustering-kmeans-kmedoid/" target="_blank" rel="noopener noreferrer">Partitional Clustering | 切割式分群 | Kmeans, Kmedoid | Clustering 資料分群</a></li>
<li><a href="/principal-components-analysis-pca-%e4%b8%bb%e6%88%90%e4%bb%bd%e5%88%86%e6%9e%90/" target="_blank" rel="noopener noreferrer">Principal Components Analysis (PCA) | 主成份分析 | R 統計</a></li>
</ol>
<hr>
<p>參考:</p>
<ol>
<li><a href="https://tinyurl.com/y796qqca">歐萊禮  R資料科學</a></li>
</ol>
			</div>

	<footer class="entry-footer">
		<span class="tags-links"> <a href="/tag/data-pre-processing/" rel="tag">data pre processing</a>0<a href="/tag/eda/" rel="tag">eda</a>0<a href="/tag/exploratory-data-analysis/" rel="tag">exploratory data analysis</a>0<a href="/tag/glm/" rel="tag">glm</a>0<a href="/tag/information-value/" rel="tag">information value</a>0<a href="/tag/iv/" rel="tag">IV</a>0<a href="/tag/logistic-regression/" rel="tag">logistic regression</a>0<a href="/tag/%e7%be%85%e5%90%89%e6%96%af%e5%9b%9e%e6%ad%b8/" rel="tag">羅吉斯回歸</a>0<a href="/tag/%e8%b3%87%e6%96%99%e6%8e%a2%e7%b4%a2/" rel="tag">資料探索</a>0<a href="/tag/%e8%b3%87%e6%96%99%e9%a0%90%e8%99%95%e7%90%86/" rel="tag">資料預處理</a></span>	</footer>

	
</article>

				<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">文章導覽列</h2>
		<div class="nav-links clearfix">
			<div class="nav-previous"><span>⟵</span><a href="/linear-regression-%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%e6%a8%a1%e5%9e%8b/" rel="prev">Linear Regression | 線性迴歸模型 | using AirQuality Dataset</a></div><div class="nav-next"><a href="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" rel="next">Logistic Regression 羅吉斯迴歸 | part2 – 模型建置、診斷與比較 | R語言</a><span>⟶</span></div>		</div>
	</nav>
	
			
<div id="comments" class="comments-area">

	
			<h4 class="comment-title">
			在《<span>Logistic Regression 羅吉斯迴歸 | part1 – 資料探勘與處理 | 統計 R語言</span>》中有 2 則留言		</h4>

		
		<ol class="comments-list">
					<li id="comment-3292" class="pingback even thread-even depth-1">
			<div class="comment-body">
				自動引用通知: <a href="http://edu.secda.info/scu07354020/?p=1441" rel="external nofollow ugc" class="url">深夜了，阿芳淚流滿面 – 鄭蕙芳學習平台</a> 			</div>
		</li>
		<li id="comment-3488" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-3488" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="http://2.gravatar.com/avatar/2e0b33c83fa6e10049e11d9af353c252?s=60&d=mm&r=g" srcset="http://2.gravatar.com/avatar/2e0b33c83fa6e10049e11d9af353c252?s=120&d=mm&r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy">						<b class="fn">Hunter</b><span class="says">表示:</span>					</div>

					<div class="comment-metadata">
						<a href="/logistic-regression-part1-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/#comment-3488"><time datetime="2020-11-26T23:20:32+08:00">2020-11-2623:20:32</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>你好呀，我base在大陆上海，期待和你交流</p>
				</div>

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="#comment-3488" data-commentid="3488" data-postid="846" data-belowelement="div-comment-3488" data-respondelement="respond" data-replyto="回覆給「Hunter」" aria-label="回覆給「Hunter」">回覆</a></div>			</article>
		</li>
		</ol>

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">發佈留言 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/logistic-regression-part1-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/#respond" style="display:none;">取消回覆</a></small></h3><form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">發佈留言必須填寫的電子郵件地址不會公開。</span> 必填欄位標示為 <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">留言</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">顯示名稱 <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">電子郵件地址 <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">個人網站網址</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200"></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="發佈留言"> <input type="hidden" name="comment_post_ID" value="846" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><div class="wantispam-required-fields"><input type="hidden" name="wantispam_t" class="wantispam-control wantispam-control-t" value="1626182983"><div class="wantispam-group wantispam-group-q" style="clear: both;">
					<label>Current ye@r <span class="required">*</span></label>
					<input type="hidden" name="wantispam_a" class="wantispam-control wantispam-control-a" value="2021">
					<input type="text" name="wantispam_q" class="wantispam-control wantispam-control-q" value="7.2.0" autocomplete="off">
				  </div>
<div class="wantispam-group wantispam-group-e" style="display: none;">
					<label>Leave this field empty</label>
					<input type="text" name="wantispam_e_email_url_website" class="wantispam-control wantispam-control-e" value="" autocomplete="off">
				  </div>
</div></form>	</div>
	
</div>

		
		</main>
	</div>

	

<div id="secondary" class="widget-area col-md-3" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">搜尋關鍵字:</span>
					<input type="search" class="search-field" placeholder="搜尋..." value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="搜尋">
			</form></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h3 class="widget-title">近期文章</h3>
		<ul>
											<li>
					<a href="/jbs-diner/">JB’s Diner | 陽光、綠意、自然度假風美式早午餐 | 台北 天母</a>
									</li>
											<li>
					<a href="/%e9%82%80%e6%9c%88%e5%85%92/">邀月兒 | 適合放鬆小酌的迷人高級餐酒館 | 台北 民生社區 富錦街</a>
									</li>
											<li>
					<a href="/eslite-cafe-%e4%bf%a1%e7%be%a9%e8%aa%a0%e5%93%81%e5%92%96%e5%95%a1/">信義誠品咖啡 Eslite Café | 美美的 優雅的 文青咖啡廳 | 台北 信義區</a>
									</li>
											<li>
					<a href="/%e5%b0%8f%e9%bc%8e%e8%86%be/">小鼎膾 | 新鮮美味的高品質日式丼飯、海鮮料理 | 台北信義 Bellavita B2</a>
									</li>
											<li>
					<a href="/gradient-boosting-machines-gbm/">Gradient Boosting Machines GBM | gbm, xgboost, h2o | R語言</a>
									</li>
					</ul>

		</aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">彙整</h3>
			<ul>
					<li><a href="/2019/08/">2019 年 8 月</a></li>
	<li><a href="/2019/04/">2019 年 4 月</a></li>
	<li><a href="/2019/03/">2019 年 3 月</a></li>
	<li><a href="/2019/02/">2019 年 2 月</a></li>
	<li><a href="/2019/01/">2019 年 1 月</a></li>
	<li><a href="/2018/12/">2018 年 12 月</a></li>
	<li><a href="/2018/10/">2018 年 10 月</a></li>
	<li><a href="/2018/09/">2018 年 9 月</a></li>
	<li><a href="/2018/08/">2018 年 8 月</a></li>
	<li><a href="/2018/07/">2018 年 7 月</a></li>
	<li><a href="/2018/05/">2018 年 5 月</a></li>
			</ul>

			</aside></div>
			</div>
		</div>
	</div>

	
	
    <a class="go-top"><i class="fa fa-angle-up"></i></a>
		
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info container">
			<a href="https://tw.wordpress.org/">本站採用 WordPress 建置</a>
			<span class="sep"> | </span>
			佈景主題採用由 aThemes 所設計的 <a href="https://athemes.com/theme/sydney" rel="designer">Sydney</a>。		</div>
	</footer>

	
</div>


<script type="text/javascript">
var sbiajaxurl = "/wp-admin/admin-ajax.php";
</script>
<script type="text/javascript" src="/wp-content/plugins/anti-spam/assets/js/anti-spam.js" id="anti-spam-script-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/scripts.js" id="sydney-scripts-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/main.min.js" id="sydney-main-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/skip-link-focus-fix.js" id="sydney-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config&ver=1.3.11" id="mathjax-js"></script>


</body></html>
