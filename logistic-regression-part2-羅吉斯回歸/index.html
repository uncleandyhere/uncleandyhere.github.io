<!DOCTYPE html>
<html lang="zh-TW" prefix="og: http://ogp.me/ns#">
<head>
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


	
<title>Logistic Regression 羅吉斯迴歸 | part2 - 模型建置、診斷與比較 | R語言</title>
<meta name="robots" content="max-image-preview:large">


<meta name="description" content="Logistic Regression, 羅吉斯回歸模型，適用於預測二元類別目標變數的發生機率(p)，和線性回歸模型類似，與線性回歸主要不同之處在於：(1) 目標變數是目標事件發生機率P經過log函數轉換成log odds值才進行線性預測，且(2)羅吉斯回歸的各項參數是透過最大概似法(MLE)進行估計的。">

<meta property="og:locale" content="zh_TW">
<meta property="og:type" content="article">
<meta property="og:title" content="Logistic Regression 羅吉斯回歸 | part2 - 模型建置、診斷與比較 | R語言">
<meta property="og:description" content="Logistic Regression, 羅吉斯回歸模型，適用於預測二元類別目標變數的發生機率(p)，和線性回歸模型類似，與線性回歸主要不同之處在於：(1) 目標變數是目標事件發生機率P經過log函數轉換成log odds值才進行線性預測，且(2)羅吉斯回歸的各項參數是透過最大概似法(MLE)進行估計的。">
<meta property="og:url" content="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/">
<meta property="og:site_name" content="果醬珍珍•JamJam">
<meta property="article:tag" content="AUC">
<meta property="article:tag" content="cart">
<meta property="article:tag" content="confusion matrix">
<meta property="article:tag" content="decision tree">
<meta property="article:tag" content="logistic regression">
<meta property="article:tag" content="model diagnostic">
<meta property="article:tag" content="neural networks">
<meta property="article:tag" content="random forest">
<meta property="article:tag" content="ROC">
<meta property="article:tag" content="support vector machine">
<meta property="article:tag" content="svm">
<meta property="article:tag" content="模型診斷">
<meta property="article:tag" content="混亂矩陣">
<meta property="article:tag" content="羅吉斯回歸">
<meta property="article:section" content=" 程式與統計">
<meta property="article:published_time" content="2018-08-28T06:24:35+08:00">
<meta property="article:modified_time" content="2020-07-03T02:33:57+08:00">
<meta property="og:updated_time" content="2020-07-03T02:33:57+08:00">
<meta property="og:image" content="/wp-content/uploads/2018/08/christopher-gower-291240-unsplash-1024x683.jpg">
<meta property="og:image:width" content="1024">
<meta property="og:image:height" content="683">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="Logistic Regression, 羅吉斯回歸模型，適用於預測二元類別目標變數的發生機率(p)，和線性回歸模型類似，與線性回歸主要不同之處在於：(1) 目標變數是目標事件發生機率P經過log函數轉換成log odds值才進行線性預測，且(2)羅吉斯回歸的各項參數是透過最大概似法(MLE)進行估計的。">
<meta name="twitter:title" content="Logistic Regression 羅吉斯迴歸 | part2 - 模型建置、診斷與比較 | R語言">
<meta name="twitter:image" content="/wp-content/uploads/2018/08/christopher-gower-291240-unsplash.jpg">


<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//s.w.org">



<link rel="stylesheet" id="crayon-css" href="/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-hwj-based-on-monokai-css" href="/wp-content/uploads/crayon-syntax-highlighter/themes/hwj-based-on-monokai/hwj-based-on-monokai.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monospace-css" href="/wp-content/plugins/crayon-syntax-highlighter/fonts/monospace.css" type="text/css" media="all">
<link rel="stylesheet" id="sb_instagram_styles-css" href="/wp-content/plugins/instagram-feed/css/sb-instagram-2-2.min.css" type="text/css" media="all">
<link rel="stylesheet" id="sydney-bootstrap-css" href="/wp-content/themes/hwj-based-on-sydney/css/bootstrap/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="titan-adminbar-styles-css" href="/wp-content/plugins/anti-spam/assets/css/admin-bar.css" type="text/css" media="all">
<link rel="stylesheet" id="sydney-fonts-css" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C600%7CRaleway%3A400%2C500%2C600" type="text/css" media="all">
<link rel="stylesheet" id="sydney-style-css" href="/wp-content/themes/hwj-based-on-sydney/style.css" type="text/css" media="all">
<style id="sydney-style-inline-css" type="text/css">
.site-title { font-size:32px; }
.site-description { font-size:16px; }
#mainnav ul li a { font-size:14px; }
h1 { font-size:52px; }
h2 { font-size:42px; }
h3 { font-size:32px; }
h4 { font-size:25px; }
h5 { font-size:20px; }
h6 { font-size:18px; }
body { font-size:16px; }
.single .hentry .title-post { font-size:24px; }
.header-image { background-size:cover;}
.header-image { height:500px; }
.widget-area .widget_fp_social a,#mainnav ul li a:hover, .sydney_contact_info_widget span, .roll-team .team-content .name,.roll-team .team-item .team-pop .team-social li:hover a,.roll-infomation li.address:before,.roll-infomation li.phone:before,.roll-infomation li.email:before,.roll-testimonials .name,.roll-button.border,.roll-button:hover,.roll-icon-list .icon i,.roll-icon-list .content h3 a:hover,.roll-icon-box.white .content h3 a,.roll-icon-box .icon i,.roll-icon-box .content h3 a:hover,.switcher-container .switcher-icon a:focus,.go-top:hover,.hentry .meta-post a:hover,#mainnav > ul > li > a.active, #mainnav > ul > li > a:hover, button:hover, input[type="button"]:hover, input[type="reset"]:hover, input[type="submit"]:hover, .text-color, .social-menu-widget a, .social-menu-widget a:hover, .archive .team-social li a, a, h1 a, h2 a, h3 a, h4 a, h5 a, h6 a,.classic-alt .meta-post a,.single .hentry .meta-post a { color:#3d3d3d}
.reply,.woocommerce div.product .woocommerce-tabs ul.tabs li.active,.woocommerce #respond input#submit,.woocommerce a.button,.woocommerce button.button,.woocommerce input.button,.project-filter li a.active, .project-filter li a:hover,.preloader .pre-bounce1, .preloader .pre-bounce2,.roll-team .team-item .team-pop,.roll-progress .progress-animate,.roll-socials li a:hover,.roll-project .project-item .project-pop,.roll-project .project-filter li.active,.roll-project .project-filter li:hover,.roll-button.light:hover,.roll-button.border:hover,.roll-button,.roll-icon-box.white .icon,.owl-theme .owl-controls .owl-page.active span,.owl-theme .owl-controls.clickable .owl-page:hover span,.go-top,.bottom .socials li:hover a,.sidebar .widget:before,.blog-pagination ul li.active,.blog-pagination ul li:hover a,.content-area .hentry:after,.text-slider .maintitle:after,.error-wrap #search-submit:hover,#mainnav .sub-menu li:hover > a,#mainnav ul li ul:after, button, input[type="button"], input[type="reset"], input[type="submit"], .panel-grid-cell .widget-title:after { background-color:#3d3d3d}
.roll-socials li a:hover,.roll-socials li a,.roll-button.light:hover,.roll-button.border,.roll-button,.roll-icon-list .icon,.roll-icon-box .icon,.owl-theme .owl-controls .owl-page span,.comment .comment-detail,.widget-tags .tag-list a:hover,.blog-pagination ul li,.hentry blockquote,.error-wrap #search-submit:hover,textarea:focus,input[type="text"]:focus,input[type="password"]:focus,input[type="datetime"]:focus,input[type="datetime-local"]:focus,input[type="date"]:focus,input[type="month"]:focus,input[type="time"]:focus,input[type="week"]:focus,input[type="number"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="search"]:focus,input[type="tel"]:focus,input[type="color"]:focus, button, input[type="button"], input[type="reset"], input[type="submit"], .archive .team-social li a { border-color:#3d3d3d}
.site-header.float-header { background-color:rgba(0,0,0,0.9);}
@media only screen and (max-width: 1024px) { .site-header { background-color:#000000;}}
.site-title a, .site-title a:hover { color:#ffffff}
.site-description { color:#ffffff}
#mainnav ul li a, #mainnav ul li::before { color:#ffffff}
#mainnav .sub-menu li a { color:#ffffff}
#mainnav .sub-menu li a { background:#1c1c1c}
.text-slider .maintitle, .text-slider .subtitle { color:#ffffff}
body { color:#5e5e5e}
#secondary { background-color:#ffffff}
#secondary, #secondary a, #secondary .widget-title { color:#767676}
.footer-widgets { background-color:#252525}
.btn-menu { color:#ffffff}
#mainnav ul li a:hover { color:#d65050}
.site-footer { background-color:#1c1c1c}
.site-footer,.site-footer a { color:#666666}
.overlay { background-color:#000000}
.page-wrap { padding-top:10px;}
.page-wrap { padding-bottom:100px;}
@media only screen and (max-width: 1025px) {		
			.mobile-slide {
				display: block;
			}
			.slide-item {
				background-image: none !important;
			}
			.header-slider {
			}
			.slide-item {
				height: auto !important;
			}
			.slide-inner {
				min-height: initial;
			} 
		}
@media only screen and (max-width: 780px) { 
    	h1 { font-size: 32px;}
		h2 { font-size: 28px;}
		h3 { font-size: 22px;}
		h4 { font-size: 18px;}
		h5 { font-size: 16px;}
		h6 { font-size: 14px;}
    }

</style>
<link rel="stylesheet" id="sydney-font-awesome-css" href="/wp-content/themes/hwj-based-on-sydney/fonts/font-awesome.min.css" type="text/css" media="all">

<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<script type="text/javascript" id="crayon_js-js-extra">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/localhost\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js" id="crayon_js-js"></script>





</head><body><div id="fb-root"></div><script>(function(d, s, id) {

	var js, fjs = d.getElementsByTagName(s)[0];

	if (d.getElementById(id)) return;

	js = d.createElement(s); js.id = id;

	js.src = '//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.3';

	fjs.parentNode.insertBefore(js, fjs);

	}(document, 'script', 'facebook-jssdk'));</script>	<style type="text/css">
		.header-image {
			background-image: url(/wp-content/uploads/2018/09/果醬珍珍_首圖_10.jpg);
			display: block;
		}
		@media only screen and (max-width: 1024px) {
			.header-inner {
				display: block;
			}
			.header-image {
				background-image: none;
				height: auto !important;
			}		
		}
	</style>
			<style type="text/css" id="wp-custom-css">
			.entry-content a {
	text-decoration: underline;
	color: #9f6ad4;
}		</style>
			<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
	</script>
	

	




	<div class="preloader">
	    <div class="spinner">
	        <div class="pre-bounce1"></div>
	        <div class="pre-bounce2"></div>
	    </div>
	</div>
	
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">跳至主內容區</a>

	
	
	
	<div id="masthead" class="site-header" role="banner" style="display:none;"> 
		<div class="header-wrap">
            <div class="container">
                <div class="row">
				<div class="col-md-4 col-sm-8 col-xs-12">
		        					<a href="/" title="果醬珍珍•JamJam"><img class="site-logo" src="/wp-content/uploads/2018/09/grape_320.png" alt="果醬珍珍•JamJam"></a>
		        				</div>
				<div class="col-md-8 col-sm-4 col-xs-12">
					<div class="btn-menu"></div>
					<nav id="mainnav" class="mainnav" role="navigation">
						<div class="menu-jamleecute-container"><ul id="menu-jamleecute" class="menu"><li id="menu-item-1691" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1691"><a href="/category/programming-statistics/"> 程式與統計</a></li>
<li id="menu-item-626" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-626"><a href="/category/travel/">旅遊</a></li>
<li id="menu-item-627" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-627"><a href="/category/foodie/">美食</a></li>
<li id="menu-item-2415" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2415"><a href="/%e7%b0%a1%e4%bb%8b/">關於我</a></li>
</ul></div>					</nav>
				</div>
				</div>
			</div>
		</div>
	</div>
	
	
	

	
	<style>
	.header-img-bounding-box {
	  background-image: url("/wp-content/uploads/2018/09/%E8%83%8C%E6%99%AF%E5%8E%9F%E5%9C%96_v2.jpg");
    background-size:     cover;                      /* <------ */
    background-repeat:   no-repeat;
    background-position: center center;              /* optional, center the image */
/* 	height: 300px; */
	padding-top:55px;
	padding-bottom:55px;
		}
		.title_img {
		    display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
		min-width: 340px;
			max-width: 800px;

		}
		
		
		.subtitle_img {
			display: block;
    margin-left: auto;
    margin-right: auto;
    width: 50%;
		min-width: 340px;
			max-width: 800px;
		}
		
		
		.subtitle_overlay {
			margin-top:20px;
			background-color: rgba(255, 255, 255, 0.7);
			padding-bottom:8px;
		}
	</style>
	
	<div>
		<a href="/">
		<div class="header-img-bounding-box">

			<img src="/wp-content/uploads/2018/09/title.png" class="title_img">
			<div class="subtitle_overlay">
			<img src="/wp-content/uploads/2018/09/subtitle.png" class="subtitle_img">
			</div>			
		</div>	
		</a>
	</div>
	
	
	
	<header>
		<nav id="my_mainnav" class="my_mainnav" role="navigation">
				<div class="menu-jamleecute-container"><ul id="menu-jamleecute-1" class="menu"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-1691"><a href="/category/programming-statistics/"> 程式與統計</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-626"><a href="/category/travel/">旅遊</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-627"><a href="/category/foodie/">美食</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2415"><a href="/%e7%b0%a1%e4%bb%8b/">關於我</a></li>
</ul></div>		</nav>
	</header>

	
	
	
	<div id="content" class="page-wrap">
		
		
		
		<style>
			.home_intro {
				    margin: 0 12%;
					/*height: 400px;*/
    				/*background: yellow;*/
				
			}
			
			.home_intro .content{
				display: flex; 
    display: -webkit-flex;
    justify-content: center;
    -webkit-justify-content: center;
    flex-wrap: wrap;
			}
			.home_intro .content .intro {
				width: 240px;
    			
				margin: 0 auto;
				
			}
			.home_intro .content .intro .image {
				/*width: 240px;
    			padding: 0px;
				margin: 0 auto;
				display: inline-block;*/
			  position: relative;
			  width: 240px;
			  height: 240px;
			  overflow: hidden;
			  border-radius: 50%;
			}
			.home_intro .content .description{
				padding: 0 0px;
    			margin: 0 auto;
    			width: 240px;
				text-align: center;
			}
			.home_intro .content .social_icon {
				margin: 0 7px;
			}
			
			.circular--landscape {
			  display: inline-block;
			  position: relative;
			  width: 200px;
			  height: 200px;
			  overflow: hidden;
			  border-radius: 50%;
			}

			.home_intro .content .intro .image img {
			  width: auto;
			  height: 100%;
			  /*margin-left: -50px;*/
			}
		</style>
		

					
				
		
		<div class="container content-wrapper">
			<div class="row">	
				
				
				
	
	
	<div id="primary" class="content-area col-md-9 ">

		
		<main id="main" class="post-wrap" role="main">

		
			
<article id="post-851" class="post-851 post type-post status-publish format-standard has-post-thumbnail hentry category-programming-statistics category-statistics-model tag-auc tag-cart tag-confusion-matrix tag-decision-tree tag-logistic-regression tag-model-diagnostic tag-neural-networks tag-random-forest tag-roc tag-support-vector-machine tag-svm tag-228 tag-232 tag-221">
	
	
			<div class="entry-thumb">
			<img width="5184" height="3456" src="/wp-content/uploads/2018/08/christopher-gower-291240-unsplash.jpg" class="attachment-large-thumb size-large-thumb wp-post-image" alt="christopher-gower-291240-unsplash" loading="lazy" srcset="/wp-content/uploads/2018/08/christopher-gower-291240-unsplash.jpg 5184w,/wp-content/uploads/2018/08/christopher-gower-291240-unsplash-300x200.jpg 300w,/wp-content/uploads/2018/08/christopher-gower-291240-unsplash-768x512.jpg 768w,/wp-content/uploads/2018/08/christopher-gower-291240-unsplash-1024x683.jpg 1024w,/wp-content/uploads/2018/08/christopher-gower-291240-unsplash-830x553.jpg 830w,/wp-content/uploads/2018/08/christopher-gower-291240-unsplash-230x153.jpg 230w,/wp-content/uploads/2018/08/christopher-gower-291240-unsplash-350x233.jpg 350w,/wp-content/uploads/2018/08/christopher-gower-291240-unsplash-480x320.jpg 480w" sizes="(max-width: 5184px) 100vw, 5184px">		</div>
		
	<header class="entry-header">
		
		<div class="meta-post">
			<a href="/category/programming-statistics/" title=" 程式與統計" class="post-cat"> 程式與統計</a><a href="/category/programming-statistics/statistics-model/" title="統計模型" class="post-cat">統計模型</a>		</div>

		<h1 class="title-post entry-title">Logistic Regression 羅吉斯迴歸 | part2 – 模型建置、診斷與比較 | R語言</h1>
				<div class="single-meta">
			<span class="posted-on">發表於 <a href="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" rel="bookmark"><time class="entry-date published" datetime="2018-08-28T14:24:35+08:00">2018-08-28</time><time class="updated" datetime="2020-07-03T10:33:57+08:00">2020-07-03</time></a></span><span class="byline"> <span class="author vcard"><a class="url fn n" href="/author/jamleecute/">jamleecute</a></span></span>		</div>
			</header>

	

	<div class="entry-content">
		<p class=""></p>
<p>Logistic Regression, 羅吉斯回歸模型，適用於<span style="color: #9f6ad4;">預測<span style="text-decoration: underline;">二元類別目標變數</span>的發生機率(p)</span>，和線性回歸模型類似，與線性回歸主要不同之處在於：(1) 目標變數是目標事件發生機率P經過log函數轉換成log odds值才進行線性預測，且(2)羅吉斯回歸的各項參數是透過最大概似法(MLE)進行估計的。</p>
<h3>Logistic Regression part1 前情提要</h3>
<p>「<a href="/logistic_regression_part1/" target="_blank" rel="noopener noreferrer">Logistic Regression – part1 – 資料探勘與處理</a>」篇的重點回顧：</p>
<ol>
<li>探索預測變數自身分佈情況以及各預測變數與目標變數之間的關係。</li>
<li>資料預處理，將類別水準直過多的變數進行簡化。</li>
<li>隨機產生訓練與測試資料集。</li>
<li>計算各預測變數的Information Value來初步判斷各預測變數對目標變數的影響程度。</li>
<li>依據IV值初步從13個變數篩選出6個變數包括：RELATIONSHIP, MARITALSTATUS, AGE, EDUCATIONNUM, CAPITALGAIN,OCCUPATION_rep。</li>
</ol>
<h3>分析資料與問題</h3>
<p>Problem: 預測薪資大於50K(ABOVE50K)的影響特徵因素有哪些？</p>
<p>Data: <a href="https://archive.ics.uci.edu/ml/datasets/adult">adult dataset</a> (snapshot)</p>
<p>目標變數(1)：ABOVE50K</p>
<p>預測變數(13)：AGE, WORKCLASS, EDUCATION, EDUCATIONNUM, MARITALSTATUS, OCCUPATION, RELATIONSHIP, RACE, SEX, CAPITALGAIN, CAPITALLOSS, HOURSPERWEEK, NATIVECOUNTRY</p>
<h3>分析步驟</h3>
<p>(part 2 篇會說明步驟6~8的部分)(步驟1~5請參考「<a href="/logistic_regression_part1/" target="_blank" rel="noopener noreferrer">Logistic Regression – part1 – 資料探勘與處理</a>」)</p>
<ol>
<li><span style="color: #000000;">資料載入與檢視</span></li>
<li><span style="color: #000000;">資料探勘</span></li>
<li><span style="color: #000000;">資料前處理</span></li>
<li><span style="color: #000000;">產生訓練資料集與測試資料集</span></li>
<li><span style="color: #000000;">計算特徵變數IV值(Information Value)，篩選變數</span></li>
<li><span style="color: #9f6ad4;">訓練模型與預測</span></li>
<li><span style="color: #9f6ad4;">模型診斷與調整</span></li>
<li><span style="color: #9f6ad4;">模型比較(v.s. Machine Learning Methods)</span></li>
</ol>
<h3>6. 訓練模型與預測</h3>
<p>接續「<a href="/logistic_regression_part1/" target="_blank" rel="noopener noreferrer">Logistic Regression – part1 – 資料探勘與處理</a>」，我們將近一步針對初步篩選出的6預測變數進行羅基斯回歸模型分析。</p>

		<div id="crayon-60ed9549053bc168761169" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
logitMod <- glm(formula = ABOVE50K_y ~ RELATIONSHIP + MARITALSTATUS + AGE + EDUCATIONNUM + CAPITALGAIN + OCCUPATION_rep,
                data = trainingData,family = binomial(link = "logit"))
summary(logitMod)

# Call:
#   glm(formula = ABOVE50K_y ~ RELATIONSHIP + MARITALSTATUS + AGE + 
#         EDUCATIONNUM + CAPITALGAIN + OCCUPATION_rep, family = binomial(link = "logit"), 
#       data = trainingData)
# 
# Deviance Residuals: 
#   Min       1Q   Median       3Q      Max  
# -5.2263  -0.5640  -0.2258  -0.0528   3.8139  
# 
# Coefficients:
#   Estimate Std. Error z value             Pr(>|z|)    
# (Intercept)                         -6.2679390  0.3703477 -16.924 < 0.0000000000000002 ***
#   RELATIONSHIP Not-in-family          -0.2201571  0.3288849  -0.669             0.503237    
# RELATIONSHIP Other-relative         -1.5525876  0.3172511  -4.894     0.00000098869035 ***
#   RELATIONSHIP Own-child              -1.6632915  0.3252302  -5.114     0.00000031507745 ***
#   RELATIONSHIP Unmarried              -0.6486702  0.3428225  -1.892             0.058472 .  
# RELATIONSHIP Wife                   -0.0196633  0.0760145  -0.259             0.795884    
# MARITALSTATUS Married-AF-spouse      2.4570045  0.6658794   3.690             0.000224 ***
#   MARITALSTATUS Married-civ-spouse     1.9165557  0.3331962   5.752     0.00000000881763 ***
#   MARITALSTATUS Married-spouse-absent -0.0649140  0.2672163  -0.243             0.808062    
# MARITALSTATUS Never-married         -0.3668251  0.1008955  -3.636             0.000277 ***
#   MARITALSTATUS Separated             -0.1122524  0.1867781  -0.601             0.547845    
# MARITALSTATUS Widowed               -0.1851853  0.1746133  -1.061             0.288897    
# AGE                                  0.0217164  0.0017943  12.103 < 0.0000000000000002 ***
#   EDUCATIONNUM                         0.3058023  0.0103400  29.575 < 0.0000000000000002 ***
#   CAPITALGAIN                          0.0003108  0.0000118  26.331 < 0.0000000000000002 ***
#   OCCUPATION_repBlue-Collar           -0.4800489  0.0701546  -6.843     0.00000000000777 ***
#   OCCUPATION_repOther/Unknown         -1.3267766  0.1312315 -10.110 < 0.0000000000000002 ***
#   OCCUPATION_repProfessional           0.1688849  0.0799712   2.112             0.034702 *  
#   OCCUPATION_repService               -0.4061912  0.0845737  -4.803     0.00000156457927 ***
#   OCCUPATION_repWhite-Collar           0.2455151  0.0699361   3.511             0.000447 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
# Null deviance: 25162  on 22791  degrees of freedom
# Residual deviance: 15492  on 22772  degrees of freedom
# AIC: 15532
# 
# Number of Fisher Scoring iterations: 7</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-15">15</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-16">16</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-17">17</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-18">18</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-19">19</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-20">20</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-21">21</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-22">22</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-23">23</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-24">24</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-25">25</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-26">26</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-27">27</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-28">28</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-29">29</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-30">30</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-31">31</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-32">32</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-33">33</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-34">34</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-35">35</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-36">36</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-37">37</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-38">38</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-39">39</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-40">40</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-41">41</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-42">42</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-43">43</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-44">44</div><div class="crayon-num" data-line="crayon-60ed9549053bc168761169-45">45</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053bc168761169-1">logitMod <div class="crayon-line" id="crayon-60ed9549053bc168761169-2">                data = trainingData,family = binomial(link = "logit"))</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-3">summary(logitMod)</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-4"> </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-5"># Call:</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-6">#   glm(formula = ABOVE50K_y ~ RELATIONSHIP + MARITALSTATUS + AGE + </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-7">#         EDUCATIONNUM + CAPITALGAIN + OCCUPATION_rep, family = binomial(link = "logit"), </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-8">#       data = trainingData)</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-9"># </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-10"># Deviance Residuals: </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-11">#   Min       1Q   Median       3Q      Max  </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-12"># -5.2263  -0.5640  -0.2258  -0.0528   3.8139  </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-13"># </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-14"># Coefficients:</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-15">#   Estimate Std. Error z value             Pr(>|z|)    </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-16"># (Intercept)                         -6.2679390  0.3703477 -16.924 <div class="crayon-line" id="crayon-60ed9549053bc168761169-17">#   RELATIONSHIP Not-in-family          -0.2201571  0.3288849  -0.669             0.503237    </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-18"># RELATIONSHIP Other-relative         -1.5525876  0.3172511  -4.894     0.00000098869035 ***</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-19">#   RELATIONSHIP Own-child              -1.6632915  0.3252302  -5.114     0.00000031507745 ***</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-20">#   RELATIONSHIP Unmarried              -0.6486702  0.3428225  -1.892             0.058472 .  </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-21"># RELATIONSHIP Wife                   -0.0196633  0.0760145  -0.259             0.795884    </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-22"># MARITALSTATUS Married-AF-spouse      2.4570045  0.6658794   3.690             0.000224 ***</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-23">#   MARITALSTATUS Married-civ-spouse     1.9165557  0.3331962   5.752     0.00000000881763 ***</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-24">#   MARITALSTATUS Married-spouse-absent -0.0649140  0.2672163  -0.243             0.808062    </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-25"># MARITALSTATUS Never-married         -0.3668251  0.1008955  -3.636             0.000277 ***</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-26">#   MARITALSTATUS Separated             -0.1122524  0.1867781  -0.601             0.547845    </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-27"># MARITALSTATUS Widowed               -0.1851853  0.1746133  -1.061             0.288897    </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-28"># AGE                                  0.0217164  0.0017943  12.103 <div class="crayon-line" id="crayon-60ed9549053bc168761169-29">#   EDUCATIONNUM                         0.3058023  0.0103400  29.575 <div class="crayon-line" id="crayon-60ed9549053bc168761169-30">#   CAPITALGAIN                          0.0003108  0.0000118  26.331 <div class="crayon-line" id="crayon-60ed9549053bc168761169-31">#   OCCUPATION_repBlue-Collar           -0.4800489  0.0701546  -6.843     0.00000000000777 ***</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-32">#   OCCUPATION_repOther/Unknown         -1.3267766  0.1312315 -10.110 <div class="crayon-line" id="crayon-60ed9549053bc168761169-33">#   OCCUPATION_repProfessional           0.1688849  0.0799712   2.112             0.034702 *  </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-34">#   OCCUPATION_repService               -0.4061912  0.0845737  -4.803     0.00000156457927 ***</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-35">#   OCCUPATION_repWhite-Collar           0.2455151  0.0699361   3.511             0.000447 ***</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-36">#   ---</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-37">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-38"># </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-39"># (Dispersion parameter for binomial family taken to be 1)</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-40"># </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-41"># Null deviance: 25162  on 22791  degrees of freedom</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-42"># Residual deviance: 15492  on 22772  degrees of freedom</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-43"># AIC: 15532</div><div class="crayon-line" id="crayon-60ed9549053bc168761169-44"># </div><div class="crayon-line" id="crayon-60ed9549053bc168761169-45"># Number of Fisher Scoring iterations: 7</div></div></div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>除了摘要模型，我們另外針對共線性進行檢查。發現變數RELATIONSHIP和MARITALSTATUS有共線性。</p>

		<div id="crayon-60ed9549053c0069556669" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 模型共線性檢查VIF(希望VIF值都在4以下)
library(car)
vif(logitMod)

#                     GVIF Df GVIF^(1/(2*Df))
# RELATIONSHIP   55.704490  5        1.494820
# MARITALSTATUS  56.687207  6        1.399986
# AGE             1.177411  1        1.085086
# EDUCATIONNUM    1.384560  1        1.176673
# CAPITALGAIN     1.018983  1        1.009447
# OCCUPATION_rep  1.531311  5        1.043533</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053c0069556669-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053c0069556669-1"># 模型共線性檢查VIF(希望VIF值都在4以下)</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-2">library(car)</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-3">vif(logitMod)</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-4"> </div><div class="crayon-line" id="crayon-60ed9549053c0069556669-5">#                     GVIF Df GVIF^(1/(2*Df))</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-6"># RELATIONSHIP   55.704490  5        1.494820</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-7"># MARITALSTATUS  56.687207  6        1.399986</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-8"># AGE             1.177411  1        1.085086</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-9"># EDUCATIONNUM    1.384560  1        1.176673</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-10"># CAPITALGAIN     1.018983  1        1.009447</div><div class="crayon-line" id="crayon-60ed9549053c0069556669-11"># OCCUPATION_rep  1.531311  5        1.043533</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>因此，我們根據RELATIONSHIP和MARITALSTATUS的IV值，捨棄其中較低者，重新再進行一次模型建置。</p>

		<div id="crayon-60ed9549053c3214864616" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
logitMod <- glm(formula = ABOVE50K_y ~ RELATIONSHIP + AGE + EDUCATIONNUM + CAPITALGAIN + OCCUPATION_rep,
                data = trainingData,family = binomial(link = "logit"))

summary(logitMod)

# Call:
#   glm(formula = ABOVE50K_y ~ RELATIONSHIP + AGE + EDUCATIONNUM + 
#         CAPITALGAIN + OCCUPATION_rep, family = binomial(link = "logit"), 
#       data = trainingData)
# 
# Deviance Residuals: 
#   Min       1Q   Median       3Q      Max  
# -5.2305  -0.5663  -0.2319  -0.0590   3.5991  
# 
# Coefficients:
#   Estimate  Std. Error z value
# (Intercept)                 -4.39303806  0.15173422 -28.952
# RELATIONSHIP Not-in-family  -2.34469608  0.05835820 -40.178
# RELATIONSHIP Other-relative -3.02210032  0.26185701 -11.541
# RELATIONSHIP Own-child      -3.72243110  0.16395790 -22.704
# RELATIONSHIP Unmarried      -2.66495726  0.09783246 -27.240
# RELATIONSHIP Wife           -0.00985696  0.07585158  -0.130
# AGE                          0.02285379  0.00171654  13.314
# EDUCATIONNUM                 0.30497481  0.01032637  29.534
# CAPITALGAIN                  0.00031083  0.00001181  26.312
# OCCUPATION_repBlue-Collar   -0.47777138  0.07013154  -6.813
# OCCUPATION_repOther/Unknown -1.33506791  0.13132122 -10.166
# OCCUPATION_repProfessional   0.16489267  0.07982984   2.066
# OCCUPATION_repService       -0.40645290  0.08448125  -4.811
# OCCUPATION_repWhite-Collar   0.24924877  0.06989076   3.566
# Pr(>|z|)    
# (Intercept)                 < 0.0000000000000002 ***
#   RELATIONSHIP Not-in-family  < 0.0000000000000002 ***
#   RELATIONSHIP Other-relative < 0.0000000000000002 ***
#   RELATIONSHIP Own-child      < 0.0000000000000002 ***
#   RELATIONSHIP Unmarried      < 0.0000000000000002 ***
#   RELATIONSHIP Wife                       0.896606    
# AGE                         < 0.0000000000000002 ***
#   EDUCATIONNUM                < 0.0000000000000002 ***
#   CAPITALGAIN                 < 0.0000000000000002 ***
#   OCCUPATION_repBlue-Collar       0.00000000000959 ***
#   OCCUPATION_repOther/Unknown < 0.0000000000000002 ***
#   OCCUPATION_repProfessional              0.038871 *  
#   OCCUPATION_repService           0.00000150055853 ***
#   OCCUPATION_repWhite-Collar              0.000362 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
# Null deviance: 25162  on 22791  degrees of freedom
# Residual deviance: 15542  on 22778  degrees of freedom
# AIC: 15570
# 
# Number of Fisher Scoring iterations: 7</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-15">15</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-16">16</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-17">17</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-18">18</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-19">19</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-20">20</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-21">21</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-22">22</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-23">23</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-24">24</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-25">25</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-26">26</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-27">27</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-28">28</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-29">29</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-30">30</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-31">31</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-32">32</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-33">33</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-34">34</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-35">35</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-36">36</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-37">37</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-38">38</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-39">39</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-40">40</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-41">41</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-42">42</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-43">43</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-44">44</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-45">45</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-46">46</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-47">47</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-48">48</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-49">49</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-50">50</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-51">51</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-52">52</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-53">53</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-54">54</div><div class="crayon-num" data-line="crayon-60ed9549053c3214864616-55">55</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053c3214864616-1">logitMod <div class="crayon-line" id="crayon-60ed9549053c3214864616-2">                data = trainingData,family = binomial(link = "logit"))</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-3"> </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-4">summary(logitMod)</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-5"> </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-6"># Call:</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-7">#   glm(formula = ABOVE50K_y ~ RELATIONSHIP + AGE + EDUCATIONNUM + </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-8">#         CAPITALGAIN + OCCUPATION_rep, family = binomial(link = "logit"), </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-9">#       data = trainingData)</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-10"># </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-11"># Deviance Residuals: </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-12">#   Min       1Q   Median       3Q      Max  </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-13"># -5.2305  -0.5663  -0.2319  -0.0590   3.5991  </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-14"># </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-15"># Coefficients:</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-16">#   Estimate  Std. Error z value</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-17"># (Intercept)                 -4.39303806  0.15173422 -28.952</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-18"># RELATIONSHIP Not-in-family  -2.34469608  0.05835820 -40.178</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-19"># RELATIONSHIP Other-relative -3.02210032  0.26185701 -11.541</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-20"># RELATIONSHIP Own-child      -3.72243110  0.16395790 -22.704</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-21"># RELATIONSHIP Unmarried      -2.66495726  0.09783246 -27.240</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-22"># RELATIONSHIP Wife           -0.00985696  0.07585158  -0.130</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-23"># AGE                          0.02285379  0.00171654  13.314</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-24"># EDUCATIONNUM                 0.30497481  0.01032637  29.534</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-25"># CAPITALGAIN                  0.00031083  0.00001181  26.312</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-26"># OCCUPATION_repBlue-Collar   -0.47777138  0.07013154  -6.813</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-27"># OCCUPATION_repOther/Unknown -1.33506791  0.13132122 -10.166</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-28"># OCCUPATION_repProfessional   0.16489267  0.07982984   2.066</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-29"># OCCUPATION_repService       -0.40645290  0.08448125  -4.811</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-30"># OCCUPATION_repWhite-Collar   0.24924877  0.06989076   3.566</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-31"># Pr(>|z|)    </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-32"># (Intercept)                 <div class="crayon-line" id="crayon-60ed9549053c3214864616-33">#   RELATIONSHIP Not-in-family  <div class="crayon-line" id="crayon-60ed9549053c3214864616-34">#   RELATIONSHIP Other-relative <div class="crayon-line" id="crayon-60ed9549053c3214864616-35">#   RELATIONSHIP Own-child      <div class="crayon-line" id="crayon-60ed9549053c3214864616-36">#   RELATIONSHIP Unmarried      <div class="crayon-line" id="crayon-60ed9549053c3214864616-37">#   RELATIONSHIP Wife                       0.896606    </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-38"># AGE                         <div class="crayon-line" id="crayon-60ed9549053c3214864616-39">#   EDUCATIONNUM                <div class="crayon-line" id="crayon-60ed9549053c3214864616-40">#   CAPITALGAIN                 <div class="crayon-line" id="crayon-60ed9549053c3214864616-41">#   OCCUPATION_repBlue-Collar       0.00000000000959 ***</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-42">#   OCCUPATION_repOther/Unknown <div class="crayon-line" id="crayon-60ed9549053c3214864616-43">#   OCCUPATION_repProfessional              0.038871 *  </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-44">#   OCCUPATION_repService           0.00000150055853 ***</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-45">#   OCCUPATION_repWhite-Collar              0.000362 ***</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-46">#   ---</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-47">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-48"># </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-49"># (Dispersion parameter for binomial family taken to be 1)</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-50"># </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-51"># Null deviance: 25162  on 22791  degrees of freedom</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-52"># Residual deviance: 15542  on 22778  degrees of freedom</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-53"># AIC: 15570</div><div class="crayon-line" id="crayon-60ed9549053c3214864616-54"># </div><div class="crayon-line" id="crayon-60ed9549053c3214864616-55"># Number of Fisher Scoring iterations: 7</div></div></div></div></div></div></div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>並在重新檢視共線性。可以發現去除MARITALSTATUS後，所有變數的VIF值都小於4了。</p>

		<div id="crayon-60ed9549053c5403555837" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(car)
vif(logitMod)

#                     GVIF Df GVIF^(1/(2*Df))
# RELATIONSHIP   1.197104  5        1.018153
# AGE            1.089616  1        1.043847
# EDUCATIONNUM   1.388249  1        1.178240
# CAPITALGAIN    1.018159  1        1.009038
# OCCUPATION_rep 1.531428  5        1.043541</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053c5403555837-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053c5403555837-1">library(car)</div><div class="crayon-line" id="crayon-60ed9549053c5403555837-2">vif(logitMod)</div><div class="crayon-line" id="crayon-60ed9549053c5403555837-3"> </div><div class="crayon-line" id="crayon-60ed9549053c5403555837-4">#                     GVIF Df GVIF^(1/(2*Df))</div><div class="crayon-line" id="crayon-60ed9549053c5403555837-5"># RELATIONSHIP   1.197104  5        1.018153</div><div class="crayon-line" id="crayon-60ed9549053c5403555837-6"># AGE            1.089616  1        1.043847</div><div class="crayon-line" id="crayon-60ed9549053c5403555837-7"># EDUCATIONNUM   1.388249  1        1.178240</div><div class="crayon-line" id="crayon-60ed9549053c5403555837-8"># CAPITALGAIN    1.018159  1        1.009038</div><div class="crayon-line" id="crayon-60ed9549053c5403555837-9"># OCCUPATION_rep 1.531428  5        1.043541</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>於是我們使用此模型來預測測試資料集。</p>

		<div id="crayon-60ed9549053c6487718236" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
prob <- predict(logitMod, testData, type="response")  # predicted scores</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053c6487718236-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053c6487718236-1">prob </div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>為了優化模型正確率，我們使用InformationValue套件中的optimalCutoff函數來尋找最適機率切點。發現最適機率值切點跟預設的0.5一樣。</p>

		<div id="crayon-60ed9549053c7484012109" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(InformationValue)
optCutOff <- optimalCutoff(actuals = testData$ABOVE50K_y,predictedScores = predicted)[1]
optCutOff
# [1] 0.5</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053c7484012109-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053c7484012109-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053c7484012109-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053c7484012109-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053c7484012109-1">library(InformationValue)</div><div class="crayon-line" id="crayon-60ed9549053c7484012109-2">optCutOff <div class="crayon-line" id="crayon-60ed9549053c7484012109-3">optCutOff</div><div class="crayon-line" id="crayon-60ed9549053c7484012109-4"># [1] 0.5</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p></p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<p>決定了機率切點後，我們來驗證模型使用測試資料集的預測效果如何。我們會分別計算以下指標：</p>
<ul>
<li>Confusion Matrix
<ul>
<li>misClassification Rate</li>
<li>precision</li>
<li>Sensitivity</li>
<li>Specifisity</li>
</ul>
</li>
<li>Concordance</li>
<li>ROC/AUC</li>
</ul>
<p>Confusion Matrix: 左欄為預測值，上方欄則為實際值。</p>

		<div id="crayon-60ed9549053c9618372637" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 產生Confusion Matrix
confusionMatrix(actuals = testData$ABOVE50K_y,predictedScores = predicted,threshold = optCutOff)

#      0    1
# 0 6935 1074
# 1  481 1279</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053c9618372637-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053c9618372637-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053c9618372637-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053c9618372637-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053c9618372637-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053c9618372637-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053c9618372637-1"># 產生Confusion Matrix</div><div class="crayon-line" id="crayon-60ed9549053c9618372637-2">confusionMatrix(actuals = testData$ABOVE50K_y,predictedScores = predicted,threshold = optCutOff)</div><div class="crayon-line" id="crayon-60ed9549053c9618372637-3"> </div><div class="crayon-line" id="crayon-60ed9549053c9618372637-4">#      0    1</div><div class="crayon-line" id="crayon-60ed9549053c9618372637-5"># 0 6935 1074</div><div class="crayon-line" id="crayon-60ed9549053c9618372637-6"># 1  481 1279</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>預測錯誤率(misClassification Rate)</p>

		<div id="crayon-60ed9549053ca415362439" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
misClassError(actuals = testData$ABOVE50K_y,predictedScores = predicted,threshold = optCutOff)
# [1] 0.1592</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053ca415362439-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053ca415362439-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053ca415362439-1">misClassError(actuals = testData$ABOVE50K_y,predictedScores = predicted,threshold = optCutOff)</div><div class="crayon-line" id="crayon-60ed9549053ca415362439-2"># [1] 0.1592</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>預測精準度(Precision，及所有預測為1的事件中，真實亦為1的事件比率）。</p>

		<div id="crayon-60ed9549053cb683168374" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
precision(actuals = testData$ABOVE50K_y,predictedScores = predicted,threshold = optCutOff)
# [1] 0.7267045</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053cb683168374-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053cb683168374-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053cb683168374-1">precision(actuals = testData$ABOVE50K_y,predictedScores = predicted,threshold = optCutOff)</div><div class="crayon-line" id="crayon-60ed9549053cb683168374-2"># [1] 0.7267045</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Sensitivity</p>
<p>$$Sensitivity=\frac{\sharp\space Actual\space 1’s\space and\space Predicted\space as\space 1’s}{\sharp\space of\space Actual\space 1’s}$$</p>
<p>又稱Recall(捕捉率），即真實為1，且被正確預測為1的比例。（通常與Precision精準度成反比）</p>

		<div id="crayon-60ed9549053cd877552134" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
sensitivity(testData$ABOVE50K_y, predicted, threshold = optCutOff)
# [1] 0.5435614</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053cd877552134-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053cd877552134-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053cd877552134-1">sensitivity(testData$ABOVE50K_y, predicted, threshold = optCutOff)</div><div class="crayon-line" id="crayon-60ed9549053cd877552134-2"># [1] 0.5435614</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Specificity</p>
<p class="">$$Specificity=\frac{\sharp\space Actual\space 0’s\space and\space Predicted\space as\space 0’s}{\sharp\space of\space Actual\space 0’s}$$</p>
<p>即真實為0，且被正確預測為0的比例。</p>

		<div id="crayon-60ed9549053ce988239836" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
specificity(testData$ABOVE50K_y, predicted, threshold = optCutOff)
# [1] 0.9351402</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053ce988239836-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053ce988239836-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053ce988239836-1">specificity(testData$ABOVE50K_y, predicted, threshold = optCutOff)</div><div class="crayon-line" id="crayon-60ed9549053ce988239836-2"># [1] 0.9351402</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>Concordance。則為所有預測結果(0,1)成對的機率值中，真實為1的事件，1的機率高於0的機率佔所有成對資料的比例。<span style="color: #9f6ad4;">理想中，該比例越高越好</span>，即表示所有預測(0,1)的機率值，若真實為1，則1的預測機率理應都大於0的預測機率。（discordance則為相反結果的比例，tied則為機率無差別的結果比例，三比例相加應為100%）。</p>

		<div id="crayon-60ed9549053cf054062731" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
Concordance(testData$ABOVE50K_y, predicted)

# $Concordance
# [1] 0.8866298
# 
# $Discordance
# [1] 0.1133702
# 
# $Tied
# [1] -0.00000000000000004163336
# 
# $Pairs
# [1] 17449848</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053cf054062731-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053cf054062731-1">Concordance(testData$ABOVE50K_y, predicted)</div><div class="crayon-line" id="crayon-60ed9549053cf054062731-2"> </div><div class="crayon-line" id="crayon-60ed9549053cf054062731-3"># $Concordance</div><div class="crayon-line" id="crayon-60ed9549053cf054062731-4"># [1] 0.8866298</div><div class="crayon-line" id="crayon-60ed9549053cf054062731-5"># </div><div class="crayon-line" id="crayon-60ed9549053cf054062731-6"># $Discordance</div><div class="crayon-line" id="crayon-60ed9549053cf054062731-7"># [1] 0.1133702</div><div class="crayon-line" id="crayon-60ed9549053cf054062731-8"># </div><div class="crayon-line" id="crayon-60ed9549053cf054062731-9"># $Tied</div><div class="crayon-line" id="crayon-60ed9549053cf054062731-10"># [1] -0.00000000000000004163336</div><div class="crayon-line" id="crayon-60ed9549053cf054062731-11"># </div><div class="crayon-line" id="crayon-60ed9549053cf054062731-12"># $Pairs</div><div class="crayon-line" id="crayon-60ed9549053cf054062731-13"># [1] 17449848</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>ROC/AUC。可以發現在ROC曲線下面積為88.85%。理想中，會希望ROC曲線前段越陡越好，後段越緩越好。表示模型整體預測能力的好壞。</p>

		<div id="crayon-60ed9549053d1772462137" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
plotROC(actuals = testData$ABOVE50K_y,predictedScores = predicted)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053d1772462137-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053d1772462137-1">plotROC(actuals = testData$ABOVE50K_y,predictedScores = predicted)</div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p><img loading="lazy" class="alignnone size-large wp-image-972" src="/wp-content/uploads/2018/08/pic19-1024x928.png" alt="logistic regression" width="960" height="870" srcset="/wp-content/uploads/2018/08/pic19-1024x928.png 1024w,/wp-content/uploads/2018/08/pic19-300x272.png 300w,/wp-content/uploads/2018/08/pic19-768x696.png 768w,/wp-content/uploads/2018/08/pic19-1140x1034.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<p>總結以上指標數據，可以發現模型預測能力還不錯，錯誤率15.92%都還在能接受範圍內。</p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<h3>7. 模型診斷與調整</h3>
<p>為了近一步看看模型有無優化空間以及合適度，常見做法包括(1)殘差分析 (2)K-fold Cross Validation (3)Bootstrap (4)StepwiseRegression。我們這邊就以逐步回歸為範例，來看看模型是否有優化空間。</p>
<p>我們同時使用逐步向後/向前法，並比較兩法最後的結果(AIC)是否有差。</p>

		<div id="crayon-60ed9549053d2095654008" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
 為了進一步簡化模型，我們使用逐步向前/向後法來挑選變數
# 依據每一個變數加入/移除模型後AIC資訊的變化，來判斷變數對模型的效果
# full model設定為我們剛剛建模結果
m_full <- logitMod 
# 基礎只有截距的模型
m_null <- glm(formula = ABOVE50K_y ~ 1, family = binomial(link = "logit"),data = trainingData)

# backward selection 逐步向後法
stepModBack <- step(object = m_full,scope = list(lower = m_null, upper = m_full),direction = "backward",trace = F)
summary(stepModBack) #模型結果的AIC跟原始模型相同為15570

# Call:
#   glm(formula = ABOVE50K_y ~ RELATIONSHIP + AGE + EDUCATIONNUM + 
#         CAPITALGAIN + OCCUPATION_rep, family = binomial(link = "logit"), 
#       data = trainingData)
# 
# Deviance Residuals: 
#   Min       1Q   Median       3Q      Max  
# -5.2305  -0.5663  -0.2319  -0.0590   3.5991  
# 
# Coefficients:
#   Estimate  Std. Error z value
# (Intercept)                 -4.39303806  0.15173422 -28.952
# RELATIONSHIP Not-in-family  -2.34469608  0.05835820 -40.178
# RELATIONSHIP Other-relative -3.02210032  0.26185701 -11.541
# RELATIONSHIP Own-child      -3.72243110  0.16395790 -22.704
# RELATIONSHIP Unmarried      -2.66495726  0.09783246 -27.240
# RELATIONSHIP Wife           -0.00985696  0.07585158  -0.130
# AGE                          0.02285379  0.00171654  13.314
# EDUCATIONNUM                 0.30497481  0.01032637  29.534
# CAPITALGAIN                  0.00031083  0.00001181  26.312
# OCCUPATION_repBlue-Collar   -0.47777138  0.07013154  -6.813
# OCCUPATION_repOther/Unknown -1.33506791  0.13132122 -10.166
# OCCUPATION_repProfessional   0.16489267  0.07982984   2.066
# OCCUPATION_repService       -0.40645290  0.08448125  -4.811
# OCCUPATION_repWhite-Collar   0.24924877  0.06989076   3.566
# Pr(>|z|)    
# (Intercept)                 < 0.0000000000000002 ***
#   RELATIONSHIP Not-in-family  < 0.0000000000000002 ***
#   RELATIONSHIP Other-relative < 0.0000000000000002 ***
#   RELATIONSHIP Own-child      < 0.0000000000000002 ***
#   RELATIONSHIP Unmarried      < 0.0000000000000002 ***
#   RELATIONSHIP Wife                       0.896606    
# AGE                         < 0.0000000000000002 ***
#   EDUCATIONNUM                < 0.0000000000000002 ***
#   CAPITALGAIN                 < 0.0000000000000002 ***
#   OCCUPATION_repBlue-Collar       0.00000000000959 ***
#   OCCUPATION_repOther/Unknown < 0.0000000000000002 ***
#   OCCUPATION_repProfessional              0.038871 *  
#   OCCUPATION_repService           0.00000150055853 ***
#   OCCUPATION_repWhite-Collar              0.000362 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
# Null deviance: 25162  on 22791  degrees of freedom
# Residual deviance: 15542  on 22778  degrees of freedom
# AIC: 15570
# 
# Number of Fisher Scoring iterations: 7


# forward selection 逐步向前法
stepModForward <- step(object = m_null,scope = list(lower = m_null, upper = m_full),direction = "forward",trace = F)
summary(stepModForward) 
# 向前法、向後法模型結果AIC值皆與原始模型相同為15570，且模型皆相同
# 因此我們會確定採用原始模型logigMod

# Call:
#   glm(formula = ABOVE50K_y ~ RELATIONSHIP + EDUCATIONNUM + CAPITALGAIN + 
#         OCCUPATION_rep + AGE, family = binomial(link = "logit"), 
#       data = trainingData)
# 
# Deviance Residuals: 
#   Min       1Q   Median       3Q      Max  
# -5.2305  -0.5663  -0.2319  -0.0590   3.5991  
# 
# Coefficients:
#   Estimate  Std. Error z value
# (Intercept)                 -4.39303806  0.15173422 -28.952
# RELATIONSHIP Not-in-family  -2.34469608  0.05835820 -40.178
# RELATIONSHIP Other-relative -3.02210032  0.26185701 -11.541
# RELATIONSHIP Own-child      -3.72243110  0.16395790 -22.704
# RELATIONSHIP Unmarried      -2.66495726  0.09783246 -27.240
# RELATIONSHIP Wife           -0.00985696  0.07585158  -0.130
# EDUCATIONNUM                 0.30497481  0.01032637  29.534
# CAPITALGAIN                  0.00031083  0.00001181  26.312
# OCCUPATION_repBlue-Collar   -0.47777138  0.07013154  -6.813
# OCCUPATION_repOther/Unknown -1.33506791  0.13132122 -10.166
# OCCUPATION_repProfessional   0.16489267  0.07982984   2.066
# OCCUPATION_repService       -0.40645290  0.08448125  -4.811
# OCCUPATION_repWhite-Collar   0.24924877  0.06989076   3.566
# AGE                          0.02285379  0.00171654  13.314
# Pr(>|z|)    
# (Intercept)                 < 0.0000000000000002 ***
#   RELATIONSHIP Not-in-family  < 0.0000000000000002 ***
#   RELATIONSHIP Other-relative < 0.0000000000000002 ***
#   RELATIONSHIP Own-child      < 0.0000000000000002 ***
#   RELATIONSHIP Unmarried      < 0.0000000000000002 ***
#   RELATIONSHIP Wife                       0.896606    
# EDUCATIONNUM                < 0.0000000000000002 ***
#   CAPITALGAIN                 < 0.0000000000000002 ***
#   OCCUPATION_repBlue-Collar       0.00000000000959 ***
#   OCCUPATION_repOther/Unknown < 0.0000000000000002 ***
#   OCCUPATION_repProfessional              0.038871 *  
#   OCCUPATION_repService           0.00000150055853 ***
#   OCCUPATION_repWhite-Collar              0.000362 ***
#   AGE                         < 0.0000000000000002 ***
#   ---
#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
# 
# (Dispersion parameter for binomial family taken to be 1)
# 
# Null deviance: 25162  on 22791  degrees of freedom
# Residual deviance: 15542  on 22778  degrees of freedom
# AIC: 15570
# 
# Number of Fisher Scoring iterations: 7</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-15">15</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-16">16</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-17">17</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-18">18</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-19">19</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-20">20</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-21">21</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-22">22</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-23">23</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-24">24</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-25">25</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-26">26</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-27">27</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-28">28</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-29">29</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-30">30</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-31">31</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-32">32</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-33">33</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-34">34</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-35">35</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-36">36</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-37">37</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-38">38</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-39">39</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-40">40</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-41">41</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-42">42</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-43">43</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-44">44</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-45">45</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-46">46</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-47">47</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-48">48</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-49">49</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-50">50</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-51">51</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-52">52</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-53">53</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-54">54</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-55">55</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-56">56</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-57">57</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-58">58</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-59">59</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-60">60</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-61">61</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-62">62</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-63">63</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-64">64</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-65">65</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-66">66</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-67">67</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-68">68</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-69">69</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-70">70</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-71">71</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-72">72</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-73">73</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-74">74</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-75">75</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-76">76</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-77">77</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-78">78</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-79">79</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-80">80</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-81">81</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-82">82</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-83">83</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-84">84</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-85">85</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-86">86</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-87">87</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-88">88</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-89">89</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-90">90</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-91">91</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-92">92</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-93">93</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-94">94</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-95">95</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-96">96</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-97">97</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-98">98</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-99">99</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-100">100</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-101">101</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-102">102</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-103">103</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-104">104</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-105">105</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-106">106</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-107">107</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-108">108</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-109">109</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-110">110</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-111">111</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-112">112</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-113">113</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-114">114</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-115">115</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-116">116</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-117">117</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-118">118</div><div class="crayon-num" data-line="crayon-60ed9549053d2095654008-119">119</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053d2095654008-1"> 為了進一步簡化模型，我們使用逐步向前/向後法來挑選變數</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-2"># 依據每一個變數加入/移除模型後AIC資訊的變化，來判斷變數對模型的效果</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-3"># full model設定為我們剛剛建模結果</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-4">m_full <div class="crayon-line" id="crayon-60ed9549053d2095654008-5"># 基礎只有截距的模型</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-6">m_null <div class="crayon-line" id="crayon-60ed9549053d2095654008-7"> </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-8"># backward selection 逐步向後法</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-9">stepModBack <div class="crayon-line" id="crayon-60ed9549053d2095654008-10">summary(stepModBack) #模型結果的AIC跟原始模型相同為15570</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-11"> </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-12"># Call:</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-13">#   glm(formula = ABOVE50K_y ~ RELATIONSHIP + AGE + EDUCATIONNUM + </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-14">#         CAPITALGAIN + OCCUPATION_rep, family = binomial(link = "logit"), </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-15">#       data = trainingData)</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-16"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-17"># Deviance Residuals: </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-18">#   Min       1Q   Median       3Q      Max  </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-19"># -5.2305  -0.5663  -0.2319  -0.0590   3.5991  </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-20"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-21"># Coefficients:</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-22">#   Estimate  Std. Error z value</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-23"># (Intercept)                 -4.39303806  0.15173422 -28.952</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-24"># RELATIONSHIP Not-in-family  -2.34469608  0.05835820 -40.178</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-25"># RELATIONSHIP Other-relative -3.02210032  0.26185701 -11.541</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-26"># RELATIONSHIP Own-child      -3.72243110  0.16395790 -22.704</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-27"># RELATIONSHIP Unmarried      -2.66495726  0.09783246 -27.240</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-28"># RELATIONSHIP Wife           -0.00985696  0.07585158  -0.130</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-29"># AGE                          0.02285379  0.00171654  13.314</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-30"># EDUCATIONNUM                 0.30497481  0.01032637  29.534</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-31"># CAPITALGAIN                  0.00031083  0.00001181  26.312</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-32"># OCCUPATION_repBlue-Collar   -0.47777138  0.07013154  -6.813</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-33"># OCCUPATION_repOther/Unknown -1.33506791  0.13132122 -10.166</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-34"># OCCUPATION_repProfessional   0.16489267  0.07982984   2.066</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-35"># OCCUPATION_repService       -0.40645290  0.08448125  -4.811</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-36"># OCCUPATION_repWhite-Collar   0.24924877  0.06989076   3.566</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-37"># Pr(>|z|)    </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-38"># (Intercept)                 <div class="crayon-line" id="crayon-60ed9549053d2095654008-39">#   RELATIONSHIP Not-in-family  <div class="crayon-line" id="crayon-60ed9549053d2095654008-40">#   RELATIONSHIP Other-relative <div class="crayon-line" id="crayon-60ed9549053d2095654008-41">#   RELATIONSHIP Own-child      <div class="crayon-line" id="crayon-60ed9549053d2095654008-42">#   RELATIONSHIP Unmarried      <div class="crayon-line" id="crayon-60ed9549053d2095654008-43">#   RELATIONSHIP Wife                       0.896606    </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-44"># AGE                         <div class="crayon-line" id="crayon-60ed9549053d2095654008-45">#   EDUCATIONNUM                <div class="crayon-line" id="crayon-60ed9549053d2095654008-46">#   CAPITALGAIN                 <div class="crayon-line" id="crayon-60ed9549053d2095654008-47">#   OCCUPATION_repBlue-Collar       0.00000000000959 ***</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-48">#   OCCUPATION_repOther/Unknown <div class="crayon-line" id="crayon-60ed9549053d2095654008-49">#   OCCUPATION_repProfessional              0.038871 *  </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-50">#   OCCUPATION_repService           0.00000150055853 ***</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-51">#   OCCUPATION_repWhite-Collar              0.000362 ***</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-52">#   ---</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-53">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-54"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-55"># (Dispersion parameter for binomial family taken to be 1)</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-56"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-57"># Null deviance: 25162  on 22791  degrees of freedom</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-58"># Residual deviance: 15542  on 22778  degrees of freedom</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-59"># AIC: 15570</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-60"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-61"># Number of Fisher Scoring iterations: 7</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-62"> </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-63"> </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-64"># forward selection 逐步向前法</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-65">stepModForward <div class="crayon-line" id="crayon-60ed9549053d2095654008-66">summary(stepModForward) </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-67"># 向前法、向後法模型結果AIC值皆與原始模型相同為15570，且模型皆相同</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-68"># 因此我們會確定採用原始模型logigMod</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-69"> </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-70"># Call:</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-71">#   glm(formula = ABOVE50K_y ~ RELATIONSHIP + EDUCATIONNUM + CAPITALGAIN + </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-72">#         OCCUPATION_rep + AGE, family = binomial(link = "logit"), </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-73">#       data = trainingData)</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-74"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-75"># Deviance Residuals: </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-76">#   Min       1Q   Median       3Q      Max  </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-77"># -5.2305  -0.5663  -0.2319  -0.0590   3.5991  </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-78"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-79"># Coefficients:</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-80">#   Estimate  Std. Error z value</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-81"># (Intercept)                 -4.39303806  0.15173422 -28.952</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-82"># RELATIONSHIP Not-in-family  -2.34469608  0.05835820 -40.178</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-83"># RELATIONSHIP Other-relative -3.02210032  0.26185701 -11.541</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-84"># RELATIONSHIP Own-child      -3.72243110  0.16395790 -22.704</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-85"># RELATIONSHIP Unmarried      -2.66495726  0.09783246 -27.240</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-86"># RELATIONSHIP Wife           -0.00985696  0.07585158  -0.130</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-87"># EDUCATIONNUM                 0.30497481  0.01032637  29.534</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-88"># CAPITALGAIN                  0.00031083  0.00001181  26.312</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-89"># OCCUPATION_repBlue-Collar   -0.47777138  0.07013154  -6.813</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-90"># OCCUPATION_repOther/Unknown -1.33506791  0.13132122 -10.166</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-91"># OCCUPATION_repProfessional   0.16489267  0.07982984   2.066</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-92"># OCCUPATION_repService       -0.40645290  0.08448125  -4.811</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-93"># OCCUPATION_repWhite-Collar   0.24924877  0.06989076   3.566</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-94"># AGE                          0.02285379  0.00171654  13.314</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-95"># Pr(>|z|)    </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-96"># (Intercept)                 <div class="crayon-line" id="crayon-60ed9549053d2095654008-97">#   RELATIONSHIP Not-in-family  <div class="crayon-line" id="crayon-60ed9549053d2095654008-98">#   RELATIONSHIP Other-relative <div class="crayon-line" id="crayon-60ed9549053d2095654008-99">#   RELATIONSHIP Own-child      <div class="crayon-line" id="crayon-60ed9549053d2095654008-100">#   RELATIONSHIP Unmarried      <div class="crayon-line" id="crayon-60ed9549053d2095654008-101">#   RELATIONSHIP Wife                       0.896606    </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-102"># EDUCATIONNUM                <div class="crayon-line" id="crayon-60ed9549053d2095654008-103">#   CAPITALGAIN                 <div class="crayon-line" id="crayon-60ed9549053d2095654008-104">#   OCCUPATION_repBlue-Collar       0.00000000000959 ***</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-105">#   OCCUPATION_repOther/Unknown <div class="crayon-line" id="crayon-60ed9549053d2095654008-106">#   OCCUPATION_repProfessional              0.038871 *  </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-107">#   OCCUPATION_repService           0.00000150055853 ***</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-108">#   OCCUPATION_repWhite-Collar              0.000362 ***</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-109">#   AGE                         <div class="crayon-line" id="crayon-60ed9549053d2095654008-110">#   ---</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-111">#   Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-112"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-113"># (Dispersion parameter for binomial family taken to be 1)</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-114"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-115"># Null deviance: 25162  on 22791  degrees of freedom</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-116"># Residual deviance: 15542  on 22778  degrees of freedom</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-117"># AIC: 15570</div><div class="crayon-line" id="crayon-60ed9549053d2095654008-118"># </div><div class="crayon-line" id="crayon-60ed9549053d2095654008-119"># Number of Fisher Scoring iterations: 7</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>我們發現不管是逐步向前或向後法，最後結果都與原始logitMod的結果是一樣的。</p>
<p>而理想中好的模型，偏差平方和(Deviance)應該在+-3之內，我們在此透過繪圖來檢視。</p>

		<div id="crayon-60ed9549053d4347382309" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 我們建立一個存放模型偏差殘差的資料表
index <- 1:dim(trainingData)[1]
# deviance residuals
dev_resid <- residuals(logitMod)
above50k <- trainingData$ABOVE50K
dff <- data.frame(index,dev_resid,above50k)

ggplot(data = dff, mapping = aes(x = index,y = dev_resid,color = above50k)) +
  geom_point() +
  geom_hline(yintercept = 3,linetype = "dashed", color = "blue") +
  geom_hline(yintercept = -3,linetype = "dashed", color = "blue") +
  labs(title = "Plot of Deviance Residuals") +
  theme(plot.title = element_text(hjust = 0.5))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053d4347382309-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053d4347382309-1"># 我們建立一個存放模型偏差殘差的資料表</div><div class="crayon-line" id="crayon-60ed9549053d4347382309-2">index <div class="crayon-line" id="crayon-60ed9549053d4347382309-3"># deviance residuals</div><div class="crayon-line" id="crayon-60ed9549053d4347382309-4">dev_resid <div class="crayon-line" id="crayon-60ed9549053d4347382309-5">above50k <div class="crayon-line" id="crayon-60ed9549053d4347382309-6">dff <div class="crayon-line" id="crayon-60ed9549053d4347382309-7"> </div><div class="crayon-line" id="crayon-60ed9549053d4347382309-8">ggplot(data = dff, mapping = aes(x = index,y = dev_resid,color = above50k)) +</div><div class="crayon-line" id="crayon-60ed9549053d4347382309-9">  geom_point() +</div><div class="crayon-line" id="crayon-60ed9549053d4347382309-10">  geom_hline(yintercept = 3,linetype = "dashed", color = "blue") +</div><div class="crayon-line" id="crayon-60ed9549053d4347382309-11">  geom_hline(yintercept = -3,linetype = "dashed", color = "blue") +</div><div class="crayon-line" id="crayon-60ed9549053d4347382309-12">  labs(title = "Plot of Deviance Residuals") +</div><div class="crayon-line" id="crayon-60ed9549053d4347382309-13">  theme(plot.title = element_text(hjust = 0.5))</div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>可以發現偏差平方和皆都落在+-3範圍內(藍色虛線)。</p>
<p><img loading="lazy" class="alignnone size-large wp-image-973" src="/wp-content/uploads/2018/08/pic20-1024x928.png" alt="logistic regression" width="960" height="870" srcset="/wp-content/uploads/2018/08/pic20-1024x928.png 1024w,/wp-content/uploads/2018/08/pic20-300x272.png 300w,/wp-content/uploads/2018/08/pic20-768x696.png 768w,/wp-content/uploads/2018/08/pic20-1140x1034.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<h3>8. 模型比較(v.s. Machine Learning Methods)</h3>
<p>我們將傳統羅吉斯回歸預測結果與近期新穎的機器學習法預測結果做比較。</p>
<h4>8-1. 類神經網路Neural Netwoarks(NN)</h4>
<p></p>

		<div id="crayon-60ed9549053d7969560377" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(nnet)
# A formula of the form class ~ x1 + x2 + ...
# y should be "class"
nn1 <- nnet(as.factor(ABOVE50K_y) ~ RELATIONSHIP + AGE + EDUCATIONNUM + CAPITALGAIN + OCCUPATION_rep,
            data = trainingData,size = 40 , maxit = 500) 
# maxit: maximum number of iterations. Default 100.
# size: number of units in the hidden layer. Can be zero if there are skip-layer units.

# type只有"raw"=>prob, "class"=>0,1
nn1.predict <- predict(object = nn1,newdata = testData,type = "raw")

misClassError(actuals = testData$ABOVE50K_y,predictedScores = nn1.predict)
# [1] 0.1522 (<0.1592)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053d7969560377-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053d7969560377-1">library(nnet)</div><div class="crayon-line" id="crayon-60ed9549053d7969560377-2"># A formula of the form class ~ x1 + x2 + ...</div><div class="crayon-line" id="crayon-60ed9549053d7969560377-3"># y should be "class"</div><div class="crayon-line" id="crayon-60ed9549053d7969560377-4">nn1 <div class="crayon-line" id="crayon-60ed9549053d7969560377-5">            data = trainingData,size = 40 , maxit = 500) </div><div class="crayon-line" id="crayon-60ed9549053d7969560377-6"># maxit: maximum number of iterations. Default 100.</div><div class="crayon-line" id="crayon-60ed9549053d7969560377-7"># size: number of units in the hidden layer. Can be zero if there are skip-layer units.</div><div class="crayon-line" id="crayon-60ed9549053d7969560377-8"> </div><div class="crayon-line" id="crayon-60ed9549053d7969560377-9"># type只有"raw"=>prob, "class"=>0,1</div><div class="crayon-line" id="crayon-60ed9549053d7969560377-10">nn1.predict <div class="crayon-line" id="crayon-60ed9549053d7969560377-11"> </div><div class="crayon-line" id="crayon-60ed9549053d7969560377-12">misClassError(actuals = testData$ABOVE50K_y,predictedScores = nn1.predict)</div><div class="crayon-line" id="crayon-60ed9549053d7969560377-13"># [1] 0.1522 (</div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>類神經網路的預測分類錯誤率為15.22%，稍低於羅吉斯回歸的15.92%。</p>
<h4>8-2. 決策樹CART</h4>
<p></p>

		<div id="crayon-60ed9549053d8939130625" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(rpart)
tree2 <- rpart(formula = as.factor(ABOVE50K_y) ~ RELATIONSHIP + AGE + EDUCATIONNUM + CAPITALGAIN + OCCUPATION_rep,
               data = trainingData, method = "class",cp = 1e-3)
# 回傳每組預測0,1的機率結果
tree2.pred.prop <- predict(object = tree2, newdata = testData, type = "prob")
# 回傳預測0,1結果
tree2.pred <- predict(object = tree2,newdata = testData, type = "class")

# confusion Matrix
tb2 <- table(tree2.pred, testData$ABOVE50K_y)
tb2
# tree2.pred    0    1
#          0 6965 1022
#          1  451 1331

# missclassification rate
(1022+451) / (6965+1022+451+1331)
# [1] 0.1507831</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-15">15</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-16">16</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-17">17</div><div class="crayon-num" data-line="crayon-60ed9549053d8939130625-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053d8939130625-1">library(rpart)</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-2">tree2 <div class="crayon-line" id="crayon-60ed9549053d8939130625-3">               data = trainingData, method = "class",cp = 1e-3)</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-4"># 回傳每組預測0,1的機率結果</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-5">tree2.pred.prop <div class="crayon-line" id="crayon-60ed9549053d8939130625-6"># 回傳預測0,1結果</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-7">tree2.pred <div class="crayon-line" id="crayon-60ed9549053d8939130625-8"> </div><div class="crayon-line" id="crayon-60ed9549053d8939130625-9"># confusion Matrix</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-10">tb2 <div class="crayon-line" id="crayon-60ed9549053d8939130625-11">tb2</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-12"># tree2.pred    0    1</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-13">#          0 6965 1022</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-14">#          1  451 1331</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-15"> </div><div class="crayon-line" id="crayon-60ed9549053d8939130625-16"># missclassification rate</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-17">(1022+451) / (6965+1022+451+1331)</div><div class="crayon-line" id="crayon-60ed9549053d8939130625-18"># [1] 0.1507831</div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>決策樹的預測分類錯誤率為15.07%，低於羅吉斯回歸的15.92%。</p>
<h4>8-3. 隨機森林Random Forest(RF)</h4>
<p></p>

		<div id="crayon-60ed9549053d9153772058" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 透過產生bootstrapped的決策樹森林來優化模型預測正確率
library(randomForest)
rf3 <- randomForest(as.factor(ABOVE50K_y) ~ RELATIONSHIP + AGE + EDUCATIONNUM + CAPITALGAIN + OCCUPATION_rep,
                    data = trainingData, n_tree = 100)
rf3.pred.prob <- predict(object = rf3, newdata = testData, type = "prob")
rf3.pred <- predict(rf3, newdata = testData, type = "class")

# confusion matrix
tb3 <- table(rf3.pred, testData$ABOVE50K_y)
tb3

# rf3.pred    0    1
#        0 6908  968
#        1  508 1385

# missclassification rate
(968+508) / (6908+968+508+1385)
# [1] 0.1510902</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-15">15</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-16">16</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-17">17</div><div class="crayon-num" data-line="crayon-60ed9549053d9153772058-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053d9153772058-1"># 透過產生bootstrapped的決策樹森林來優化模型預測正確率</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-2">library(randomForest)</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-3">rf3 <div class="crayon-line" id="crayon-60ed9549053d9153772058-4">                    data = trainingData, n_tree = 100)</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-5">rf3.pred.prob <div class="crayon-line" id="crayon-60ed9549053d9153772058-6">rf3.pred <div class="crayon-line" id="crayon-60ed9549053d9153772058-7"> </div><div class="crayon-line" id="crayon-60ed9549053d9153772058-8"># confusion matrix</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-9">tb3 <div class="crayon-line" id="crayon-60ed9549053d9153772058-10">tb3</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-11"> </div><div class="crayon-line" id="crayon-60ed9549053d9153772058-12"># rf3.pred    0    1</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-13">#        0 6908  968</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-14">#        1  508 1385</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-15"> </div><div class="crayon-line" id="crayon-60ed9549053d9153772058-16"># missclassification rate</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-17">(968+508) / (6908+968+508+1385)</div><div class="crayon-line" id="crayon-60ed9549053d9153772058-18"># [1] 0.1510902</div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>隨機森林的預測分類錯誤率為15.11%，低於羅吉斯回歸的15.92%。</p>
<h4>8-4. 支援向量機Support Vector Machine(SVM)</h4>
<p></p>

		<div id="crayon-60ed9549053db064202818" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(kernlab)
svm4 <- ksvm(as.factor(ABOVE50K_y) ~ RELATIONSHIP + AGE + EDUCATIONNUM + CAPITALGAIN + OCCUPATION_rep,data = trainingData)
svm4.pred.prob <- predict(svm4,testData, type = "decision")
svm4.pred <- predict(svm4,testData, type = "response")

tb4 <- table(svm4.pred, testData$ABOVE50K_y)
tb4

# svm4.pred    0    1
#         0 6976 1060
#         1  440 1293

# missclassification rate
(440+1060) / (6976+1060+440+1293)
# [1] 0.1535469</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053db064202818-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053db064202818-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053db064202818-1">library(kernlab)</div><div class="crayon-line" id="crayon-60ed9549053db064202818-2">svm4 <div class="crayon-line" id="crayon-60ed9549053db064202818-3">svm4.pred.prob <div class="crayon-line" id="crayon-60ed9549053db064202818-4">svm4.pred <div class="crayon-line" id="crayon-60ed9549053db064202818-5"> </div><div class="crayon-line" id="crayon-60ed9549053db064202818-6">tb4 <div class="crayon-line" id="crayon-60ed9549053db064202818-7">tb4</div><div class="crayon-line" id="crayon-60ed9549053db064202818-8"> </div><div class="crayon-line" id="crayon-60ed9549053db064202818-9"># svm4.pred    0    1</div><div class="crayon-line" id="crayon-60ed9549053db064202818-10">#         0 6976 1060</div><div class="crayon-line" id="crayon-60ed9549053db064202818-11">#         1  440 1293</div><div class="crayon-line" id="crayon-60ed9549053db064202818-12"> </div><div class="crayon-line" id="crayon-60ed9549053db064202818-13"># missclassification rate</div><div class="crayon-line" id="crayon-60ed9549053db064202818-14">(440+1060) / (6976+1060+440+1293)</div><div class="crayon-line" id="crayon-60ed9549053db064202818-15"># [1] 0.1535469</div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>SVM的預測分類錯誤率為15.35%，亦低於羅吉斯回歸的15.92%。</p>
<p>綜合以上結果，我們摘要傳統羅吉斯回歸與機器學習法的預測結果如下表：</p>
<table style="border-collapse: collapse; width: 100%; height: 115px;" border="1">
<tbody>
<tr style="height: 23px;">
<td style="width: 50%; height: 23px;">演算法</td>
<td style="width: 50%; height: 23px;">預測錯誤率</td>
</tr>
<tr style="height: 23px;">
<td style="width: 50%; height: 23px;">傳統羅吉斯回歸</td>
<td style="width: 50%; height: 23px;">15.92%</td>
</tr>
<tr style="height: 23px;">
<td style="width: 50%; height: 23px;">類神經網路</td>
<td style="width: 50%; height: 23px;">15.22%</td>
</tr>
<tr style="height: 23px;">
<td style="width: 50%; height: 23px;">決策樹(CART)</td>
<td style="width: 50%; height: 23px;">15.11%</td>
</tr>
<tr style="height: 23px;">
<td style="width: 50%; height: 23px;">支持向量機(SVM)</td>
<td style="width: 50%; height: 23px;">15.35%</td>
</tr>
</tbody>
</table>
<p>可以發現機器學習法的對所有測試資料的預測錯誤率沒有比傳統羅吉斯回歸差距太大。</p>
<p>Confusion Matrix看的是模型對於<span style="color: #9f6ad4;">所有data</span>的預測正確度(accuracy)，<span style="color: #9f6ad4;">但因為我們的大部分的資料都是<=50K，所以我們更會比較在不同資料使用水平下，模型在正確度的表現</span>。<span style="color: #9f6ad4;">我們在此會使用<span style="text-decoration: underline;">ROC曲線及曲線下面積AUC</span>來看比較五個模型分別在<span style="text-decoration: underline;">不同資料水平下的模型預測正確率(accuracy)表現</span></span>。</p>
<p>先載入套件ROCR。並替所有模型預測結果產生一組放置(X軸)False Positive Rate和(Y軸)True Positive Rate的data frame，以便後續繪製各模型的ROC曲線。</p>
<p>首先是Logistic Regression的部份如下：</p>

		<div id="crayon-60ed9549053dc375357115" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
library(ROCR)

# logistic regression:
# 使用ROC評估分類模型前，都會先創造一個prediction物件，用來將輸入資料標準化
# predictions 為使用測試資料集的模型(logitMod)預測結果(probabilities)，
# 而labels為真實測試集的資料類別(category)
# 兩者個維度必須相同
pr <- prediction(predictions = prob, labels = testData$ABOVE50K_y)
# 產生成效物件。所有的預測評估都會使用這個函數。measure為y軸指標，x.measure為x軸指標。
# 這邊我們會放上ROC曲線的x軸和y軸資訊，分別為1-specificity(x.measure)和sensitivity/recall(measure)
prf <- performance(prediction.obj = pr,measure = "tpr", x.measure = 'fpr')
# 建立一個TP rate和FP rate的data frame
dd <- data.frame(FP = prf@x.values[[1]], TP = prf@y.values[[1]])</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053dc375357115-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053dc375357115-1">library(ROCR)</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-2"> </div><div class="crayon-line" id="crayon-60ed9549053dc375357115-3"># logistic regression:</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-4"># 使用ROC評估分類模型前，都會先創造一個prediction物件，用來將輸入資料標準化</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-5"># predictions 為使用測試資料集的模型(logitMod)預測結果(probabilities)，</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-6"># 而labels為真實測試集的資料類別(category)</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-7"># 兩者個維度必須相同</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-8">pr <div class="crayon-line" id="crayon-60ed9549053dc375357115-9"># 產生成效物件。所有的預測評估都會使用這個函數。measure為y軸指標，x.measure為x軸指標。</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-10"># 這邊我們會放上ROC曲線的x軸和y軸資訊，分別為1-specificity(x.measure)和sensitivity/recall(measure)</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-11">prf <div class="crayon-line" id="crayon-60ed9549053dc375357115-12"># 建立一個TP rate和FP rate的data frame</div><div class="crayon-line" id="crayon-60ed9549053dc375357115-13">dd </div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>其他機器學習法如法炮製如下：</p>

		<div id="crayon-60ed9549053de234217072" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# Neural Networks (NN):
pr1 <- prediction(predictions = nn1.predict,labels = testData$ABOVE50K_y)
prf1 <- performance(prediction.obj = pr1,measure = "tpr",x.measure = "fpr")
dd1 <- data.frame(FP = prf1@x.values[[1]], TP = prf1@y.values[[1]])

# CART:
pr2 <- prediction(predictions = tree2.pred.prop[,2], labels = testData$ABOVE50K_y)
prf2 <- performance(prediction.obj = pr2,measure = "tpr", x.measure = "fpr")
dd2 <- data.frame(FP = prf2@x.values[[1]], TP = prf2@y.values[[1]])

# Random Forest (RF):
pr3 <- prediction(predictions = rf3.pred.prob[,2],labels = testData$ABOVE50K_y)
prf3 <- performance(prediction.obj = pr3, measure = "tpr", x.measure = "fpr")
dd3 <- data.frame(FP = prf3@x.values[[1]], TP = prf3@y.values[[1]])

# SVM:
pr4 <- prediction(predictions = svm4.pred.prob,labels = testData$ABOVE50K_y)
prf4 <- performance(prediction.obj = pr4,measure = "tpr", x.measure = "fpr")
dd4 <- data.frame(FP = prf4@x.values[[1]], TP = prf4@y.values[[1]])</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053de234217072-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-15">15</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-16">16</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-17">17</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-18">18</div><div class="crayon-num" data-line="crayon-60ed9549053de234217072-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053de234217072-1"># Neural Networks (NN):</div><div class="crayon-line" id="crayon-60ed9549053de234217072-2">pr1 <div class="crayon-line" id="crayon-60ed9549053de234217072-3">prf1 <div class="crayon-line" id="crayon-60ed9549053de234217072-4">dd1 <div class="crayon-line" id="crayon-60ed9549053de234217072-5"> </div><div class="crayon-line" id="crayon-60ed9549053de234217072-6"># CART:</div><div class="crayon-line" id="crayon-60ed9549053de234217072-7">pr2 <div class="crayon-line" id="crayon-60ed9549053de234217072-8">prf2 <div class="crayon-line" id="crayon-60ed9549053de234217072-9">dd2 <div class="crayon-line" id="crayon-60ed9549053de234217072-10"> </div><div class="crayon-line" id="crayon-60ed9549053de234217072-11"># Random Forest (RF):</div><div class="crayon-line" id="crayon-60ed9549053de234217072-12">pr3 <div class="crayon-line" id="crayon-60ed9549053de234217072-13">prf3 <div class="crayon-line" id="crayon-60ed9549053de234217072-14">dd3 <div class="crayon-line" id="crayon-60ed9549053de234217072-15"> </div><div class="crayon-line" id="crayon-60ed9549053de234217072-16"># SVM:</div><div class="crayon-line" id="crayon-60ed9549053de234217072-17">pr4 <div class="crayon-line" id="crayon-60ed9549053de234217072-18">prf4 <div class="crayon-line" id="crayon-60ed9549053de234217072-19">dd4 </div></div></div></div></div></div></div></div></div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>準備好各模型預測結果dd, dd1, ~ ,dd4的data frame後，我們將他們轉換成ROC曲線。</p>

		<div id="crayon-60ed9549053e0805751930" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# 將以上幾個模型的ROC曲線畫出：
library(ggplot2)
g <- 
  ggplot() +
    geom_line(data = dd,mapping = aes(x = FP, y = TP, color = 'Logistic Regression')) +
    geom_line(data = dd1,mapping = aes(x = FP, y = TP, color = 'Neural Networks')) +
    geom_line(data = dd2,mapping = aes(x = FP, y = TP, color = 'CART')) +
    geom_line(data = dd3,mapping = aes(x = FP, y = TP, color = 'Random Forest')) +
    geom_line(data = dd4,mapping = aes(x = FP, y = TP, color = 'Support Vector Machine')) +
    geom_segment(mapping = aes(x = 0, xend = 1, y = 0, yend = 1)) +
    ggtitle(label = "ROC Curve") +
    labs(x = "False Positive Rate", y = "True Positive Rate")
g +
  scale_color_manual(name = "classifier",values = c('Logistic Regression'='#E69F00', 
                                                    'Neural Networks'='#56B4E9', 'CART'='#009E73', 
                                                    'Random Forest'='#D55E00', 'Support Vector Machine'='#0072B2'))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-15">15</div><div class="crayon-num" data-line="crayon-60ed9549053e0805751930-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053e0805751930-1"># 將以上幾個模型的ROC曲線畫出：</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-2">library(ggplot2)</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-3">g <div class="crayon-line" id="crayon-60ed9549053e0805751930-4">  ggplot() +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-5">    geom_line(data = dd,mapping = aes(x = FP, y = TP, color = 'Logistic Regression')) +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-6">    geom_line(data = dd1,mapping = aes(x = FP, y = TP, color = 'Neural Networks')) +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-7">    geom_line(data = dd2,mapping = aes(x = FP, y = TP, color = 'CART')) +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-8">    geom_line(data = dd3,mapping = aes(x = FP, y = TP, color = 'Random Forest')) +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-9">    geom_line(data = dd4,mapping = aes(x = FP, y = TP, color = 'Support Vector Machine')) +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-10">    geom_segment(mapping = aes(x = 0, xend = 1, y = 0, yend = 1)) +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-11">    ggtitle(label = "ROC Curve") +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-12">    labs(x = "False Positive Rate", y = "True Positive Rate")</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-13">g +</div><div class="crayon-line" id="crayon-60ed9549053e0805751930-14">  scale_color_manual(name = "classifier",values = c('Logistic Regression'='#E69F00', </div><div class="crayon-line" id="crayon-60ed9549053e0805751930-15">                                                    'Neural Networks'='#56B4E9', 'CART'='#009E73', </div><div class="crayon-line" id="crayon-60ed9549053e0805751930-16">                                                    'Random Forest'='#D55E00', 'Support Vector Machine'='#0072B2'))</div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>從圖中可以觀察到，<span style="color: #9f6ad4;">模型中以Neural Networks表現最好，及能使用最少的資料，可以捕捉到最多的目標事件1</span>。(理想中，ROC曲線前段越陡越好，後段則越緩越佳）。</p>
<p><img loading="lazy" class="alignnone size-large wp-image-974" src="/wp-content/uploads/2018/08/pic21-1024x928.png" alt="logistic regression" width="960" height="870" srcset="/wp-content/uploads/2018/08/pic21-1024x928.png 1024w,/wp-content/uploads/2018/08/pic21-300x272.png 300w,/wp-content/uploads/2018/08/pic21-768x696.png 768w,/wp-content/uploads/2018/08/pic21-1140x1034.png 1140w" sizes="(max-width: 960px) 100vw, 960px"></p>
<div align="center"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><br>
<br>
<ins class="adsbygoogle" style="display: block;" data-ad-client="ca-pub-7946632597933771" data-ad-slot="8154450369" data-ad-format="auto" data-full-width-responsive="true"></ins><br>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
<p>我們進一步將ROC曲線下面積AUC計算出來。</p>

		<div id="crayon-60ed9549053e2573651740" class="crayon-syntax crayon-theme-hwj-based-on-monokai crayon-font-monospace crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 14px !important; line-height: 20px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 14px !important; line-height: 20px !important;">
# AUC
auc <- 
  rbind(performance(pr, measure = 'auc')@y.values[[1]],
        performance(pr1, measure = 'auc')@y.values[[1]],
        performance(pr2, measure = 'auc')@y.values[[1]],
        performance(pr3, measure = 'auc')@y.values[[1]],
        performance(pr4, measure = 'auc')@y.values[[1]])

rownames(auc) <- (c('Logistic Regression', 'Neural Networks', 'CART',
                    'Random Forest', 'Support Vector Machine'))
colnames(auc) <- 'Area Under ROC Curve'
round(auc, 4)

#                        Area Under ROC Curve
# Logistic Regression                  0.8868
# Neural Networks                      0.8970
# CART                                 0.8543
# Random Forest                        0.8646
# Support Vector Machine               0.8651</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 14px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-1">1</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-2">2</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-3">3</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-4">4</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-5">5</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-6">6</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-7">7</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-8">8</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-9">9</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-10">10</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-11">11</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-12">12</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-13">13</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-14">14</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-15">15</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-16">16</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-17">17</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-18">18</div><div class="crayon-num" data-line="crayon-60ed9549053e2573651740-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 14px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60ed9549053e2573651740-1"># AUC</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-2">auc <div class="crayon-line" id="crayon-60ed9549053e2573651740-3">  rbind(performance(pr, measure = 'auc')@y.values[[1]],</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-4">        performance(pr1, measure = 'auc')@y.values[[1]],</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-5">        performance(pr2, measure = 'auc')@y.values[[1]],</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-6">        performance(pr3, measure = 'auc')@y.values[[1]],</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-7">        performance(pr4, measure = 'auc')@y.values[[1]])</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-8"> </div><div class="crayon-line" id="crayon-60ed9549053e2573651740-9">rownames(auc) <div class="crayon-line" id="crayon-60ed9549053e2573651740-10">                    'Random Forest', 'Support Vector Machine'))</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-11">colnames(auc) <div class="crayon-line" id="crayon-60ed9549053e2573651740-12">round(auc, 4)</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-13"> </div><div class="crayon-line" id="crayon-60ed9549053e2573651740-14">#                        Area Under ROC Curve</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-15"># Logistic Regression                  0.8868</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-16"># Neural Networks                      0.8970</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-17"># CART                                 0.8543</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-18"># Random Forest                        0.8646</div><div class="crayon-line" id="crayon-60ed9549053e2573651740-19"># Support Vector Machine               0.8651</div></div></div></div></div></td>
					</tr>
				</table>
			</div>
		</div>

<p>可以發現，Neural Networks曲線下面積最高，Logistic Regression則次之。<span style="color: #9f6ad4;">但因為類神經網路有諸多黑箱邏輯，故為了有更多的解釋基礎，一般來說，還是會選擇使用羅吉斯回歸結果來說明</span>。從此範例也可發現，傳統羅吉斯回歸的對此資料集的預測能力並不亞於諸多新穎的機器學習法。</p>
<h3>總結</h3>
<ul>
<li>羅吉斯回歸與回歸模型相似，必須符合許多基本假設，也因此對資料分配有較多要求，資料前處理的需求亦較多（遺失值、離群值、資料分佈）。</li>
<li>回歸模型基本上並不包含變數篩選，所以事前會使用IV(information value)來做變數初步篩選，事後也會使用VIF檢視共線性。</li>
<li>和線性回歸一樣，羅吉斯會將類別型變數轉換成虛擬變數，因此要避免類別水準值過多的情形。</li>
<li>評估模型適合度，需綜合考量<span style="text-decoration: underline;">整體錯誤率(misclassification rate)</span>與在<span style="text-decoration: underline;"><span style="color: #9f6ad4; text-decoration: underline;">不同資料量水平下的捕捉率(ROC/AUC)</span></span>。</li>
<li>羅吉斯回歸適合用來預<span style="color: #9f6ad4;">測類別變數（二元變數）的<span style="text-decoration: underline;"><strong>機率</strong></span></span>。</li>
<li>模型調整的工約80%是在於資料前處理。</li>
</ul>
<hr>
<p>更多模型建置筆記連結：</p>
<ol>
<li><a href="/linear-regression-%e7%b7%9a%e6%80%a7%e8%bf%b4%e6%ad%b8%e6%a8%a1%e5%9e%8b/" target="_blank" rel="noopener noreferrer">Linear Regression | 線性迴歸模型 | using AirQuality Dataset</a></li>
<li><a href="/regularized-regression-ridge-lasso-elastic/" target="_blank" rel="noopener noreferrer">Regularized Regression | 正規化迴歸 – Ridge, Lasso, Elastic Net | R語言</a></li>
<li><a href="/logistic-regression-part1-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" target="_blank" rel="noopener noreferrer">Logistic Regression 羅吉斯迴歸 | part1 – 資料探勘與處理 | 統計 R語言</a></li>
<li><a href="/decision-tree-cart-%e6%b1%ba%e7%ad%96%e6%a8%b9/" target="_blank" rel="noopener noreferrer">Decision Tree 決策樹 | CART, Conditional Inference Tree, Random Forest</a></li>
<li><a href="/regression-tree-%e8%bf%b4%e6%ad%b8%e6%a8%b9-bagging-bootstrap-aggrgation-r%e8%aa%9e%e8%a8%80/" target="_blank" rel="noopener noreferrer">Regression Tree | 迴歸樹, Bagging, Bootstrap Aggregation | R語言</a></li>
<li><a href="/random-forests-%e9%9a%a8%e6%a9%9f%e6%a3%ae%e6%9e%97/" target="_blank" rel="noopener noreferrer">Random Forests 隨機森林 | randomForest, ranger, h2o | R語言</a></li>
<li><a href="/gradient-boosting-machines-gbm/" target="_blank" rel="noopener noreferrer">Gradient Boosting Machines GBM | gbm, xgboost, h2o | R語言</a></li>
<li><a href="/hierarchical-clustering-%e9%9a%8e%e5%b1%a4%e5%bc%8f%e5%88%86%e7%be%a4/" target="_blank" rel="noopener noreferrer">Hierarchical Clustering 階層式分群 | Clustering 資料分群 | R統計</a></li>
<li><a href="/partitional-clustering-kmeans-kmedoid/" target="_blank" rel="noopener noreferrer">Partitional Clustering | 切割式分群 | Kmeans, Kmedoid | Clustering 資料分群</a></li>
<li><a href="/principal-components-analysis-pca-%e4%b8%bb%e6%88%90%e4%bb%bd%e5%88%86%e6%9e%90/" target="_blank" rel="noopener noreferrer">Principal Components Analysis (PCA) | 主成份分析 | R 統計</a></li>
</ol>
<hr>
<p>參考:</p>
<ol>
<li><a href="https://tinyurl.com/y796qqca">歐萊禮  R資料科學</a></li>
</ol>
			</div>

	<footer class="entry-footer">
		<span class="tags-links"> <a href="/tag/auc/" rel="tag">AUC</a>0<a href="/tag/cart/" rel="tag">cart</a>0<a href="/tag/confusion-matrix/" rel="tag">confusion matrix</a>0<a href="/tag/decision-tree/" rel="tag">decision tree</a>0<a href="/tag/logistic-regression/" rel="tag">logistic regression</a>0<a href="/tag/model-diagnostic/" rel="tag">model diagnostic</a>0<a href="/tag/neural-networks/" rel="tag">neural networks</a>0<a href="/tag/random-forest/" rel="tag">random forest</a>0<a href="/tag/roc/" rel="tag">ROC</a>0<a href="/tag/support-vector-machine/" rel="tag">support vector machine</a>0<a href="/tag/svm/" rel="tag">svm</a>0<a href="/tag/%e6%a8%a1%e5%9e%8b%e8%a8%ba%e6%96%b7/" rel="tag">模型診斷</a>0<a href="/tag/%e6%b7%b7%e4%ba%82%e7%9f%a9%e9%99%a3/" rel="tag">混亂矩陣</a>0<a href="/tag/%e7%be%85%e5%90%89%e6%96%af%e5%9b%9e%e6%ad%b8/" rel="tag">羅吉斯回歸</a></span>	</footer>

	
</article>

				<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">文章導覽列</h2>
		<div class="nav-links clearfix">
			<div class="nav-previous"><span>⟵</span><a href="/logistic-regression-part1-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/" rel="prev">Logistic Regression 羅吉斯迴歸 | part1 – 資料探勘與處理 | 統計 R語言</a></div><div class="nav-next"><a href="/missing-value-treatment-%e9%81%ba%e5%a4%b1%e5%80%bc%e8%99%95%e7%90%86/" rel="next">Missing Value Treatment | 遺失值處理 | 統計 R語言</a><span>⟶</span></div>		</div>
	</nav>
	
			
<div id="comments" class="comments-area">

	
			<h4 class="comment-title">
			在《<span>Logistic Regression 羅吉斯迴歸 | part2 – 模型建置、診斷與比較 | R語言</span>》中有 3 則留言		</h4>

		
		<ol class="comments-list">
					<li id="comment-130" class="comment even thread-even depth-1 parent">
			<article id="div-comment-130" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="http://1.gravatar.com/avatar/1943c41d3ad5582dda998607e10e39de?s=60&d=mm&r=g" srcset="http://1.gravatar.com/avatar/1943c41d3ad5582dda998607e10e39de?s=120&d=mm&r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy">						<b class="fn">allen</b><span class="says">表示:</span>					</div>

					<div class="comment-metadata">
						<a href="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/#comment-130"><time datetime="2018-12-20T11:06:20+08:00">2018-12-2011:06:20</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>感謝您的這篇文章，收穫非常多，不過我想請問總結的第二段<br>
<code></code><code>回歸模型基本上並不包含變數篩選</code><code></code><br>
意思是，我如果利用glm所建立的羅吉斯模型，我並不能作挑選有顯著的變數當作我的重要變數嗎?</p>
				</div>

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="#comment-130" data-commentid="130" data-postid="851" data-belowelement="div-comment-130" data-respondelement="respond" data-replyto="回覆給「allen」" aria-label="回覆給「allen」">回覆</a></div>			</article>
		<ol class="children">
		<li id="comment-131" class="comment byuser comment-author-jamleecute bypostauthor odd alt depth-2">
			<article id="div-comment-131" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="http://2.gravatar.com/avatar/bd4f120d4d46828d1bb2380433b94a1e?s=60&d=mm&r=g" srcset="http://2.gravatar.com/avatar/bd4f120d4d46828d1bb2380433b94a1e?s=120&d=mm&r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy">						<b class="fn">jamleecute</b><span class="says">表示:</span>					</div>

					<div class="comment-metadata">
						<a href="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/#comment-131"><time datetime="2018-12-21T11:15:06+08:00">2018-12-2111:15:06</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>您好，<br>
「回歸模型基本上並不包含變數篩選」這句話在這邊指的是說「尋找模型方程式的最佳變數組合」，<br>
因為每一次跑羅吉斯模型我們只能寫死指定某n個x變數來解釋y變數的配飾效果(也會告訴我們每個x變數與y變數的關係顯著性)，但不知道是否用某n個x變數就是最好的回歸方程式的組合。<br>
所以如果要找「尋找模型方程式的最佳變數組合」，我們會額外進行幾個處理，常見的方法包括(1)「逐步回歸」和(2)「lasso回歸(regularization regression)」。<br>
(1)逐步回歸會使用向前、向後或雙向逐一加減x變數來看哪個x變數組合的方程式的回歸模型表現最好；<br>
(2)而後者lasso回歸則會幫每個x變數加入權重，並在回歸目標是加入懲罰因子(限制模型複雜度)，來看每個x變數的權重要拿捏在多少程度(0~1)才能配釋出最佳回歸方程式。<br>
希望有回答到你！^^</p>
				</div>

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="#comment-131" data-commentid="131" data-postid="851" data-belowelement="div-comment-131" data-respondelement="respond" data-replyto="回覆給「jamleecute」" aria-label="回覆給「jamleecute」">回覆</a></div>			</article>
		</li>
</ol>
</li>
		<li id="comment-3264" class="comment even thread-odd thread-alt depth-1">
			<article id="div-comment-3264" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="http://1.gravatar.com/avatar/4e3d3ac32a34d8aaaddf679c44d78dc5?s=60&d=mm&r=g" srcset="http://1.gravatar.com/avatar/4e3d3ac32a34d8aaaddf679c44d78dc5?s=120&d=mm&r=g 2x" class="avatar avatar-60 photo" height="60" width="60" loading="lazy">						<b class="fn">poisson</b><span class="says">表示:</span>					</div>

					<div class="comment-metadata">
						<a href="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/#comment-3264"><time datetime="2019-06-21T14:32:32+08:00">2019-06-2114:32:32</time></a>					</div>

									</footer>

				<div class="comment-content">
					<p>您好：<br>
看了此篇文章獲益良多，但有一個部分想請教。<br>
在8-4.Support Vector Machine(SVM)中，<br>
predict(svm4,testData, type = “decision”)計算出來的數值有超過1或小於-1，例如：-2.3、3.005，<br>
想問這個是SVM-Y的預測機率值嗎？感謝！</p>
				</div>

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="#comment-3264" data-commentid="3264" data-postid="851" data-belowelement="div-comment-3264" data-respondelement="respond" data-replyto="回覆給「poisson」" aria-label="回覆給「poisson」">回覆</a></div>			</article>
		</li>
		</ol>

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">發佈留言 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/logistic-regression-part2-%e7%be%85%e5%90%89%e6%96%af%e8%bf%b4%e6%ad%b8/#respond" style="display:none;">取消回覆</a></small></h3><form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">發佈留言必須填寫的電子郵件地址不會公開。</span> 必填欄位標示為 <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">留言</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">顯示名稱 <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">電子郵件地址 <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">個人網站網址</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200"></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="發佈留言"> <input type="hidden" name="comment_post_ID" value="851" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><div class="wantispam-required-fields"><input type="hidden" name="wantispam_t" class="wantispam-control wantispam-control-t" value="1626182985"><div class="wantispam-group wantispam-group-q" style="clear: both;">
					<label>Current ye@r <span class="required">*</span></label>
					<input type="hidden" name="wantispam_a" class="wantispam-control wantispam-control-a" value="2021">
					<input type="text" name="wantispam_q" class="wantispam-control wantispam-control-q" value="7.2.0" autocomplete="off">
				  </div>
<div class="wantispam-group wantispam-group-e" style="display: none;">
					<label>Leave this field empty</label>
					<input type="text" name="wantispam_e_email_url_website" class="wantispam-control wantispam-control-e" value="" autocomplete="off">
				  </div>
</div></form>	</div>
	
</div>

		
		</main>
	</div>

	

<div id="secondary" class="widget-area col-md-3" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
				<label>
					<span class="screen-reader-text">搜尋關鍵字:</span>
					<input type="search" class="search-field" placeholder="搜尋..." value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="搜尋">
			</form></aside>
		<aside id="recent-posts-2" class="widget widget_recent_entries">
		<h3 class="widget-title">近期文章</h3>
		<ul>
											<li>
					<a href="/jbs-diner/">JB’s Diner | 陽光、綠意、自然度假風美式早午餐 | 台北 天母</a>
									</li>
											<li>
					<a href="/%e9%82%80%e6%9c%88%e5%85%92/">邀月兒 | 適合放鬆小酌的迷人高級餐酒館 | 台北 民生社區 富錦街</a>
									</li>
											<li>
					<a href="/eslite-cafe-%e4%bf%a1%e7%be%a9%e8%aa%a0%e5%93%81%e5%92%96%e5%95%a1/">信義誠品咖啡 Eslite Café | 美美的 優雅的 文青咖啡廳 | 台北 信義區</a>
									</li>
											<li>
					<a href="/%e5%b0%8f%e9%bc%8e%e8%86%be/">小鼎膾 | 新鮮美味的高品質日式丼飯、海鮮料理 | 台北信義 Bellavita B2</a>
									</li>
											<li>
					<a href="/gradient-boosting-machines-gbm/">Gradient Boosting Machines GBM | gbm, xgboost, h2o | R語言</a>
									</li>
					</ul>

		</aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">彙整</h3>
			<ul>
					<li><a href="/2019/08/">2019 年 8 月</a></li>
	<li><a href="/2019/04/">2019 年 4 月</a></li>
	<li><a href="/2019/03/">2019 年 3 月</a></li>
	<li><a href="/2019/02/">2019 年 2 月</a></li>
	<li><a href="/2019/01/">2019 年 1 月</a></li>
	<li><a href="/2018/12/">2018 年 12 月</a></li>
	<li><a href="/2018/10/">2018 年 10 月</a></li>
	<li><a href="/2018/09/">2018 年 9 月</a></li>
	<li><a href="/2018/08/">2018 年 8 月</a></li>
	<li><a href="/2018/07/">2018 年 7 月</a></li>
	<li><a href="/2018/05/">2018 年 5 月</a></li>
			</ul>

			</aside></div>
			</div>
		</div>
	</div>

	
	
    <a class="go-top"><i class="fa fa-angle-up"></i></a>
		
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info container">
			<a href="https://tw.wordpress.org/">本站採用 WordPress 建置</a>
			<span class="sep"> | </span>
			佈景主題採用由 aThemes 所設計的 <a href="https://athemes.com/theme/sydney" rel="designer">Sydney</a>。		</div>
	</footer>

	
</div>


<script type="text/javascript">
var sbiajaxurl = "/wp-admin/admin-ajax.php";
</script>
<script type="text/javascript" src="/wp-content/plugins/anti-spam/assets/js/anti-spam.js" id="anti-spam-script-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/scripts.js" id="sydney-scripts-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/main.min.js" id="sydney-main-js"></script>
<script type="text/javascript" src="/wp-content/themes/hwj-based-on-sydney/js/skip-link-focus-fix.js" id="sydney-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config&ver=1.3.11" id="mathjax-js"></script>


</body></html>
